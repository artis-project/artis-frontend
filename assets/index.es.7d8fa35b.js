import{e as wt,bc as K1,bd as hr,be as V1,bf as G1,bg as vr,bh as ur,bi as Mc,bj as Gr,bk as An,bl as k1,bm as xl,v as W1}from"./index.72f44f21.js";var La={},nu={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,B,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{x(w.next(q))}catch(te){T(te)}}function W(q){try{x(w.throw(q))}catch(te){T(te)}}function x(q){q.done?p(q.value):_(q.value).then(F,W)}x((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(x){return function(q){return W([x,q])}}function W(x){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=x[0]&2?_.return:x[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,x[1])).done)return p;switch(_=0,p&&(x=[x[0]&2,p.value]),x[0]){case 0:case 1:p=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,_=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){d.label=x[1];break}if(x[0]===6&&d.label<p[1]){d.label=p[1],p=x;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(x);break}p[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(q){x=[6,q],_=0}finally{w=p=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(x,q):te(p[0][2],re)}function x(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(x){p({value:x,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},B=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",B),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(nu);var gs={};Object.defineProperty(gs,"__esModule",{value:!0});function Y1(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}gs.safeJsonParse=Y1;function J1(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}gs.safeJsonStringify=J1;var es={exports:{}},Pl;function X1(){return Pl||(Pl=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof wt<"u"&&wt.localStorage?es.exports=wt.localStorage:typeof window<"u"&&window.localStorage?es.exports=window.localStorage:es.exports=new t}()),es.exports}var mc={},ts={},Al;function Z1(){if(Al)return ts;Al=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IKeyValueStorage=void 0;class n{}return ts.IKeyValueStorage=n,ts}var rs={},Tl;function Q1(){if(Tl)return rs;Tl=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.parseEntry=void 0;const n=gs;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return rs.parseEntry=t,rs}var Cl;function em(){return Cl||(Cl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=nu.exports;t.__exportStar(Z1(),n),t.__exportStar(Q1(),n)}(mc)),mc}Object.defineProperty(La,"__esModule",{value:!0});La.KeyValueStorage=void 0;const xn=nu.exports,Rl=gs,tm=xn.__importDefault(X1()),rm=em();class rd{constructor(){this.localStorage=tm.default}getKeys(){return xn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return xn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(rm.parseEntry)})}getItem(t){return xn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Rl.safeJsonParse(r)})}setItem(t,r){return xn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Rl.safeJsonStringify(r))})}removeItem(t){return xn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}La.KeyValueStorage=rd;var im=La.default=rd,Rn={},_s={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,B,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{x(w.next(q))}catch(te){T(te)}}function W(q){try{x(w.throw(q))}catch(te){T(te)}}function x(q){q.done?p(q.value):_(q.value).then(F,W)}x((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(x){return function(q){return W([x,q])}}function W(x){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=x[0]&2?_.return:x[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,x[1])).done)return p;switch(_=0,p&&(x=[x[0]&2,p.value]),x[0]){case 0:case 1:p=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,_=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){d.label=x[1];break}if(x[0]===6&&d.label<p[1]){d.label=p[1],p=x;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(x);break}p[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(q){x=[6,q],_=0}finally{w=p=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(x,q):te(p[0][2],re)}function x(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(x){p({value:x,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},B=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",B),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(_s);var is={},me={},ys={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,B,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{x(w.next(q))}catch(te){T(te)}}function W(q){try{x(w.throw(q))}catch(te){T(te)}}function x(q){q.done?p(q.value):_(q.value).then(F,W)}x((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(x){return function(q){return W([x,q])}}function W(x){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=x[0]&2?_.return:x[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,x[1])).done)return p;switch(_=0,p&&(x=[x[0]&2,p.value]),x[0]){case 0:case 1:p=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,_=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){d.label=x[1];break}if(x[0]===6&&d.label<p[1]){d.label=p[1],p=x;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(x);break}p[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(q){x=[6,q],_=0}finally{w=p=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(x,q):te(p[0][2],re)}function x(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(x){p({value:x,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},B=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",B),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(ys);var bc={},ns={},Nl;function nm(){if(Nl)return ns;Nl=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return ns.delay=n,ns}var Wi={},wc={},Yi={},jl;function sm(){return jl||(jl=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.ONE_THOUSAND=Yi.ONE_HUNDRED=void 0,Yi.ONE_HUNDRED=100,Yi.ONE_THOUSAND=1e3),Yi}var Ec={},Dl;function am(){return Dl||(Dl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Ec)),Ec}var Fl;function id(){return Fl||(Fl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ys.exports;t.__exportStar(sm(),n),t.__exportStar(am(),n)}(wc)),wc}var Ul;function om(){if(Ul)return Wi;Ul=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.fromMiliseconds=Wi.toMiliseconds=void 0;const n=id();function t(s){return s*n.ONE_THOUSAND}Wi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Wi.fromMiliseconds=r,Wi}var Ll;function cm(){return Ll||(Ll=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ys.exports;t.__exportStar(nm(),n),t.__exportStar(om(),n)}(bc)),bc}var On={},$l;function um(){if($l)return On;$l=1,Object.defineProperty(On,"__esModule",{value:!0}),On.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return On.Watch=n,On.default=n,On}var Sc={},ss={},Ml;function hm(){if(Ml)return ss;Ml=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.IWatch=void 0;class n{}return ss.IWatch=n,ss}var ql;function lm(){return ql||(ql=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ys.exports.__exportStar(hm(),n)}(Sc)),Sc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ys.exports;t.__exportStar(cm(),n),t.__exportStar(um(),n),t.__exportStar(lm(),n),t.__exportStar(id(),n)})(me);var Ic={},as={};class en{}const fm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),dm=K1(fm);var zl;function pm(){if(zl)return as;zl=1,Object.defineProperty(as,"__esModule",{value:!0}),as.IHeartBeat=void 0;const n=dm;class t extends n.IEvents{constructor(s){super()}}return as.IHeartBeat=t,as}var Hl;function nd(){return Hl||(Hl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),_s.exports.__exportStar(pm(),n)}(Ic)),Ic}var Oc={},Ji={},Bl;function gm(){if(Bl)return Ji;Bl=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.HEARTBEAT_EVENTS=Ji.HEARTBEAT_INTERVAL=void 0;const n=me;return Ji.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ji}var Kl;function sd(){return Kl||(Kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),_s.exports.__exportStar(gm(),n)}(Oc)),Oc}var Vl;function _m(){if(Vl)return is;Vl=1,Object.defineProperty(is,"__esModule",{value:!0}),is.HeartBeat=void 0;const n=_s.exports,t=hr.exports,r=me,s=nd(),o=sd();class g extends s.IHeartBeat{constructor(m){super(m),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(m==null?void 0:m.interval)||o.HEARTBEAT_INTERVAL}static init(m){return n.__awaiter(this,void 0,void 0,function*(){const E=new g(m);return yield E.init(),E})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(m,E){this.events.on(m,E)}once(m,E){this.events.once(m,E)}off(m,E){this.events.off(m,E)}removeListener(m,E){this.events.removeListener(m,E)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return is.HeartBeat=g,is}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=_s.exports;t.__exportStar(_m(),n),t.__exportStar(nd(),n),t.__exportStar(sd(),n)})(Rn);var Qe={},ad={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,B,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{x(w.next(q))}catch(te){T(te)}}function W(q){try{x(w.throw(q))}catch(te){T(te)}}function x(q){q.done?p(q.value):_(q.value).then(F,W)}x((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(x){return function(q){return W([x,q])}}function W(x){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=x[0]&2?_.return:x[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,x[1])).done)return p;switch(_=0,p&&(x=[x[0]&2,p.value]),x[0]){case 0:case 1:p=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,_=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){d.label=x[1];break}if(x[0]===6&&d.label<p[1]){d.label=p[1],p=x;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(x);break}p[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(q){x=[6,q],_=0}finally{w=p=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(x,q):te(p[0][2],re)}function x(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(x){p({value:x,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},B=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",B),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(ad);var xc,Gl;function ym(){if(Gl)return xc;Gl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}xc=t;function t(r,s,o){var g=o&&o.stringify||n,b=1;if(typeof r=="object"&&r!==null){var m=s.length+b;if(m===1)return r;var E=new Array(m);E[0]=g(r);for(var A=1;A<m;A++)E[A]=g(s[A]);return E.join(" ")}if(typeof r!="string")return r;var C=s.length;if(C===0)return r;for(var $="",k=1-b,M=-1,H=r&&r.length||0,Z=0;Z<H;){if(r.charCodeAt(Z)===37&&Z+1<H){switch(M=M>-1?M:0,r.charCodeAt(Z+1)){case 100:case 102:if(k>=C||s[k]==null)break;M<Z&&($+=r.slice(M,Z)),$+=Number(s[k]),M=Z+2,Z++;break;case 105:if(k>=C||s[k]==null)break;M<Z&&($+=r.slice(M,Z)),$+=Math.floor(Number(s[k])),M=Z+2,Z++;break;case 79:case 111:case 106:if(k>=C||s[k]===void 0)break;M<Z&&($+=r.slice(M,Z));var Q=typeof s[k];if(Q==="string"){$+="'"+s[k]+"'",M=Z+2,Z++;break}if(Q==="function"){$+=s[k].name||"<anonymous>",M=Z+2,Z++;break}$+=g(s[k]),M=Z+2,Z++;break;case 115:if(k>=C)break;M<Z&&($+=r.slice(M,Z)),$+=String(s[k]),M=Z+2,Z++;break;case 37:M<Z&&($+=r.slice(M,Z)),$+="%",M=Z+2,Z++,k--;break}++k}++Z}return M===-1?r:(M<H&&($+=r.slice(M)),$)}return xc}var Pc,kl;function vm(){if(kl)return Pc;kl=1;const n=ym();Pc=o;const t=j().console||{},r={mapHttpRequest:H,mapHttpResponse:H,wrapRequestSerializer:Z,wrapResponseSerializer:Z,wrapErrorSerializer:Z,req:H,res:H,err:k};function s(O,u){return Array.isArray(O)?O.filter(function(X){return X!=="!stdSerializers.err"}):O===!0?Object.keys(u):!1}function o(O){O=O||{},O.browser=O.browser||{};const u=O.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const y=O.browser.write||t;O.browser.write&&(O.browser.asObject=!0);const X=O.serializers||{},c=s(O.browser.serialize,X);let f=O.browser.serialize;Array.isArray(O.browser.serialize)&&O.browser.serialize.indexOf("!stdSerializers.err")>-1&&(f=!1);const d=["error","fatal","warn","info","debug","trace"];typeof y=="function"&&(y.error=y.fatal=y.warn=y.info=y.debug=y.trace=y),O.enabled===!1&&(O.level="silent");const w=O.level||"info",_=Object.create(y);_.log||(_.log=Q),Object.defineProperty(_,"levelVal",{get:T}),Object.defineProperty(_,"level",{get:F,set:W});const p={transmit:u,serialize:c,asObject:O.browser.asObject,levels:d,timestamp:M(O)};_.levels=o.levels,_.level=w,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=Q,_.serializers=X,_._serialize=c,_._stdErrSerialize=f,_.child=x,u&&(_._logEvent=$());function T(){return this.level==="silent"?1/0:this.levels.values[this.level]}function F(){return this._level}function W(q){if(q!=="silent"&&!this.levels.values[q])throw Error("unknown level "+q);this._level=q,g(p,_,"error","log"),g(p,_,"fatal","error"),g(p,_,"warn","error"),g(p,_,"info","log"),g(p,_,"debug","log"),g(p,_,"trace","log")}function x(q,te){if(!q)throw new Error("missing bindings for child Pino");te=te||{},c&&q.serializers&&(te.serializers=q.serializers);const re=te.serializers;if(c&&re){var ie=Object.assign({},X,re),ge=O.browser.serialize===!0?Object.keys(ie):c;delete q.serializers,E([q],ge,ie,this._stdErrSerialize)}function le(be){this._childLevel=(be._childLevel|0)+1,this.error=A(be,q,"error"),this.fatal=A(be,q,"fatal"),this.warn=A(be,q,"warn"),this.info=A(be,q,"info"),this.debug=A(be,q,"debug"),this.trace=A(be,q,"trace"),ie&&(this.serializers=ie,this._serialize=ge),u&&(this._logEvent=$([].concat(be._logEvent.bindings,q)))}return le.prototype=this,new le(this)}return _}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ue,epochTime:L,unixTime:B,isoTime:N});function g(O,u,y,X){const c=Object.getPrototypeOf(u);u[y]=u.levelVal>u.levels.values[y]?Q:c[y]?c[y]:t[y]||t[X]||Q,b(O,u,y)}function b(O,u,y){!O.transmit&&u[y]===Q||(u[y]=function(X){return function(){const f=O.timestamp(),d=new Array(arguments.length),w=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var _=0;_<d.length;_++)d[_]=arguments[_];if(O.serialize&&!O.asObject&&E(d,this._serialize,this.serializers,this._stdErrSerialize),O.asObject?X.call(w,m(this,y,d,f)):X.apply(w,d),O.transmit){const p=O.transmit.level||u.level,T=o.levels.values[p],F=o.levels.values[y];if(F<T)return;C(this,{ts:f,methodLevel:y,methodValue:F,transmitLevel:p,transmitValue:o.levels.values[O.transmit.level||u.level],send:O.transmit.send,val:u.levelVal},d)}}}(u[y]))}function m(O,u,y,X){O._serialize&&E(y,O._serialize,O.serializers,O._stdErrSerialize);const c=y.slice();let f=c[0];const d={};X&&(d.time=X),d.level=o.levels.values[u];let w=(O._childLevel|0)+1;if(w<1&&(w=1),f!==null&&typeof f=="object"){for(;w--&&typeof c[0]=="object";)Object.assign(d,c.shift());f=c.length?n(c.shift(),c):void 0}else typeof f=="string"&&(f=n(c.shift(),c));return f!==void 0&&(d.msg=f),d}function E(O,u,y,X){for(const c in O)if(X&&O[c]instanceof Error)O[c]=o.stdSerializers.err(O[c]);else if(typeof O[c]=="object"&&!Array.isArray(O[c]))for(const f in O[c])u&&u.indexOf(f)>-1&&f in y&&(O[c][f]=y[f](O[c][f]))}function A(O,u,y){return function(){const X=new Array(1+arguments.length);X[0]=u;for(var c=1;c<X.length;c++)X[c]=arguments[c-1];return O[y].apply(this,X)}}function C(O,u,y){const X=u.send,c=u.ts,f=u.methodLevel,d=u.methodValue,w=u.val,_=O._logEvent.bindings;E(y,O._serialize||Object.keys(O.serializers),O.serializers,O._stdErrSerialize===void 0?!0:O._stdErrSerialize),O._logEvent.ts=c,O._logEvent.messages=y.filter(function(p){return _.indexOf(p)===-1}),O._logEvent.level.label=f,O._logEvent.level.value=d,X(f,O._logEvent,w),O._logEvent=$(_)}function $(O){return{ts:0,messages:[],bindings:O||[],level:{label:"",value:0}}}function k(O){const u={type:O.constructor.name,msg:O.message,stack:O.stack};for(const y in O)u[y]===void 0&&(u[y]=O[y]);return u}function M(O){return typeof O.timestamp=="function"?O.timestamp:O.timestamp===!1?ue:L}function H(){return{}}function Z(O){return O}function Q(){}function ue(){return!1}function L(){return Date.now()}function B(){return Math.round(Date.now()/1e3)}function N(){return new Date(Date.now()).toISOString()}function j(){function O(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return O(self)||O(window)||O(this)||{}}}return Pc}var Xi={},Wl;function od(){return Wl||(Wl=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.PINO_CUSTOM_CONTEXT_KEY=Xi.PINO_LOGGER_DEFAULTS=void 0,Xi.PINO_LOGGER_DEFAULTS={level:"info"},Xi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Xi}var ar={},Yl;function mm(){if(Yl)return ar;Yl=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=od();function t(m){return Object.assign(Object.assign({},m),{level:(m==null?void 0:m.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=t;function r(m,E=n.PINO_CUSTOM_CONTEXT_KEY){return m[E]||""}ar.getBrowserLoggerContext=r;function s(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){return m[A]=E,m}ar.setBrowserLoggerContext=s;function o(m,E=n.PINO_CUSTOM_CONTEXT_KEY){let A="";return typeof m.bindings>"u"?A=r(m,E):A=m.bindings().context||"",A}ar.getLoggerContext=o;function g(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){const C=o(m,A);return C.trim()?`${C}/${E}`:E}ar.formatChildLoggerContext=g;function b(m,E,A=n.PINO_CUSTOM_CONTEXT_KEY){const C=g(m,E,A),$=m.child({context:C});return s($,C,A)}return ar.generateChildLogger=b,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=ad.exports,r=t.__importDefault(vm());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(od(),n),t.__exportStar(mm(),n)})(Qe);class bm extends en{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class wm extends en{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Em{constructor(t,r){this.logger=t,this.core=r}}class Sm extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Im extends en{constructor(t){super()}}class Om{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}}class xm extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Pm extends en{constructor(t,r){super(),this.core=t,this.logger=r}}class Am{constructor(t,r){this.projectId=t,this.logger=r}}class Tm{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class Cm{constructor(t){this.client=t}}const Rm=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Nm=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function su(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Nm(n)}catch{return n}}function ds(n){return typeof n=="string"?n:Rm(n)||""}var au={},Nn={},$a={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.BrowserRandomSource=void 0;const Jl=65536;class jm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Jl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Jl)));return r}}Ma.BrowserRandomSource=jm;var qa={},Or={};Object.defineProperty(Or,"__esModule",{value:!0});function Dm(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Or.wipe=Dm;Object.defineProperty(qa,"__esModule",{value:!0});qa.NodeRandomSource=void 0;const Fm=Or;class Um{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof V1<"u"){const t=G1();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,Fm.wipe)(r),s}}qa.NodeRandomSource=Um;Object.defineProperty($a,"__esModule",{value:!0});$a.SystemRandomSource=void 0;const Lm=Ma,$m=qa;class Mm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Lm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new $m.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}$a.SystemRandomSource=Mm;var Ue={},cd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(m,E){var A=m>>>16&65535,C=m&65535,$=E>>>16&65535,k=E&65535;return C*k+(A*k+C*$<<16>>>0)|0}n.mul=Math.imul||t;function r(m,E){return m+E|0}n.add=r;function s(m,E){return m-E|0}n.sub=s;function o(m,E){return m<<E|m>>>32-E}n.rotl=o;function g(m,E){return m<<32-E|m>>>E}n.rotr=g;function b(m){return typeof m=="number"&&isFinite(m)&&Math.floor(m)===m}n.isInteger=Number.isInteger||b,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(m){return n.isInteger(m)&&m>=-n.MAX_SAFE_INTEGER&&m<=n.MAX_SAFE_INTEGER}})(cd);Object.defineProperty(Ue,"__esModule",{value:!0});var ud=cd;function qm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}Ue.readInt16BE=qm;function zm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}Ue.readUint16BE=zm;function Hm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}Ue.readInt16LE=Hm;function Bm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}Ue.readUint16LE=Bm;function hd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}Ue.writeUint16BE=hd;Ue.writeInt16BE=hd;function ld(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}Ue.writeUint16LE=ld;Ue.writeInt16LE=ld;function qc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}Ue.readInt32BE=qc;function zc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}Ue.readUint32BE=zc;function Hc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}Ue.readInt32LE=Hc;function Bc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}Ue.readUint32LE=Bc;function Ra(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}Ue.writeUint32BE=Ra;Ue.writeInt32BE=Ra;function Na(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}Ue.writeUint32LE=Na;Ue.writeInt32LE=Na;function Km(n,t){t===void 0&&(t=0);var r=qc(n,t),s=qc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=Km;function Vm(n,t){t===void 0&&(t=0);var r=zc(n,t),s=zc(n,t+4);return r*4294967296+s}Ue.readUint64BE=Vm;function Gm(n,t){t===void 0&&(t=0);var r=Hc(n,t),s=Hc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}Ue.readInt64LE=Gm;function km(n,t){t===void 0&&(t=0);var r=Bc(n,t),s=Bc(n,t+4);return s*4294967296+r}Ue.readUint64LE=km;function fd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ra(n/4294967296>>>0,t,r),Ra(n>>>0,t,r+4),t}Ue.writeUint64BE=fd;Ue.writeInt64BE=fd;function dd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Na(n>>>0,t,r),Na(n/4294967296>>>0,t,r+4),t}Ue.writeUint64LE=dd;Ue.writeInt64LE=dd;function Wm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,g=n/8+r-1;g>=r;g--)s+=t[g]*o,o*=256;return s}Ue.readUintBE=Wm;function Ym(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,g=r;g<r+n/8;g++)s+=t[g]*o,o*=256;return s}Ue.readUintLE=Ym;function Jm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ud.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,g=n/8+s-1;g>=s;g--)r[g]=t/o&255,o*=256;return r}Ue.writeUintBE=Jm;function Xm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ud.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,g=s;g<s+n/8;g++)r[g]=t/o&255,o*=256;return r}Ue.writeUintLE=Xm;function Zm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}Ue.readFloat32BE=Zm;function Qm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}Ue.readFloat32LE=Qm;function eb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}Ue.readFloat64BE=eb;function tb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}Ue.readFloat64LE=tb;function rb(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}Ue.writeFloat32BE=rb;function ib(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}Ue.writeFloat32LE=ib;function nb(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}Ue.writeFloat64BE=nb;function sb(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}Ue.writeFloat64LE=sb;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=$a,r=Ue,s=Or;n.defaultRandomSource=new t.SystemRandomSource;function o(A,C=n.defaultRandomSource){return C.randomBytes(A)}n.randomBytes=o;function g(A=n.defaultRandomSource){const C=o(4,A),$=(0,r.readUint32LE)(C);return(0,s.wipe)(C),$}n.randomUint32=g;const b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function m(A,C=b,$=n.defaultRandomSource){if(C.length<2)throw new Error("randomString charset is too short");if(C.length>256)throw new Error("randomString charset is too long");let k="";const M=C.length,H=256-256%M;for(;A>0;){const Z=o(Math.ceil(A*256/H),$);for(let Q=0;Q<Z.length&&A>0;Q++){const ue=Z[Q];ue<H&&(k+=C.charAt(ue%M),A--)}(0,s.wipe)(Z)}return k}n.randomString=m;function E(A,C=b,$=n.defaultRandomSource){const k=Math.ceil(A/(Math.log(C.length)/Math.LN2));return m(k,C,$)}n.randomStringForEntropy=E})(Nn);var pd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ue,r=Or;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function m(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return m.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},m.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},m.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},m.prototype.update=function(E,A){if(A===void 0&&(A=E.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var C=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&A>0;)this._buffer[this._bufferLength++]=E[C++],A--;this._bufferLength===this.blockSize&&(g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(C=g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,E,C,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=E[C++],A--;return this},m.prototype.finish=function(E){if(!this._finished){var A=this._bytesHashed,C=this._bufferLength,$=A/536870912|0,k=A<<3,M=A%128<112?128:256;this._buffer[C]=128;for(var H=C+1;H<M-8;H++)this._buffer[H]=0;t.writeUint32BE($,this._buffer,M-8),t.writeUint32BE(k,this._buffer,M-4),g(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,M),this._finished=!0}for(var H=0;H<this.digestLength/8;H++)t.writeUint32BE(this._stateHi[H],E,H*8),t.writeUint32BE(this._stateLo[H],E,H*8+4);return this},m.prototype.digest=function(){var E=new Uint8Array(this.digestLength);return this.finish(E),E},m.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},m.prototype.restoreState=function(E){return this._stateHi.set(E.stateHi),this._stateLo.set(E.stateLo),this._bufferLength=E.bufferLength,E.buffer&&this._buffer.set(E.buffer),this._bytesHashed=E.bytesHashed,this._finished=!1,this},m.prototype.cleanSavedState=function(E){r.wipe(E.stateHi),r.wipe(E.stateLo),E.buffer&&r.wipe(E.buffer),E.bufferLength=0,E.bytesHashed=0},m}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function g(m,E,A,C,$,k,M){for(var H=A[0],Z=A[1],Q=A[2],ue=A[3],L=A[4],B=A[5],N=A[6],j=A[7],O=C[0],u=C[1],y=C[2],X=C[3],c=C[4],f=C[5],d=C[6],w=C[7],_,p,T,F,W,x,q,te;M>=128;){for(var re=0;re<16;re++){var ie=8*re+k;m[re]=t.readUint32BE($,ie),E[re]=t.readUint32BE($,ie+4)}for(var re=0;re<80;re++){var ge=H,le=Z,be=Q,J=ue,Y=L,z=B,l=N,D=j,he=O,pe=u,Oe=y,He=X,Ve=c,Le=f,pt=d,gt=w;if(_=j,p=w,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=(L>>>14|c<<32-14)^(L>>>18|c<<32-18)^(c>>>41-32|L<<32-(41-32)),p=(c>>>14|L<<32-14)^(c>>>18|L<<32-18)^(L>>>41-32|c<<32-(41-32)),W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,_=L&B^~L&N,p=c&f^~c&d,W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,_=o[re*2],p=o[re*2+1],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,_=m[re%16],p=E[re%16],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,T=q&65535|te<<16,F=W&65535|x<<16,_=T,p=F,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=(H>>>28|O<<32-28)^(O>>>34-32|H<<32-(34-32))^(O>>>39-32|H<<32-(39-32)),p=(O>>>28|H<<32-28)^(H>>>34-32|O<<32-(34-32))^(H>>>39-32|O<<32-(39-32)),W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,_=H&Z^H&Q^Z&Q,p=O&u^O&y^u&y,W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,D=q&65535|te<<16,gt=W&65535|x<<16,_=J,p=He,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=T,p=F,W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,J=q&65535|te<<16,He=W&65535|x<<16,Z=ge,Q=le,ue=be,L=J,B=Y,N=z,j=l,H=D,u=he,y=pe,X=Oe,c=He,f=Ve,d=Le,w=pt,O=gt,re%16===15)for(var ie=0;ie<16;ie++)_=m[ie],p=E[ie],W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=m[(ie+9)%16],p=E[(ie+9)%16],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,T=m[(ie+1)%16],F=E[(ie+1)%16],_=(T>>>1|F<<32-1)^(T>>>8|F<<32-8)^T>>>7,p=(F>>>1|T<<32-1)^(F>>>8|T<<32-8)^(F>>>7|T<<32-7),W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,T=m[(ie+14)%16],F=E[(ie+14)%16],_=(T>>>19|F<<32-19)^(F>>>61-32|T<<32-(61-32))^T>>>6,p=(F>>>19|T<<32-19)^(T>>>61-32|F<<32-(61-32))^(F>>>6|T<<32-6),W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,m[ie]=q&65535|te<<16,E[ie]=W&65535|x<<16}_=H,p=O,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[0],p=C[0],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[0]=H=q&65535|te<<16,C[0]=O=W&65535|x<<16,_=Z,p=u,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[1],p=C[1],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[1]=Z=q&65535|te<<16,C[1]=u=W&65535|x<<16,_=Q,p=y,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[2],p=C[2],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[2]=Q=q&65535|te<<16,C[2]=y=W&65535|x<<16,_=ue,p=X,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[3],p=C[3],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[3]=ue=q&65535|te<<16,C[3]=X=W&65535|x<<16,_=L,p=c,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[4],p=C[4],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[4]=L=q&65535|te<<16,C[4]=c=W&65535|x<<16,_=B,p=f,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[5],p=C[5],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[5]=B=q&65535|te<<16,C[5]=f=W&65535|x<<16,_=N,p=d,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[6],p=C[6],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[6]=N=q&65535|te<<16,C[6]=d=W&65535|x<<16,_=j,p=w,W=p&65535,x=p>>>16,q=_&65535,te=_>>>16,_=A[7],p=C[7],W+=p&65535,x+=p>>>16,q+=_&65535,te+=_>>>16,x+=W>>>16,q+=x>>>16,te+=q>>>16,A[7]=j=q&65535|te<<16,C[7]=w=W&65535|x<<16,k+=128,M-=128}return k}function b(m){var E=new s;E.update(m);var A=E.digest();return E.clean(),A}n.hash=b})(pd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Nn,r=pd,s=Or;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(J){const Y=new Float64Array(16);if(J)for(let z=0;z<J.length;z++)Y[z]=J[z];return Y}const g=new Uint8Array(32);g[0]=9;const b=o(),m=o([1]),E=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),C=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),$=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),k=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function M(J,Y){for(let z=0;z<16;z++)J[z]=Y[z]|0}function H(J){let Y=1;for(let z=0;z<16;z++){let l=J[z]+Y+65535;Y=Math.floor(l/65536),J[z]=l-Y*65536}J[0]+=Y-1+37*(Y-1)}function Z(J,Y,z){const l=~(z-1);for(let D=0;D<16;D++){const he=l&(J[D]^Y[D]);J[D]^=he,Y[D]^=he}}function Q(J,Y){const z=o(),l=o();for(let D=0;D<16;D++)l[D]=Y[D];H(l),H(l),H(l);for(let D=0;D<2;D++){z[0]=l[0]-65517;for(let pe=1;pe<15;pe++)z[pe]=l[pe]-65535-(z[pe-1]>>16&1),z[pe-1]&=65535;z[15]=l[15]-32767-(z[14]>>16&1);const he=z[15]>>16&1;z[14]&=65535,Z(l,z,1-he)}for(let D=0;D<16;D++)J[2*D]=l[D]&255,J[2*D+1]=l[D]>>8}function ue(J,Y){let z=0;for(let l=0;l<32;l++)z|=J[l]^Y[l];return(1&z-1>>>8)-1}function L(J,Y){const z=new Uint8Array(32),l=new Uint8Array(32);return Q(z,J),Q(l,Y),ue(z,l)}function B(J){const Y=new Uint8Array(32);return Q(Y,J),Y[0]&1}function N(J,Y){for(let z=0;z<16;z++)J[z]=Y[2*z]+(Y[2*z+1]<<8);J[15]&=32767}function j(J,Y,z){for(let l=0;l<16;l++)J[l]=Y[l]+z[l]}function O(J,Y,z){for(let l=0;l<16;l++)J[l]=Y[l]-z[l]}function u(J,Y,z){let l,D,he=0,pe=0,Oe=0,He=0,Ve=0,Le=0,pt=0,gt=0,Me=0,xe=0,je=0,De=0,qe=0,Ae=0,Fe=0,Ie=0,Te=0,Be=0,Pe=0,Ge=0,We=0,et=0,tt=0,Je=0,er=0,lr=0,kr=0,tr=0,ii=0,vi=0,Di=0,Et=z[0],_t=z[1],St=z[2],It=z[3],mt=z[4],yt=z[5],Ut=z[6],Lt=z[7],Ot=z[8],$t=z[9],xt=z[10],Ct=z[11],Pt=z[12],ht=z[13],Mt=z[14],qt=z[15];l=Y[0],he+=l*Et,pe+=l*_t,Oe+=l*St,He+=l*It,Ve+=l*mt,Le+=l*yt,pt+=l*Ut,gt+=l*Lt,Me+=l*Ot,xe+=l*$t,je+=l*xt,De+=l*Ct,qe+=l*Pt,Ae+=l*ht,Fe+=l*Mt,Ie+=l*qt,l=Y[1],pe+=l*Et,Oe+=l*_t,He+=l*St,Ve+=l*It,Le+=l*mt,pt+=l*yt,gt+=l*Ut,Me+=l*Lt,xe+=l*Ot,je+=l*$t,De+=l*xt,qe+=l*Ct,Ae+=l*Pt,Fe+=l*ht,Ie+=l*Mt,Te+=l*qt,l=Y[2],Oe+=l*Et,He+=l*_t,Ve+=l*St,Le+=l*It,pt+=l*mt,gt+=l*yt,Me+=l*Ut,xe+=l*Lt,je+=l*Ot,De+=l*$t,qe+=l*xt,Ae+=l*Ct,Fe+=l*Pt,Ie+=l*ht,Te+=l*Mt,Be+=l*qt,l=Y[3],He+=l*Et,Ve+=l*_t,Le+=l*St,pt+=l*It,gt+=l*mt,Me+=l*yt,xe+=l*Ut,je+=l*Lt,De+=l*Ot,qe+=l*$t,Ae+=l*xt,Fe+=l*Ct,Ie+=l*Pt,Te+=l*ht,Be+=l*Mt,Pe+=l*qt,l=Y[4],Ve+=l*Et,Le+=l*_t,pt+=l*St,gt+=l*It,Me+=l*mt,xe+=l*yt,je+=l*Ut,De+=l*Lt,qe+=l*Ot,Ae+=l*$t,Fe+=l*xt,Ie+=l*Ct,Te+=l*Pt,Be+=l*ht,Pe+=l*Mt,Ge+=l*qt,l=Y[5],Le+=l*Et,pt+=l*_t,gt+=l*St,Me+=l*It,xe+=l*mt,je+=l*yt,De+=l*Ut,qe+=l*Lt,Ae+=l*Ot,Fe+=l*$t,Ie+=l*xt,Te+=l*Ct,Be+=l*Pt,Pe+=l*ht,Ge+=l*Mt,We+=l*qt,l=Y[6],pt+=l*Et,gt+=l*_t,Me+=l*St,xe+=l*It,je+=l*mt,De+=l*yt,qe+=l*Ut,Ae+=l*Lt,Fe+=l*Ot,Ie+=l*$t,Te+=l*xt,Be+=l*Ct,Pe+=l*Pt,Ge+=l*ht,We+=l*Mt,et+=l*qt,l=Y[7],gt+=l*Et,Me+=l*_t,xe+=l*St,je+=l*It,De+=l*mt,qe+=l*yt,Ae+=l*Ut,Fe+=l*Lt,Ie+=l*Ot,Te+=l*$t,Be+=l*xt,Pe+=l*Ct,Ge+=l*Pt,We+=l*ht,et+=l*Mt,tt+=l*qt,l=Y[8],Me+=l*Et,xe+=l*_t,je+=l*St,De+=l*It,qe+=l*mt,Ae+=l*yt,Fe+=l*Ut,Ie+=l*Lt,Te+=l*Ot,Be+=l*$t,Pe+=l*xt,Ge+=l*Ct,We+=l*Pt,et+=l*ht,tt+=l*Mt,Je+=l*qt,l=Y[9],xe+=l*Et,je+=l*_t,De+=l*St,qe+=l*It,Ae+=l*mt,Fe+=l*yt,Ie+=l*Ut,Te+=l*Lt,Be+=l*Ot,Pe+=l*$t,Ge+=l*xt,We+=l*Ct,et+=l*Pt,tt+=l*ht,Je+=l*Mt,er+=l*qt,l=Y[10],je+=l*Et,De+=l*_t,qe+=l*St,Ae+=l*It,Fe+=l*mt,Ie+=l*yt,Te+=l*Ut,Be+=l*Lt,Pe+=l*Ot,Ge+=l*$t,We+=l*xt,et+=l*Ct,tt+=l*Pt,Je+=l*ht,er+=l*Mt,lr+=l*qt,l=Y[11],De+=l*Et,qe+=l*_t,Ae+=l*St,Fe+=l*It,Ie+=l*mt,Te+=l*yt,Be+=l*Ut,Pe+=l*Lt,Ge+=l*Ot,We+=l*$t,et+=l*xt,tt+=l*Ct,Je+=l*Pt,er+=l*ht,lr+=l*Mt,kr+=l*qt,l=Y[12],qe+=l*Et,Ae+=l*_t,Fe+=l*St,Ie+=l*It,Te+=l*mt,Be+=l*yt,Pe+=l*Ut,Ge+=l*Lt,We+=l*Ot,et+=l*$t,tt+=l*xt,Je+=l*Ct,er+=l*Pt,lr+=l*ht,kr+=l*Mt,tr+=l*qt,l=Y[13],Ae+=l*Et,Fe+=l*_t,Ie+=l*St,Te+=l*It,Be+=l*mt,Pe+=l*yt,Ge+=l*Ut,We+=l*Lt,et+=l*Ot,tt+=l*$t,Je+=l*xt,er+=l*Ct,lr+=l*Pt,kr+=l*ht,tr+=l*Mt,ii+=l*qt,l=Y[14],Fe+=l*Et,Ie+=l*_t,Te+=l*St,Be+=l*It,Pe+=l*mt,Ge+=l*yt,We+=l*Ut,et+=l*Lt,tt+=l*Ot,Je+=l*$t,er+=l*xt,lr+=l*Ct,kr+=l*Pt,tr+=l*ht,ii+=l*Mt,vi+=l*qt,l=Y[15],Ie+=l*Et,Te+=l*_t,Be+=l*St,Pe+=l*It,Ge+=l*mt,We+=l*yt,et+=l*Ut,tt+=l*Lt,Je+=l*Ot,er+=l*$t,lr+=l*xt,kr+=l*Ct,tr+=l*Pt,ii+=l*ht,vi+=l*Mt,Di+=l*qt,he+=38*Te,pe+=38*Be,Oe+=38*Pe,He+=38*Ge,Ve+=38*We,Le+=38*et,pt+=38*tt,gt+=38*Je,Me+=38*er,xe+=38*lr,je+=38*kr,De+=38*tr,qe+=38*ii,Ae+=38*vi,Fe+=38*Di,D=1,l=he+D+65535,D=Math.floor(l/65536),he=l-D*65536,l=pe+D+65535,D=Math.floor(l/65536),pe=l-D*65536,l=Oe+D+65535,D=Math.floor(l/65536),Oe=l-D*65536,l=He+D+65535,D=Math.floor(l/65536),He=l-D*65536,l=Ve+D+65535,D=Math.floor(l/65536),Ve=l-D*65536,l=Le+D+65535,D=Math.floor(l/65536),Le=l-D*65536,l=pt+D+65535,D=Math.floor(l/65536),pt=l-D*65536,l=gt+D+65535,D=Math.floor(l/65536),gt=l-D*65536,l=Me+D+65535,D=Math.floor(l/65536),Me=l-D*65536,l=xe+D+65535,D=Math.floor(l/65536),xe=l-D*65536,l=je+D+65535,D=Math.floor(l/65536),je=l-D*65536,l=De+D+65535,D=Math.floor(l/65536),De=l-D*65536,l=qe+D+65535,D=Math.floor(l/65536),qe=l-D*65536,l=Ae+D+65535,D=Math.floor(l/65536),Ae=l-D*65536,l=Fe+D+65535,D=Math.floor(l/65536),Fe=l-D*65536,l=Ie+D+65535,D=Math.floor(l/65536),Ie=l-D*65536,he+=D-1+37*(D-1),D=1,l=he+D+65535,D=Math.floor(l/65536),he=l-D*65536,l=pe+D+65535,D=Math.floor(l/65536),pe=l-D*65536,l=Oe+D+65535,D=Math.floor(l/65536),Oe=l-D*65536,l=He+D+65535,D=Math.floor(l/65536),He=l-D*65536,l=Ve+D+65535,D=Math.floor(l/65536),Ve=l-D*65536,l=Le+D+65535,D=Math.floor(l/65536),Le=l-D*65536,l=pt+D+65535,D=Math.floor(l/65536),pt=l-D*65536,l=gt+D+65535,D=Math.floor(l/65536),gt=l-D*65536,l=Me+D+65535,D=Math.floor(l/65536),Me=l-D*65536,l=xe+D+65535,D=Math.floor(l/65536),xe=l-D*65536,l=je+D+65535,D=Math.floor(l/65536),je=l-D*65536,l=De+D+65535,D=Math.floor(l/65536),De=l-D*65536,l=qe+D+65535,D=Math.floor(l/65536),qe=l-D*65536,l=Ae+D+65535,D=Math.floor(l/65536),Ae=l-D*65536,l=Fe+D+65535,D=Math.floor(l/65536),Fe=l-D*65536,l=Ie+D+65535,D=Math.floor(l/65536),Ie=l-D*65536,he+=D-1+37*(D-1),J[0]=he,J[1]=pe,J[2]=Oe,J[3]=He,J[4]=Ve,J[5]=Le,J[6]=pt,J[7]=gt,J[8]=Me,J[9]=xe,J[10]=je,J[11]=De,J[12]=qe,J[13]=Ae,J[14]=Fe,J[15]=Ie}function y(J,Y){u(J,Y,Y)}function X(J,Y){const z=o();let l;for(l=0;l<16;l++)z[l]=Y[l];for(l=253;l>=0;l--)y(z,z),l!==2&&l!==4&&u(z,z,Y);for(l=0;l<16;l++)J[l]=z[l]}function c(J,Y){const z=o();let l;for(l=0;l<16;l++)z[l]=Y[l];for(l=250;l>=0;l--)y(z,z),l!==1&&u(z,z,Y);for(l=0;l<16;l++)J[l]=z[l]}function f(J,Y){const z=o(),l=o(),D=o(),he=o(),pe=o(),Oe=o(),He=o(),Ve=o(),Le=o();O(z,J[1],J[0]),O(Le,Y[1],Y[0]),u(z,z,Le),j(l,J[0],J[1]),j(Le,Y[0],Y[1]),u(l,l,Le),u(D,J[3],Y[3]),u(D,D,A),u(he,J[2],Y[2]),j(he,he,he),O(pe,l,z),O(Oe,he,D),j(He,he,D),j(Ve,l,z),u(J[0],pe,Oe),u(J[1],Ve,He),u(J[2],He,Oe),u(J[3],pe,Ve)}function d(J,Y,z){for(let l=0;l<4;l++)Z(J[l],Y[l],z)}function w(J,Y){const z=o(),l=o(),D=o();X(D,Y[2]),u(z,Y[0],D),u(l,Y[1],D),Q(J,l),J[31]^=B(z)<<7}function _(J,Y,z){M(J[0],b),M(J[1],m),M(J[2],m),M(J[3],b);for(let l=255;l>=0;--l){const D=z[l/8|0]>>(l&7)&1;d(J,Y,D),f(Y,J),f(J,J),d(J,Y,D)}}function p(J,Y){const z=[o(),o(),o(),o()];M(z[0],C),M(z[1],$),M(z[2],m),u(z[3],C,$),_(J,z,Y)}function T(J){if(J.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const Y=(0,r.hash)(J);Y[0]&=248,Y[31]&=127,Y[31]|=64;const z=new Uint8Array(32),l=[o(),o(),o(),o()];p(l,Y),w(z,l);const D=new Uint8Array(64);return D.set(J),D.set(z,32),{publicKey:z,secretKey:D}}n.generateKeyPairFromSeed=T;function F(J){const Y=(0,t.randomBytes)(32,J),z=T(Y);return(0,s.wipe)(Y),z}n.generateKeyPair=F;function W(J){if(J.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(J.subarray(32))}n.extractPublicKeyFromSecretKey=W;const x=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q(J,Y){let z,l,D,he;for(l=63;l>=32;--l){for(z=0,D=l-32,he=l-12;D<he;++D)Y[D]+=z-16*Y[l]*x[D-(l-32)],z=Math.floor((Y[D]+128)/256),Y[D]-=z*256;Y[D]+=z,Y[l]=0}for(z=0,D=0;D<32;D++)Y[D]+=z-(Y[31]>>4)*x[D],z=Y[D]>>8,Y[D]&=255;for(D=0;D<32;D++)Y[D]-=z*x[D];for(l=0;l<32;l++)Y[l+1]+=Y[l]>>8,J[l]=Y[l]&255}function te(J){const Y=new Float64Array(64);for(let z=0;z<64;z++)Y[z]=J[z];for(let z=0;z<64;z++)J[z]=0;q(J,Y)}function re(J,Y){const z=new Float64Array(64),l=[o(),o(),o(),o()],D=(0,r.hash)(J.subarray(0,32));D[0]&=248,D[31]&=127,D[31]|=64;const he=new Uint8Array(64);he.set(D.subarray(32),32);const pe=new r.SHA512;pe.update(he.subarray(32)),pe.update(Y);const Oe=pe.digest();pe.clean(),te(Oe),p(l,Oe),w(he,l),pe.reset(),pe.update(he.subarray(0,32)),pe.update(J.subarray(32)),pe.update(Y);const He=pe.digest();te(He);for(let Ve=0;Ve<32;Ve++)z[Ve]=Oe[Ve];for(let Ve=0;Ve<32;Ve++)for(let Le=0;Le<32;Le++)z[Ve+Le]+=He[Ve]*D[Le];return q(he.subarray(32),z),he}n.sign=re;function ie(J,Y){const z=o(),l=o(),D=o(),he=o(),pe=o(),Oe=o(),He=o();return M(J[2],m),N(J[1],Y),y(D,J[1]),u(he,D,E),O(D,D,J[2]),j(he,J[2],he),y(pe,he),y(Oe,pe),u(He,Oe,pe),u(z,He,D),u(z,z,he),c(z,z),u(z,z,D),u(z,z,he),u(z,z,he),u(J[0],z,he),y(l,J[0]),u(l,l,he),L(l,D)&&u(J[0],J[0],k),y(l,J[0]),u(l,l,he),L(l,D)?-1:(B(J[0])===Y[31]>>7&&O(J[0],b,J[0]),u(J[3],J[0],J[1]),0)}function ge(J,Y,z){const l=new Uint8Array(32),D=[o(),o(),o(),o()],he=[o(),o(),o(),o()];if(z.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ie(he,J))return!1;const pe=new r.SHA512;pe.update(z.subarray(0,32)),pe.update(J),pe.update(Y);const Oe=pe.digest();return te(Oe),_(D,he,Oe),p(he,z.subarray(32)),f(D,he),w(l,D),!ue(z,l)}n.verify=ge;function le(J){let Y=[o(),o(),o(),o()];if(ie(Y,J))throw new Error("Ed25519: invalid public key");let z=o(),l=o(),D=Y[1];j(z,m,D),O(l,m,D),X(l,l),u(z,z,l);let he=new Uint8Array(32);return Q(he,z),he}n.convertPublicKeyToX25519=le;function be(J){const Y=(0,r.hash)(J.subarray(0,32));Y[0]&=248,Y[31]&=127,Y[31]|=64;const z=new Uint8Array(Y.subarray(0,32));return(0,s.wipe)(Y),z}n.convertSecretKeyToX25519=be})(au);const ab="EdDSA",ob="JWT",gd=".",_d="base64url",cb="utf8",ub="utf8",hb=":",lb="did",fb="key",Xl="base58btc",db="z",pb="K36",gb=32;function ja(n){return ur(vr(ds(n),cb),_d)}function yd(n){const t=vr(pb,Xl),r=db+ur(Mc([t,n]),Xl);return[lb,fb,r].join(hb)}function _b(n){return ur(n,_d)}function yb(n){return vr([ja(n.header),ja(n.payload)].join(gd),ub)}function vb(n){return[ja(n.header),ja(n.payload),_b(n.signature)].join(gd)}function Zl(n=Nn.randomBytes(gb)){return au.generateKeyPairFromSeed(n)}async function mb(n,t,r,s,o=me.fromMiliseconds(Date.now())){const g={alg:ab,typ:ob},b=yd(s.publicKey),m=o+r,E={iss:b,sub:n,aud:t,iat:o,exp:m},A=yb({header:g,payload:E}),C=au.sign(s.secretKey,A);return vb({header:g,payload:E,signature:C})}var ou={},za={};Object.defineProperty(za,"__esModule",{value:!0});var Qt=Ue,Kc=Or,bb=20;function wb(n,t,r){for(var s=1634760805,o=857760878,g=2036477234,b=1797285236,m=r[3]<<24|r[2]<<16|r[1]<<8|r[0],E=r[7]<<24|r[6]<<16|r[5]<<8|r[4],A=r[11]<<24|r[10]<<16|r[9]<<8|r[8],C=r[15]<<24|r[14]<<16|r[13]<<8|r[12],$=r[19]<<24|r[18]<<16|r[17]<<8|r[16],k=r[23]<<24|r[22]<<16|r[21]<<8|r[20],M=r[27]<<24|r[26]<<16|r[25]<<8|r[24],H=r[31]<<24|r[30]<<16|r[29]<<8|r[28],Z=t[3]<<24|t[2]<<16|t[1]<<8|t[0],Q=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ue=t[11]<<24|t[10]<<16|t[9]<<8|t[8],L=t[15]<<24|t[14]<<16|t[13]<<8|t[12],B=s,N=o,j=g,O=b,u=m,y=E,X=A,c=C,f=$,d=k,w=M,_=H,p=Z,T=Q,F=ue,W=L,x=0;x<bb;x+=2)B=B+u|0,p^=B,p=p>>>32-16|p<<16,f=f+p|0,u^=f,u=u>>>32-12|u<<12,N=N+y|0,T^=N,T=T>>>32-16|T<<16,d=d+T|0,y^=d,y=y>>>32-12|y<<12,j=j+X|0,F^=j,F=F>>>32-16|F<<16,w=w+F|0,X^=w,X=X>>>32-12|X<<12,O=O+c|0,W^=O,W=W>>>32-16|W<<16,_=_+W|0,c^=_,c=c>>>32-12|c<<12,j=j+X|0,F^=j,F=F>>>32-8|F<<8,w=w+F|0,X^=w,X=X>>>32-7|X<<7,O=O+c|0,W^=O,W=W>>>32-8|W<<8,_=_+W|0,c^=_,c=c>>>32-7|c<<7,N=N+y|0,T^=N,T=T>>>32-8|T<<8,d=d+T|0,y^=d,y=y>>>32-7|y<<7,B=B+u|0,p^=B,p=p>>>32-8|p<<8,f=f+p|0,u^=f,u=u>>>32-7|u<<7,B=B+y|0,W^=B,W=W>>>32-16|W<<16,w=w+W|0,y^=w,y=y>>>32-12|y<<12,N=N+X|0,p^=N,p=p>>>32-16|p<<16,_=_+p|0,X^=_,X=X>>>32-12|X<<12,j=j+c|0,T^=j,T=T>>>32-16|T<<16,f=f+T|0,c^=f,c=c>>>32-12|c<<12,O=O+u|0,F^=O,F=F>>>32-16|F<<16,d=d+F|0,u^=d,u=u>>>32-12|u<<12,j=j+c|0,T^=j,T=T>>>32-8|T<<8,f=f+T|0,c^=f,c=c>>>32-7|c<<7,O=O+u|0,F^=O,F=F>>>32-8|F<<8,d=d+F|0,u^=d,u=u>>>32-7|u<<7,N=N+X|0,p^=N,p=p>>>32-8|p<<8,_=_+p|0,X^=_,X=X>>>32-7|X<<7,B=B+y|0,W^=B,W=W>>>32-8|W<<8,w=w+W|0,y^=w,y=y>>>32-7|y<<7;Qt.writeUint32LE(B+s|0,n,0),Qt.writeUint32LE(N+o|0,n,4),Qt.writeUint32LE(j+g|0,n,8),Qt.writeUint32LE(O+b|0,n,12),Qt.writeUint32LE(u+m|0,n,16),Qt.writeUint32LE(y+E|0,n,20),Qt.writeUint32LE(X+A|0,n,24),Qt.writeUint32LE(c+C|0,n,28),Qt.writeUint32LE(f+$|0,n,32),Qt.writeUint32LE(d+k|0,n,36),Qt.writeUint32LE(w+M|0,n,40),Qt.writeUint32LE(_+H|0,n,44),Qt.writeUint32LE(p+Z|0,n,48),Qt.writeUint32LE(T+Q|0,n,52),Qt.writeUint32LE(F+ue|0,n,56),Qt.writeUint32LE(W+L|0,n,60)}function vd(n,t,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var g,b;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");g=new Uint8Array(16),b=g.length-t.length,g.set(t,b)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");g=t,b=o}for(var m=new Uint8Array(64),E=0;E<r.length;E+=64){wb(m,g,n);for(var A=E;A<E+64&&A<r.length;A++)s[A]=r[A]^m[A-E];Sb(g,0,b)}return Kc.wipe(m),o===0&&Kc.wipe(g),s}za.streamXOR=vd;function Eb(n,t,r,s){return s===void 0&&(s=0),Kc.wipe(r),vd(n,t,r,r,s)}za.stream=Eb;function Sb(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var md={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});function Ib(n,t,r){return~(n-1)&t|n-1&r}Ri.select=Ib;function Ob(n,t){return(n|0)-(t|0)-1>>>31&1}Ri.lessOrEqual=Ob;function bd(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ri.compare=bd;function xb(n,t){return n.length===0||t.length===0?!1:bd(n,t)!==0}Ri.equal=xb;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ri,r=Or;n.DIGEST_LENGTH=16;var s=function(){function b(m){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var E=m[0]|m[1]<<8;this._r[0]=E&8191;var A=m[2]|m[3]<<8;this._r[1]=(E>>>13|A<<3)&8191;var C=m[4]|m[5]<<8;this._r[2]=(A>>>10|C<<6)&7939;var $=m[6]|m[7]<<8;this._r[3]=(C>>>7|$<<9)&8191;var k=m[8]|m[9]<<8;this._r[4]=($>>>4|k<<12)&255,this._r[5]=k>>>1&8190;var M=m[10]|m[11]<<8;this._r[6]=(k>>>14|M<<2)&8191;var H=m[12]|m[13]<<8;this._r[7]=(M>>>11|H<<5)&8065;var Z=m[14]|m[15]<<8;this._r[8]=(H>>>8|Z<<8)&8191,this._r[9]=Z>>>5&127,this._pad[0]=m[16]|m[17]<<8,this._pad[1]=m[18]|m[19]<<8,this._pad[2]=m[20]|m[21]<<8,this._pad[3]=m[22]|m[23]<<8,this._pad[4]=m[24]|m[25]<<8,this._pad[5]=m[26]|m[27]<<8,this._pad[6]=m[28]|m[29]<<8,this._pad[7]=m[30]|m[31]<<8}return b.prototype._blocks=function(m,E,A){for(var C=this._fin?0:2048,$=this._h[0],k=this._h[1],M=this._h[2],H=this._h[3],Z=this._h[4],Q=this._h[5],ue=this._h[6],L=this._h[7],B=this._h[8],N=this._h[9],j=this._r[0],O=this._r[1],u=this._r[2],y=this._r[3],X=this._r[4],c=this._r[5],f=this._r[6],d=this._r[7],w=this._r[8],_=this._r[9];A>=16;){var p=m[E+0]|m[E+1]<<8;$+=p&8191;var T=m[E+2]|m[E+3]<<8;k+=(p>>>13|T<<3)&8191;var F=m[E+4]|m[E+5]<<8;M+=(T>>>10|F<<6)&8191;var W=m[E+6]|m[E+7]<<8;H+=(F>>>7|W<<9)&8191;var x=m[E+8]|m[E+9]<<8;Z+=(W>>>4|x<<12)&8191,Q+=x>>>1&8191;var q=m[E+10]|m[E+11]<<8;ue+=(x>>>14|q<<2)&8191;var te=m[E+12]|m[E+13]<<8;L+=(q>>>11|te<<5)&8191;var re=m[E+14]|m[E+15]<<8;B+=(te>>>8|re<<8)&8191,N+=re>>>5|C;var ie=0,ge=ie;ge+=$*j,ge+=k*(5*_),ge+=M*(5*w),ge+=H*(5*d),ge+=Z*(5*f),ie=ge>>>13,ge&=8191,ge+=Q*(5*c),ge+=ue*(5*X),ge+=L*(5*y),ge+=B*(5*u),ge+=N*(5*O),ie+=ge>>>13,ge&=8191;var le=ie;le+=$*O,le+=k*j,le+=M*(5*_),le+=H*(5*w),le+=Z*(5*d),ie=le>>>13,le&=8191,le+=Q*(5*f),le+=ue*(5*c),le+=L*(5*X),le+=B*(5*y),le+=N*(5*u),ie+=le>>>13,le&=8191;var be=ie;be+=$*u,be+=k*O,be+=M*j,be+=H*(5*_),be+=Z*(5*w),ie=be>>>13,be&=8191,be+=Q*(5*d),be+=ue*(5*f),be+=L*(5*c),be+=B*(5*X),be+=N*(5*y),ie+=be>>>13,be&=8191;var J=ie;J+=$*y,J+=k*u,J+=M*O,J+=H*j,J+=Z*(5*_),ie=J>>>13,J&=8191,J+=Q*(5*w),J+=ue*(5*d),J+=L*(5*f),J+=B*(5*c),J+=N*(5*X),ie+=J>>>13,J&=8191;var Y=ie;Y+=$*X,Y+=k*y,Y+=M*u,Y+=H*O,Y+=Z*j,ie=Y>>>13,Y&=8191,Y+=Q*(5*_),Y+=ue*(5*w),Y+=L*(5*d),Y+=B*(5*f),Y+=N*(5*c),ie+=Y>>>13,Y&=8191;var z=ie;z+=$*c,z+=k*X,z+=M*y,z+=H*u,z+=Z*O,ie=z>>>13,z&=8191,z+=Q*j,z+=ue*(5*_),z+=L*(5*w),z+=B*(5*d),z+=N*(5*f),ie+=z>>>13,z&=8191;var l=ie;l+=$*f,l+=k*c,l+=M*X,l+=H*y,l+=Z*u,ie=l>>>13,l&=8191,l+=Q*O,l+=ue*j,l+=L*(5*_),l+=B*(5*w),l+=N*(5*d),ie+=l>>>13,l&=8191;var D=ie;D+=$*d,D+=k*f,D+=M*c,D+=H*X,D+=Z*y,ie=D>>>13,D&=8191,D+=Q*u,D+=ue*O,D+=L*j,D+=B*(5*_),D+=N*(5*w),ie+=D>>>13,D&=8191;var he=ie;he+=$*w,he+=k*d,he+=M*f,he+=H*c,he+=Z*X,ie=he>>>13,he&=8191,he+=Q*y,he+=ue*u,he+=L*O,he+=B*j,he+=N*(5*_),ie+=he>>>13,he&=8191;var pe=ie;pe+=$*_,pe+=k*w,pe+=M*d,pe+=H*f,pe+=Z*c,ie=pe>>>13,pe&=8191,pe+=Q*X,pe+=ue*y,pe+=L*u,pe+=B*O,pe+=N*j,ie+=pe>>>13,pe&=8191,ie=(ie<<2)+ie|0,ie=ie+ge|0,ge=ie&8191,ie=ie>>>13,le+=ie,$=ge,k=le,M=be,H=J,Z=Y,Q=z,ue=l,L=D,B=he,N=pe,E+=16,A-=16}this._h[0]=$,this._h[1]=k,this._h[2]=M,this._h[3]=H,this._h[4]=Z,this._h[5]=Q,this._h[6]=ue,this._h[7]=L,this._h[8]=B,this._h[9]=N},b.prototype.finish=function(m,E){E===void 0&&(E=0);var A=new Uint16Array(10),C,$,k,M;if(this._leftover){for(M=this._leftover,this._buffer[M++]=1;M<16;M++)this._buffer[M]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(C=this._h[1]>>>13,this._h[1]&=8191,M=2;M<10;M++)this._h[M]+=C,C=this._h[M]>>>13,this._h[M]&=8191;for(this._h[0]+=C*5,C=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=C,C=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=C,A[0]=this._h[0]+5,C=A[0]>>>13,A[0]&=8191,M=1;M<10;M++)A[M]=this._h[M]+C,C=A[M]>>>13,A[M]&=8191;for(A[9]-=1<<13,$=(C^1)-1,M=0;M<10;M++)A[M]&=$;for($=~$,M=0;M<10;M++)this._h[M]=this._h[M]&$|A[M];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,k=this._h[0]+this._pad[0],this._h[0]=k&65535,M=1;M<8;M++)k=(this._h[M]+this._pad[M]|0)+(k>>>16)|0,this._h[M]=k&65535;return m[E+0]=this._h[0]>>>0,m[E+1]=this._h[0]>>>8,m[E+2]=this._h[1]>>>0,m[E+3]=this._h[1]>>>8,m[E+4]=this._h[2]>>>0,m[E+5]=this._h[2]>>>8,m[E+6]=this._h[3]>>>0,m[E+7]=this._h[3]>>>8,m[E+8]=this._h[4]>>>0,m[E+9]=this._h[4]>>>8,m[E+10]=this._h[5]>>>0,m[E+11]=this._h[5]>>>8,m[E+12]=this._h[6]>>>0,m[E+13]=this._h[6]>>>8,m[E+14]=this._h[7]>>>0,m[E+15]=this._h[7]>>>8,this._finished=!0,this},b.prototype.update=function(m){var E=0,A=m.length,C;if(this._leftover){C=16-this._leftover,C>A&&(C=A);for(var $=0;$<C;$++)this._buffer[this._leftover+$]=m[E+$];if(A-=C,E+=C,this._leftover+=C,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(A>=16&&(C=A-A%16,this._blocks(m,E,C),E+=C,A-=C),A){for(var $=0;$<A;$++)this._buffer[this._leftover+$]=m[E+$];this._leftover+=A}return this},b.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var m=new Uint8Array(16);return this.finish(m),m},b.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},b}();n.Poly1305=s;function o(b,m){var E=new s(b);E.update(m);var A=E.digest();return E.clean(),A}n.oneTimeAuth=o;function g(b,m){return b.length!==n.DIGEST_LENGTH||m.length!==n.DIGEST_LENGTH?!1:t.equal(b,m)}n.equal=g})(md);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=za,r=md,s=Or,o=Ue,g=Ri;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var b=new Uint8Array(16),m=function(){function E(A){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,A.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(A)}return E.prototype.seal=function(A,C,$,k){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var M=new Uint8Array(16);M.set(A,M.length-A.length);var H=new Uint8Array(32);t.stream(this._key,M,H,4);var Z=C.length+this.tagLength,Q;if(k){if(k.length!==Z)throw new Error("ChaCha20Poly1305: incorrect destination length");Q=k}else Q=new Uint8Array(Z);return t.streamXOR(this._key,M,C,Q,4),this._authenticate(Q.subarray(Q.length-this.tagLength,Q.length),H,Q.subarray(0,Q.length-this.tagLength),$),s.wipe(M),Q},E.prototype.open=function(A,C,$,k){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(C.length<this.tagLength)return null;var M=new Uint8Array(16);M.set(A,M.length-A.length);var H=new Uint8Array(32);t.stream(this._key,M,H,4);var Z=new Uint8Array(this.tagLength);if(this._authenticate(Z,H,C.subarray(0,C.length-this.tagLength),$),!g.equal(Z,C.subarray(C.length-this.tagLength,C.length)))return null;var Q=C.length-this.tagLength,ue;if(k){if(k.length!==Q)throw new Error("ChaCha20Poly1305: incorrect destination length");ue=k}else ue=new Uint8Array(Q);return t.streamXOR(this._key,M,C.subarray(0,C.length-this.tagLength),ue,4),s.wipe(M),ue},E.prototype.clean=function(){return s.wipe(this._key),this},E.prototype._authenticate=function(A,C,$,k){var M=new r.Poly1305(C);k&&(M.update(k),k.length%16>0&&M.update(b.subarray(k.length%16))),M.update($),$.length%16>0&&M.update(b.subarray($.length%16));var H=new Uint8Array(8);k&&o.writeUint64LE(k.length,H),M.update(H),o.writeUint64LE($.length,H),M.update(H);for(var Z=M.digest(),Q=0;Q<Z.length;Q++)A[Q]=Z[Q];M.clean(),s.wipe(Z),s.wipe(H)},E}();n.ChaCha20Poly1305=m})(ou);var wd={},vs={},cu={};Object.defineProperty(cu,"__esModule",{value:!0});function Pb(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}cu.isSerializableHash=Pb;Object.defineProperty(vs,"__esModule",{value:!0});var Qr=cu,Ab=Ri,Tb=Or,Ed=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Qr.isSerializableHash(this._inner)&&Qr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Tb.wipe(s)}return n.prototype.reset=function(){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Qr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Qr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();vs.HMAC=Ed;function Cb(n,t,r){var s=new Ed(n,t);s.update(r);var o=s.digest();return s.clean(),o}vs.hmac=Cb;vs.equal=Ab.equal;Object.defineProperty(wd,"__esModule",{value:!0});var Ql=vs,ef=Or,Rb=function(){function n(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var g=Ql.hmac(this._hash,s,r);this._hmac=new Ql.HMAC(t,g),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),ef.wipe(this._buffer),ef.wipe(this._counter),this._bufpos=0},n}(),Nb=wd.HKDF=Rb,Ha={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ue,r=Or;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function m(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return m.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},m.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},m.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},m.prototype.update=function(E,A){if(A===void 0&&(A=E.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var C=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&A>0;)this._buffer[this._bufferLength++]=E[C++],A--;this._bufferLength===this.blockSize&&(g(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(C=g(this._temp,this._state,E,C,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=E[C++],A--;return this},m.prototype.finish=function(E){if(!this._finished){var A=this._bytesHashed,C=this._bufferLength,$=A/536870912|0,k=A<<3,M=A%64<56?64:128;this._buffer[C]=128;for(var H=C+1;H<M-8;H++)this._buffer[H]=0;t.writeUint32BE($,this._buffer,M-8),t.writeUint32BE(k,this._buffer,M-4),g(this._temp,this._state,this._buffer,0,M),this._finished=!0}for(var H=0;H<this.digestLength/4;H++)t.writeUint32BE(this._state[H],E,H*4);return this},m.prototype.digest=function(){var E=new Uint8Array(this.digestLength);return this.finish(E),E},m.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},m.prototype.restoreState=function(E){return this._state.set(E.state),this._bufferLength=E.bufferLength,E.buffer&&this._buffer.set(E.buffer),this._bytesHashed=E.bytesHashed,this._finished=!1,this},m.prototype.cleanSavedState=function(E){r.wipe(E.state),E.buffer&&r.wipe(E.buffer),E.bufferLength=0,E.bytesHashed=0},m}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function g(m,E,A,C,$){for(;$>=64;){for(var k=E[0],M=E[1],H=E[2],Z=E[3],Q=E[4],ue=E[5],L=E[6],B=E[7],N=0;N<16;N++){var j=C+N*4;m[N]=t.readUint32BE(A,j)}for(var N=16;N<64;N++){var O=m[N-2],u=(O>>>17|O<<32-17)^(O>>>19|O<<32-19)^O>>>10;O=m[N-15];var y=(O>>>7|O<<32-7)^(O>>>18|O<<32-18)^O>>>3;m[N]=(u+m[N-7]|0)+(y+m[N-16]|0)}for(var N=0;N<64;N++){var u=(((Q>>>6|Q<<26)^(Q>>>11|Q<<21)^(Q>>>25|Q<<7))+(Q&ue^~Q&L)|0)+(B+(o[N]+m[N]|0)|0)|0,y=((k>>>2|k<<32-2)^(k>>>13|k<<32-13)^(k>>>22|k<<32-22))+(k&M^k&H^M&H)|0;B=L,L=ue,ue=Q,Q=Z+u|0,Z=H,H=M,M=k,k=u+y|0}E[0]+=k,E[1]+=M,E[2]+=H,E[3]+=Z,E[4]+=Q,E[5]+=ue,E[6]+=L,E[7]+=B,C+=64,$-=64}return C}function b(m){var E=new s;E.update(m);var A=E.digest();return E.clean(),A}n.hash=b})(Ha);var uu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Nn,r=Or;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(N){const j=new Float64Array(16);if(N)for(let O=0;O<N.length;O++)j[O]=N[O];return j}const o=new Uint8Array(32);o[0]=9;const g=s([56129,1]);function b(N){let j=1;for(let O=0;O<16;O++){let u=N[O]+j+65535;j=Math.floor(u/65536),N[O]=u-j*65536}N[0]+=j-1+37*(j-1)}function m(N,j,O){const u=~(O-1);for(let y=0;y<16;y++){const X=u&(N[y]^j[y]);N[y]^=X,j[y]^=X}}function E(N,j){const O=s(),u=s();for(let y=0;y<16;y++)u[y]=j[y];b(u),b(u),b(u);for(let y=0;y<2;y++){O[0]=u[0]-65517;for(let c=1;c<15;c++)O[c]=u[c]-65535-(O[c-1]>>16&1),O[c-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const X=O[15]>>16&1;O[14]&=65535,m(u,O,1-X)}for(let y=0;y<16;y++)N[2*y]=u[y]&255,N[2*y+1]=u[y]>>8}function A(N,j){for(let O=0;O<16;O++)N[O]=j[2*O]+(j[2*O+1]<<8);N[15]&=32767}function C(N,j,O){for(let u=0;u<16;u++)N[u]=j[u]+O[u]}function $(N,j,O){for(let u=0;u<16;u++)N[u]=j[u]-O[u]}function k(N,j,O){let u,y,X=0,c=0,f=0,d=0,w=0,_=0,p=0,T=0,F=0,W=0,x=0,q=0,te=0,re=0,ie=0,ge=0,le=0,be=0,J=0,Y=0,z=0,l=0,D=0,he=0,pe=0,Oe=0,He=0,Ve=0,Le=0,pt=0,gt=0,Me=O[0],xe=O[1],je=O[2],De=O[3],qe=O[4],Ae=O[5],Fe=O[6],Ie=O[7],Te=O[8],Be=O[9],Pe=O[10],Ge=O[11],We=O[12],et=O[13],tt=O[14],Je=O[15];u=j[0],X+=u*Me,c+=u*xe,f+=u*je,d+=u*De,w+=u*qe,_+=u*Ae,p+=u*Fe,T+=u*Ie,F+=u*Te,W+=u*Be,x+=u*Pe,q+=u*Ge,te+=u*We,re+=u*et,ie+=u*tt,ge+=u*Je,u=j[1],c+=u*Me,f+=u*xe,d+=u*je,w+=u*De,_+=u*qe,p+=u*Ae,T+=u*Fe,F+=u*Ie,W+=u*Te,x+=u*Be,q+=u*Pe,te+=u*Ge,re+=u*We,ie+=u*et,ge+=u*tt,le+=u*Je,u=j[2],f+=u*Me,d+=u*xe,w+=u*je,_+=u*De,p+=u*qe,T+=u*Ae,F+=u*Fe,W+=u*Ie,x+=u*Te,q+=u*Be,te+=u*Pe,re+=u*Ge,ie+=u*We,ge+=u*et,le+=u*tt,be+=u*Je,u=j[3],d+=u*Me,w+=u*xe,_+=u*je,p+=u*De,T+=u*qe,F+=u*Ae,W+=u*Fe,x+=u*Ie,q+=u*Te,te+=u*Be,re+=u*Pe,ie+=u*Ge,ge+=u*We,le+=u*et,be+=u*tt,J+=u*Je,u=j[4],w+=u*Me,_+=u*xe,p+=u*je,T+=u*De,F+=u*qe,W+=u*Ae,x+=u*Fe,q+=u*Ie,te+=u*Te,re+=u*Be,ie+=u*Pe,ge+=u*Ge,le+=u*We,be+=u*et,J+=u*tt,Y+=u*Je,u=j[5],_+=u*Me,p+=u*xe,T+=u*je,F+=u*De,W+=u*qe,x+=u*Ae,q+=u*Fe,te+=u*Ie,re+=u*Te,ie+=u*Be,ge+=u*Pe,le+=u*Ge,be+=u*We,J+=u*et,Y+=u*tt,z+=u*Je,u=j[6],p+=u*Me,T+=u*xe,F+=u*je,W+=u*De,x+=u*qe,q+=u*Ae,te+=u*Fe,re+=u*Ie,ie+=u*Te,ge+=u*Be,le+=u*Pe,be+=u*Ge,J+=u*We,Y+=u*et,z+=u*tt,l+=u*Je,u=j[7],T+=u*Me,F+=u*xe,W+=u*je,x+=u*De,q+=u*qe,te+=u*Ae,re+=u*Fe,ie+=u*Ie,ge+=u*Te,le+=u*Be,be+=u*Pe,J+=u*Ge,Y+=u*We,z+=u*et,l+=u*tt,D+=u*Je,u=j[8],F+=u*Me,W+=u*xe,x+=u*je,q+=u*De,te+=u*qe,re+=u*Ae,ie+=u*Fe,ge+=u*Ie,le+=u*Te,be+=u*Be,J+=u*Pe,Y+=u*Ge,z+=u*We,l+=u*et,D+=u*tt,he+=u*Je,u=j[9],W+=u*Me,x+=u*xe,q+=u*je,te+=u*De,re+=u*qe,ie+=u*Ae,ge+=u*Fe,le+=u*Ie,be+=u*Te,J+=u*Be,Y+=u*Pe,z+=u*Ge,l+=u*We,D+=u*et,he+=u*tt,pe+=u*Je,u=j[10],x+=u*Me,q+=u*xe,te+=u*je,re+=u*De,ie+=u*qe,ge+=u*Ae,le+=u*Fe,be+=u*Ie,J+=u*Te,Y+=u*Be,z+=u*Pe,l+=u*Ge,D+=u*We,he+=u*et,pe+=u*tt,Oe+=u*Je,u=j[11],q+=u*Me,te+=u*xe,re+=u*je,ie+=u*De,ge+=u*qe,le+=u*Ae,be+=u*Fe,J+=u*Ie,Y+=u*Te,z+=u*Be,l+=u*Pe,D+=u*Ge,he+=u*We,pe+=u*et,Oe+=u*tt,He+=u*Je,u=j[12],te+=u*Me,re+=u*xe,ie+=u*je,ge+=u*De,le+=u*qe,be+=u*Ae,J+=u*Fe,Y+=u*Ie,z+=u*Te,l+=u*Be,D+=u*Pe,he+=u*Ge,pe+=u*We,Oe+=u*et,He+=u*tt,Ve+=u*Je,u=j[13],re+=u*Me,ie+=u*xe,ge+=u*je,le+=u*De,be+=u*qe,J+=u*Ae,Y+=u*Fe,z+=u*Ie,l+=u*Te,D+=u*Be,he+=u*Pe,pe+=u*Ge,Oe+=u*We,He+=u*et,Ve+=u*tt,Le+=u*Je,u=j[14],ie+=u*Me,ge+=u*xe,le+=u*je,be+=u*De,J+=u*qe,Y+=u*Ae,z+=u*Fe,l+=u*Ie,D+=u*Te,he+=u*Be,pe+=u*Pe,Oe+=u*Ge,He+=u*We,Ve+=u*et,Le+=u*tt,pt+=u*Je,u=j[15],ge+=u*Me,le+=u*xe,be+=u*je,J+=u*De,Y+=u*qe,z+=u*Ae,l+=u*Fe,D+=u*Ie,he+=u*Te,pe+=u*Be,Oe+=u*Pe,He+=u*Ge,Ve+=u*We,Le+=u*et,pt+=u*tt,gt+=u*Je,X+=38*le,c+=38*be,f+=38*J,d+=38*Y,w+=38*z,_+=38*l,p+=38*D,T+=38*he,F+=38*pe,W+=38*Oe,x+=38*He,q+=38*Ve,te+=38*Le,re+=38*pt,ie+=38*gt,y=1,u=X+y+65535,y=Math.floor(u/65536),X=u-y*65536,u=c+y+65535,y=Math.floor(u/65536),c=u-y*65536,u=f+y+65535,y=Math.floor(u/65536),f=u-y*65536,u=d+y+65535,y=Math.floor(u/65536),d=u-y*65536,u=w+y+65535,y=Math.floor(u/65536),w=u-y*65536,u=_+y+65535,y=Math.floor(u/65536),_=u-y*65536,u=p+y+65535,y=Math.floor(u/65536),p=u-y*65536,u=T+y+65535,y=Math.floor(u/65536),T=u-y*65536,u=F+y+65535,y=Math.floor(u/65536),F=u-y*65536,u=W+y+65535,y=Math.floor(u/65536),W=u-y*65536,u=x+y+65535,y=Math.floor(u/65536),x=u-y*65536,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=te+y+65535,y=Math.floor(u/65536),te=u-y*65536,u=re+y+65535,y=Math.floor(u/65536),re=u-y*65536,u=ie+y+65535,y=Math.floor(u/65536),ie=u-y*65536,u=ge+y+65535,y=Math.floor(u/65536),ge=u-y*65536,X+=y-1+37*(y-1),y=1,u=X+y+65535,y=Math.floor(u/65536),X=u-y*65536,u=c+y+65535,y=Math.floor(u/65536),c=u-y*65536,u=f+y+65535,y=Math.floor(u/65536),f=u-y*65536,u=d+y+65535,y=Math.floor(u/65536),d=u-y*65536,u=w+y+65535,y=Math.floor(u/65536),w=u-y*65536,u=_+y+65535,y=Math.floor(u/65536),_=u-y*65536,u=p+y+65535,y=Math.floor(u/65536),p=u-y*65536,u=T+y+65535,y=Math.floor(u/65536),T=u-y*65536,u=F+y+65535,y=Math.floor(u/65536),F=u-y*65536,u=W+y+65535,y=Math.floor(u/65536),W=u-y*65536,u=x+y+65535,y=Math.floor(u/65536),x=u-y*65536,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=te+y+65535,y=Math.floor(u/65536),te=u-y*65536,u=re+y+65535,y=Math.floor(u/65536),re=u-y*65536,u=ie+y+65535,y=Math.floor(u/65536),ie=u-y*65536,u=ge+y+65535,y=Math.floor(u/65536),ge=u-y*65536,X+=y-1+37*(y-1),N[0]=X,N[1]=c,N[2]=f,N[3]=d,N[4]=w,N[5]=_,N[6]=p,N[7]=T,N[8]=F,N[9]=W,N[10]=x,N[11]=q,N[12]=te,N[13]=re,N[14]=ie,N[15]=ge}function M(N,j){k(N,j,j)}function H(N,j){const O=s();for(let u=0;u<16;u++)O[u]=j[u];for(let u=253;u>=0;u--)M(O,O),u!==2&&u!==4&&k(O,O,j);for(let u=0;u<16;u++)N[u]=O[u]}function Z(N,j){const O=new Uint8Array(32),u=new Float64Array(80),y=s(),X=s(),c=s(),f=s(),d=s(),w=s();for(let F=0;F<31;F++)O[F]=N[F];O[31]=N[31]&127|64,O[0]&=248,A(u,j);for(let F=0;F<16;F++)X[F]=u[F];y[0]=f[0]=1;for(let F=254;F>=0;--F){const W=O[F>>>3]>>>(F&7)&1;m(y,X,W),m(c,f,W),C(d,y,c),$(y,y,c),C(c,X,f),$(X,X,f),M(f,d),M(w,y),k(y,c,y),k(c,X,d),C(d,y,c),$(y,y,c),M(X,y),$(c,f,w),k(y,c,g),C(y,y,f),k(c,c,y),k(y,f,w),k(f,X,u),M(X,d),m(y,X,W),m(c,f,W)}for(let F=0;F<16;F++)u[F+16]=y[F],u[F+32]=c[F],u[F+48]=X[F],u[F+64]=f[F];const _=u.subarray(32),p=u.subarray(16);H(_,_),k(p,p,_);const T=new Uint8Array(32);return E(T,p),T}n.scalarMult=Z;function Q(N){return Z(N,o)}n.scalarMultBase=Q;function ue(N){if(N.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const j=new Uint8Array(N);return{publicKey:Q(j),secretKey:j}}n.generateKeyPairFromSeed=ue;function L(N){const j=(0,t.randomBytes)(32,N),O=ue(j);return(0,r.wipe)(j),O}n.generateKeyPair=L;function B(N,j,O=!1){if(N.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(j.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=Z(N,j);if(O){let y=0;for(let X=0;X<u.length;X++)y|=u[X];if(y===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=B})(uu);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Id=lt.getLocation=lt.getLocationOrThrow=hu=lt.getNavigator=lt.getNavigatorOrThrow=Sd=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function tn(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}lt.getFromWindow=tn;function jn(n){const t=tn(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}lt.getFromWindowOrThrow=jn;function jb(){return jn("document")}lt.getDocumentOrThrow=jb;function Db(){return tn("document")}var Sd=lt.getDocument=Db;function Fb(){return jn("navigator")}lt.getNavigatorOrThrow=Fb;function Ub(){return tn("navigator")}var hu=lt.getNavigator=Ub;function Lb(){return jn("location")}lt.getLocationOrThrow=Lb;function $b(){return tn("location")}var Id=lt.getLocation=$b;function Mb(){return jn("crypto")}lt.getCryptoOrThrow=Mb;function qb(){return tn("crypto")}lt.getCrypto=qb;function zb(){return jn("localStorage")}lt.getLocalStorageOrThrow=zb;function Hb(){return tn("localStorage")}lt.getLocalStorage=Hb;var lu={};Object.defineProperty(lu,"__esModule",{value:!0});var Od=lu.getWindowMetadata=void 0;const tf=lt;function Bb(){let n,t;try{n=tf.getDocumentOrThrow(),t=tf.getLocationOrThrow()}catch{return null}function r(){const $=n.getElementsByTagName("link"),k=[];for(let M=0;M<$.length;M++){const H=$[M],Z=H.getAttribute("rel");if(Z&&Z.toLowerCase().indexOf("icon")>-1){const Q=H.getAttribute("href");if(Q)if(Q.toLowerCase().indexOf("https:")===-1&&Q.toLowerCase().indexOf("http:")===-1&&Q.indexOf("//")!==0){let ue=t.protocol+"//"+t.host;if(Q.indexOf("/")===0)ue+=Q;else{const L=t.pathname.split("/");L.pop();const B=L.join("/");ue+=B+"/"+Q}k.push(ue)}else if(Q.indexOf("//")===0){const ue=t.protocol+Q;k.push(ue)}else k.push(Q)}}return k}function s(...$){const k=n.getElementsByTagName("meta");for(let M=0;M<k.length;M++){const H=k[M],Z=["itemprop","property","name"].map(Q=>H.getAttribute(Q)).filter(Q=>Q?$.includes(Q):!1);if(Z.length&&Z){const Q=H.getAttribute("content");if(Q)return Q}}return""}function o(){let $=s("name","og:site_name","og:title","twitter:title");return $||($=n.title),$}function g(){return s("description","og:description","twitter:description","keywords")}const b=o(),m=g(),E=t.origin,A=r();return{description:m,url:E,icons:A,name:b}}Od=lu.getWindowMetadata=Bb;var ps={},Kb=n=>encodeURIComponent(n).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),xd="%[a-f0-9]{2}",rf=new RegExp("("+xd+")|([^%]+?)","gi"),nf=new RegExp("("+xd+")+","gi");function Vc(n,t){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;t=t||1;var r=n.slice(0,t),s=n.slice(t);return Array.prototype.concat.call([],Vc(r),Vc(s))}function Vb(n){try{return decodeURIComponent(n)}catch{for(var t=n.match(rf)||[],r=1;r<t.length;r++)n=Vc(t,r).join(""),t=n.match(rf)||[];return n}}function Gb(n){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=nf.exec(n);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var s=Vb(r[0]);s!==r[0]&&(t[r[0]]=s)}r=nf.exec(n)}t["%C2"]="\uFFFD";for(var o=Object.keys(t),g=0;g<o.length;g++){var b=o[g];n=n.replace(new RegExp(b,"g"),t[b])}return n}var kb=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Gb(n)}},Wb=(n,t)=>{if(!(typeof n=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[n];const r=n.indexOf(t);return r===-1?[n]:[n.slice(0,r),n.slice(r+t.length)]},Yb=function(n,t){for(var r={},s=Object.keys(n),o=Array.isArray(t),g=0;g<s.length;g++){var b=s[g],m=n[b];(o?t.indexOf(b)!==-1:t(b,m,n))&&(r[b]=m)}return r};(function(n){const t=Kb,r=kb,s=Wb,o=Yb,g=L=>L==null,b=Symbol("encodeFragmentIdentifier");function m(L){switch(L.arrayFormat){case"index":return B=>(N,j)=>{const O=N.length;return j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(B,L),"[",O,"]"].join("")]:[...N,[C(B,L),"[",C(O,L),"]=",C(j,L)].join("")]};case"bracket":return B=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(B,L),"[]"].join("")]:[...N,[C(B,L),"[]=",C(j,L)].join("")];case"colon-list-separator":return B=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,[C(B,L),":list="].join("")]:[...N,[C(B,L),":list=",C(j,L)].join("")];case"comma":case"separator":case"bracket-separator":{const B=L.arrayFormat==="bracket-separator"?"[]=":"=";return N=>(j,O)=>O===void 0||L.skipNull&&O===null||L.skipEmptyString&&O===""?j:(O=O===null?"":O,j.length===0?[[C(N,L),B,C(O,L)].join("")]:[[j,C(O,L)].join(L.arrayFormatSeparator)])}default:return B=>(N,j)=>j===void 0||L.skipNull&&j===null||L.skipEmptyString&&j===""?N:j===null?[...N,C(B,L)]:[...N,[C(B,L),"=",C(j,L)].join("")]}}function E(L){let B;switch(L.arrayFormat){case"index":return(N,j,O)=>{if(B=/\[(\d*)\]$/.exec(N),N=N.replace(/\[\d*\]$/,""),!B){O[N]=j;return}O[N]===void 0&&(O[N]={}),O[N][B[1]]=j};case"bracket":return(N,j,O)=>{if(B=/(\[\])$/.exec(N),N=N.replace(/\[\]$/,""),!B){O[N]=j;return}if(O[N]===void 0){O[N]=[j];return}O[N]=[].concat(O[N],j)};case"colon-list-separator":return(N,j,O)=>{if(B=/(:list)$/.exec(N),N=N.replace(/:list$/,""),!B){O[N]=j;return}if(O[N]===void 0){O[N]=[j];return}O[N]=[].concat(O[N],j)};case"comma":case"separator":return(N,j,O)=>{const u=typeof j=="string"&&j.includes(L.arrayFormatSeparator),y=typeof j=="string"&&!u&&$(j,L).includes(L.arrayFormatSeparator);j=y?$(j,L):j;const X=u||y?j.split(L.arrayFormatSeparator).map(c=>$(c,L)):j===null?j:$(j,L);O[N]=X};case"bracket-separator":return(N,j,O)=>{const u=/(\[\])$/.test(N);if(N=N.replace(/\[\]$/,""),!u){O[N]=j&&$(j,L);return}const y=j===null?[]:j.split(L.arrayFormatSeparator).map(X=>$(X,L));if(O[N]===void 0){O[N]=y;return}O[N]=[].concat(O[N],y)};default:return(N,j,O)=>{if(O[N]===void 0){O[N]=j;return}O[N]=[].concat(O[N],j)}}}function A(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(L,B){return B.encode?B.strict?t(L):encodeURIComponent(L):L}function $(L,B){return B.decode?r(L):L}function k(L){return Array.isArray(L)?L.sort():typeof L=="object"?k(Object.keys(L)).sort((B,N)=>Number(B)-Number(N)).map(B=>L[B]):L}function M(L){const B=L.indexOf("#");return B!==-1&&(L=L.slice(0,B)),L}function H(L){let B="";const N=L.indexOf("#");return N!==-1&&(B=L.slice(N)),B}function Z(L){L=M(L);const B=L.indexOf("?");return B===-1?"":L.slice(B+1)}function Q(L,B){return B.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):B.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function ue(L,B){B=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},B),A(B.arrayFormatSeparator);const N=E(B),j=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return j;for(const O of L.split("&")){if(O==="")continue;let[u,y]=s(B.decode?O.replace(/\+/g," "):O,"=");y=y===void 0?null:["comma","separator","bracket-separator"].includes(B.arrayFormat)?y:$(y,B),N($(u,B),y,j)}for(const O of Object.keys(j)){const u=j[O];if(typeof u=="object"&&u!==null)for(const y of Object.keys(u))u[y]=Q(u[y],B);else j[O]=Q(u,B)}return B.sort===!1?j:(B.sort===!0?Object.keys(j).sort():Object.keys(j).sort(B.sort)).reduce((O,u)=>{const y=j[u];return Boolean(y)&&typeof y=="object"&&!Array.isArray(y)?O[u]=k(y):O[u]=y,O},Object.create(null))}n.extract=Z,n.parse=ue,n.stringify=(L,B)=>{if(!L)return"";B=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},B),A(B.arrayFormatSeparator);const N=y=>B.skipNull&&g(L[y])||B.skipEmptyString&&L[y]==="",j=m(B),O={};for(const y of Object.keys(L))N(y)||(O[y]=L[y]);const u=Object.keys(O);return B.sort!==!1&&u.sort(B.sort),u.map(y=>{const X=L[y];return X===void 0?"":X===null?C(y,B):Array.isArray(X)?X.length===0&&B.arrayFormat==="bracket-separator"?C(y,B)+"[]":X.reduce(j(y),[]).join("&"):C(y,B)+"="+C(X,B)}).filter(y=>y.length>0).join("&")},n.parseUrl=(L,B)=>{B=Object.assign({decode:!0},B);const[N,j]=s(L,"#");return Object.assign({url:N.split("?")[0]||"",query:ue(Z(L),B)},B&&B.parseFragmentIdentifier&&j?{fragmentIdentifier:$(j,B)}:{})},n.stringifyUrl=(L,B)=>{B=Object.assign({encode:!0,strict:!0,[b]:!0},B);const N=M(L.url).split("?")[0]||"",j=n.extract(L.url),O=n.parse(j,{sort:!1}),u=Object.assign(O,L.query);let y=n.stringify(u,B);y&&(y=`?${y}`);let X=H(L.url);return L.fragmentIdentifier&&(X=`#${B[b]?C(L.fragmentIdentifier,B):L.fragmentIdentifier}`),`${N}${y}${X}`},n.pick=(L,B,N)=>{N=Object.assign({parseFragmentIdentifier:!0,[b]:!1},N);const{url:j,query:O,fragmentIdentifier:u}=n.parseUrl(L,N);return n.stringifyUrl({url:j,query:o(O,B),fragmentIdentifier:u},N)},n.exclude=(L,B,N)=>{const j=Array.isArray(B)?O=>!B.includes(O):(O,u)=>!B(O,u);return n.pick(L,j,N)}})(ps);const Jb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Xb(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}function Pd(n,t){return n.includes(":")?[n]:t.chains||[]}const Ad="base10",cr="base16",Gc="base64pad",fu="utf8",Td=0,rn=1,Zb=0,sf=1,kc=12,du=32;function Qb(){const n=uu.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function Wc(){const n=Nn.randomBytes(du);return ur(n,cr)}function ew(n,t){const r=uu.sharedKey(vr(n,cr),vr(t,cr)),s=new Nb(Ha.SHA256,r).expand(du);return ur(s,cr)}function tw(n){const t=Ha.hash(vr(n,cr));return ur(t,cr)}function Tn(n){const t=Ha.hash(vr(n,fu));return ur(t,cr)}function rw(n){return vr(`${n}`,Ad)}function ms(n){return Number(ur(n,Ad))}function iw(n){const t=rw(typeof n.type<"u"?n.type:Td);if(ms(t)===rn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?vr(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?vr(n.iv,cr):Nn.randomBytes(kc),o=new ou.ChaCha20Poly1305(vr(n.symKey,cr)).seal(s,vr(n.message,fu));return sw({type:t,sealed:o,iv:s,senderPublicKey:r})}function nw(n){const t=new ou.ChaCha20Poly1305(vr(n.symKey,cr)),{sealed:r,iv:s}=Da(n.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return ur(o,fu)}function sw(n){if(ms(n.type)===rn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Mc([n.type,n.senderPublicKey,n.iv,n.sealed]),Gc)}return ur(Mc([n.type,n.iv,n.sealed]),Gc)}function Da(n){const t=vr(n,Gc),r=t.slice(Zb,sf),s=sf;if(ms(r)===rn){const m=s+du,E=m+kc,A=t.slice(s,m),C=t.slice(m,E),$=t.slice(E);return{type:r,sealed:$,iv:C,senderPublicKey:A}}const o=s+kc,g=t.slice(s,o),b=t.slice(o);return{type:r,sealed:b,iv:g}}function aw(n,t){const r=Da(n);return Cd({type:ms(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Cd(n){const t=(n==null?void 0:n.type)||Td;if(t===rn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function af(n){return n.type===rn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var ow=Object.defineProperty,of=Object.getOwnPropertySymbols,cw=Object.prototype.hasOwnProperty,uw=Object.prototype.propertyIsEnumerable,cf=(n,t,r)=>t in n?ow(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,uf=(n,t)=>{for(var r in t||(t={}))cw.call(t,r)&&cf(n,r,t[r]);if(of)for(var r of of(t))uw.call(t,r)&&cf(n,r,t[r]);return n};const hw="ReactNative",Zi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},lw="js";function pu(){return typeof An.exports<"u"&&typeof An.exports.versions<"u"&&typeof An.exports.versions.node<"u"}function Rd(){return!Sd()&&!!hu()&&navigator.product===hw}function gu(){return!pu()&&!!hu()}function Nd(){return Rd()?Zi.reactNative:pu()?Zi.node:gu()?Zi.browser:Zi.unknown}function fw(n,t){let r=ps.parse(n);return r=uf(uf({},r),t),n=ps.stringify(r),n}function dw(){return Od()||{name:"",description:"",url:"",icons:[""]}}function pw(){if(typeof(Gr==null?void 0:Gr.Platform)<"u"){const{OS:r,Version:s}=Gr.Platform;return[r,s].join("-")}const n=k1();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function gw(){var n;const t=Nd();return t===Zi.browser?[t,((n=Id())==null?void 0:n.host)||"unknown"].join(":"):t}function _w(n,t,r){const s=pw(),o=gw();return[[n,t].join("-"),[lw,r].join("-"),s,o].join("/")}function yw({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:g,useOnCloseEvent:b}){const m=r.split("?"),E=_w(n,t,s),A={auth:o,ua:E,projectId:g,useOnCloseEvent:b||void 0},C=fw(m[1]||"",A);return m[0]+"?"+C}function Qi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function jd(n){return Object.fromEntries(n.entries())}function Dd(n){return new Map(Object.entries(n))}function Pn(n=me.FIVE_MINUTES,t){const r=me.toMiliseconds(n||me.FIVE_MINUTES);let s,o,g;return{resolve:b=>{g&&s&&(clearTimeout(g),s(b))},reject:b=>{g&&o&&(clearTimeout(g),o(b))},done:()=>new Promise((b,m)=>{g=setTimeout(()=>{m(new Error(t))},r),s=b,o=m})}}function Fa(n,t,r){return new Promise(async(s,o)=>{const g=setTimeout(()=>o(new Error(r)),t);try{const b=await n;s(b)}catch(b){o(b)}clearTimeout(g)})}function Fd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function vw(n){return Fd("topic",n)}function mw(n){return Fd("id",n)}function Ud(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Kr(n,t){return me.fromMiliseconds((t||Date.now())+me.toMiliseconds(n))}function Ti(n){return Date.now()>=me.toMiliseconds(n)}function Bt(n,t){return`${n}${t?`:${t}`:""}`}function Ac(n=[],t=[]){return[...new Set([...n,...t])]}async function bw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const g=`${o}/wc?requestId=${n}&sessionTopic=${t}`,b=Nd();b===Zi.browser?g.startsWith("https://")?window.open(g,"_blank","noreferrer noopener"):window.open(g,"_self","noreferrer noopener"):b===Zi.reactNative&&typeof(Gr==null?void 0:Gr.Linking)<"u"&&await Gr.Linking.openURL(g)}catch(s){console.error(s)}}const ww="irn";function Yc(n){return(n==null?void 0:n.relay)||{protocol:ww}}function Aa(n){const t=Jb[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Ew=Object.defineProperty,hf=Object.getOwnPropertySymbols,Sw=Object.prototype.hasOwnProperty,Iw=Object.prototype.propertyIsEnumerable,lf=(n,t,r)=>t in n?Ew(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ow=(n,t)=>{for(var r in t||(t={}))Sw.call(t,r)&&lf(n,r,t[r]);if(hf)for(var r of hf(t))Iw.call(t,r)&&lf(n,r,t[r]);return n};function xw(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const g=o.replace(s,""),b=n[o];r[g]=b}}),r}function Pw(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),o=n.substring(t+1,r).split("@"),g=typeof r<"u"?n.substring(r):"",b=ps.parse(g);return{protocol:s,topic:Aw(o[0]),version:parseInt(o[1],10),symKey:b.symKey,relay:xw(b)}}function Aw(n){return n.startsWith("//")?n.substring(2):n}function Tw(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const g=r+t+o;n[o]&&(s[g]=n[o])}),s}function Cw(n){return`${n.protocol}:${n.topic}@${n.version}?`+ps.stringify(Ow({symKey:n.symKey},Tw(n.relay)))}function Dn(n){const t=[];return n.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function Rw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Dn(r.accounts))}),t}function Nw(n,t){const r=[];return Object.values(n).forEach(s=>{Dn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function jw(n,t){const r=[];return Object.values(n).forEach(s=>{Dn(s.accounts).includes(t)&&r.push(...s.events)}),r}function Dw(n,t){const r=Ca(n,t);if(r)throw new Error(r.message);const s={};for(const[o,g]of Object.entries(n))s[o]={methods:g.methods,events:g.events,chains:g.accounts.map(b=>`${b.split(":")[0]}:${b.split(":")[1]}`)};return s}function Ld(n){return n.includes(":")}function Ta(n){return Ld(n)?n.split(":")[0]:n}const Fw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Uw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function de(n,t){const{message:r,code:s}=Uw[n];return{message:t?`${r} ${t}`:r,code:s}}function Dt(n,t){const{message:r,code:s}=Fw[n];return{message:t?`${r} ${t}`:r,code:s}}function ri(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Cn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Wt(n,t){return t&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function _u(n,t){return t&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function Lw(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),o=Object.keys(r);let g=!0;return Qi(o,s)?(s.forEach(b=>{const{accounts:m,methods:E,events:A}=n.namespaces[b],C=Dn(m),$=r[b];(!Qi(Pd(b,$),C)||!Qi($.methods,E)||!Qi($.events,A))&&(g=!1)}),g):!1}function Ua(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function $w(n){if(Wt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Ua(r)}}return!1}function Mw(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function qw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function zw(n){return n==null?void 0:n.topic}function Hw(n,t){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=de("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function ff(n){let t=!0;return ri(n)?n.length&&(t=n.every(r=>Wt(r,!1))):t=!1,t}function Bw(n,t,r){let s=null;return ri(t)&&t.length?t.forEach(o=>{s||Ua(o)||(s=Dt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Ua(n)||(s=Dt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Kw(n,t,r){let s=null;return Object.entries(n).forEach(([o,g])=>{if(s)return;const b=Bw(o,Pd(o,g),`${t} ${r}`);b&&(s=b)}),s}function Vw(n,t){let r=null;return ri(n)?n.forEach(s=>{r||$w(s)||(r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Gw(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=Vw(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function kw(n,t){let r=null;return ff(n==null?void 0:n.methods)?ff(n==null?void 0:n.events)||(r=Dt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Dt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function $d(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=kw(s,`${t}, namespace`);o&&(r=o)}),r}function Ww(n,t,r){let s=null;if(n&&Cn(n)){const o=$d(n,t);o&&(s=o);const g=Kw(n,t,r);g&&(s=g)}else s=de("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ca(n,t){let r=null;if(n&&Cn(n)){const s=$d(n,t);s&&(r=s);const o=Gw(n,t);o&&(r=o)}else r=de("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Md(n){return Wt(n.protocol,!0)}function Yw(n,t){let r=!1;return t&&!n?r=!0:n&&ri(n)&&n.length&&n.forEach(s=>{r=Md(s)}),r}function Jw(n){return typeof n=="number"}function yr(n){return typeof n<"u"&&typeof n!==null}function Xw(n){return!(!n||typeof n!="object"||!n.code||!_u(n.code,!1)||!n.message||!Wt(n.message,!1))}function Zw(n){return!(or(n)||!Wt(n.method,!1))}function Qw(n){return!(or(n)||or(n.result)&&or(n.error)||!_u(n.id,!1)||!Wt(n.jsonrpc,!1))}function eE(n){return!(or(n)||!Wt(n.name,!1))}function df(n,t){return!(!Ua(t)||!Rw(n).includes(t))}function tE(n,t,r){return Wt(r,!1)?Nw(n,t).includes(r):!1}function rE(n,t,r){return Wt(r,!1)?jw(n,t).includes(r):!1}function pf(n,t,r){let s=null;const o=iE(n),g=nE(t),b=Object.keys(o),m=Object.keys(g),E=gf(Object.keys(n)),A=gf(Object.keys(t)),C=E.filter($=>!A.includes($));return C.length&&(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${C.toString()}
      Received: ${Object.keys(t).toString()}`)),Qi(b,m)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${b.toString()}
      Approved: ${m.toString()}`)),Object.keys(t).forEach($=>{if(!$.includes(":")||s)return;const k=Dn(t[$].accounts);k.includes($)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${$}
        Required: ${$}
        Approved: ${k.toString()}`))}),b.forEach($=>{s||(Qi(o[$].methods,g[$].methods)?Qi(o[$].events,g[$].events)||(s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${$}`)):s=de("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${$}`))}),s}function iE(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{t[o]={methods:n[r].methods,events:n[r].events}})}),t}function gf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function nE(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Dn(n[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:n[r].accounts.filter(g=>g.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function sE(n,t){return _u(n,!1)&&n<=t.max&&n>=t.min}const aE="PARSE_ERROR",oE="INVALID_REQUEST",cE="METHOD_NOT_FOUND",uE="INVALID_PARAMS",qd="INTERNAL_ERROR",yu="SERVER_ERROR",hE=[-32700,-32600,-32601,-32602,-32603],fs={[aE]:{code:-32700,message:"Parse error"},[oE]:{code:-32600,message:"Invalid Request"},[cE]:{code:-32601,message:"Method not found"},[uE]:{code:-32602,message:"Invalid params"},[qd]:{code:-32603,message:"Internal error"},[yu]:{code:-32e3,message:"Server error"}},zd=yu;function lE(n){return hE.includes(n)}function _f(n){return Object.keys(fs).includes(n)?fs[n]:fs[zd]}function fE(n){const t=Object.values(fs).find(r=>r.code===n);return t||fs[zd]}function Hd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Bd={},Kd={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(n){var t,r,s,o,g,b,m,E,A,C,$,k,M,H,Z,Q,ue,L,B,N,j,O,u;(function(y){var X=typeof wt=="object"?wt:typeof self=="object"?self:typeof this=="object"?this:{};y(c(X,c(n.exports)));function c(f,d){return f!==X&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(w,_){return f[w]=d?d(w,_):_}}})(function(y){var X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var d in f)f.hasOwnProperty(d)&&(c[d]=f[d])};t=function(c,f){X(c,f);function d(){this.constructor=c}c.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},r=Object.assign||function(c){for(var f,d=1,w=arguments.length;d<w;d++){f=arguments[d];for(var _ in f)Object.prototype.hasOwnProperty.call(f,_)&&(c[_]=f[_])}return c},s=function(c,f){var d={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&f.indexOf(w)<0&&(d[w]=c[w]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,w=Object.getOwnPropertySymbols(c);_<w.length;_++)f.indexOf(w[_])<0&&Object.prototype.propertyIsEnumerable.call(c,w[_])&&(d[w[_]]=c[w[_]]);return d},o=function(c,f,d,w){var _=arguments.length,p=_<3?f:w===null?w=Object.getOwnPropertyDescriptor(f,d):w,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,f,d,w);else for(var F=c.length-1;F>=0;F--)(T=c[F])&&(p=(_<3?T(p):_>3?T(f,d,p):T(f,d))||p);return _>3&&p&&Object.defineProperty(f,d,p),p},g=function(c,f){return function(d,w){f(d,w,c)}},b=function(c,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,f)},m=function(c,f,d,w){function _(p){return p instanceof d?p:new d(function(T){T(p)})}return new(d||(d=Promise))(function(p,T){function F(q){try{x(w.next(q))}catch(te){T(te)}}function W(q){try{x(w.throw(q))}catch(te){T(te)}}function x(q){q.done?p(q.value):_(q.value).then(F,W)}x((w=w.apply(c,f||[])).next())})},E=function(c,f){var d={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},w,_,p,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(x){return function(q){return W([x,q])}}function W(x){if(w)throw new TypeError("Generator is already executing.");for(;d;)try{if(w=1,_&&(p=x[0]&2?_.return:x[0]?_.throw||((p=_.return)&&p.call(_),0):_.next)&&!(p=p.call(_,x[1])).done)return p;switch(_=0,p&&(x=[x[0]&2,p.value]),x[0]){case 0:case 1:p=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,_=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(p=d.trys,!(p=p.length>0&&p[p.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){d.label=x[1];break}if(x[0]===6&&d.label<p[1]){d.label=p[1],p=x;break}if(p&&d.label<p[2]){d.label=p[2],d.ops.push(x);break}p[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(q){x=[6,q],_=0}finally{w=p=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}},u=function(c,f,d,w){w===void 0&&(w=d),c[w]=f[d]},A=function(c,f){for(var d in c)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=c[d])},C=function(c){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&c[f],w=0;if(d)return d.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&w>=c.length&&(c=void 0),{value:c&&c[w++],done:!c}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(c,f){var d=typeof Symbol=="function"&&c[Symbol.iterator];if(!d)return c;var w=d.call(c),_,p=[],T;try{for(;(f===void 0||f-- >0)&&!(_=w.next()).done;)p.push(_.value)}catch(F){T={error:F}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(T)throw T.error}}return p},k=function(){for(var c=[],f=0;f<arguments.length;f++)c=c.concat($(arguments[f]));return c},M=function(){for(var c=0,f=0,d=arguments.length;f<d;f++)c+=arguments[f].length;for(var w=Array(c),_=0,f=0;f<d;f++)for(var p=arguments[f],T=0,F=p.length;T<F;T++,_++)w[_]=p[T];return w},H=function(c){return this instanceof H?(this.v=c,this):new H(c)},Z=function(c,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=d.apply(c,f||[]),_,p=[];return _={},T("next"),T("throw"),T("return"),_[Symbol.asyncIterator]=function(){return this},_;function T(re){w[re]&&(_[re]=function(ie){return new Promise(function(ge,le){p.push([re,ie,ge,le])>1||F(re,ie)})})}function F(re,ie){try{W(w[re](ie))}catch(ge){te(p[0][3],ge)}}function W(re){re.value instanceof H?Promise.resolve(re.value.v).then(x,q):te(p[0][2],re)}function x(re){F("next",re)}function q(re){F("throw",re)}function te(re,ie){re(ie),p.shift(),p.length&&F(p[0][0],p[0][1])}},Q=function(c){var f,d;return f={},w("next"),w("throw",function(_){throw _}),w("return"),f[Symbol.iterator]=function(){return this},f;function w(_,p){f[_]=c[_]?function(T){return(d=!d)?{value:H(c[_](T)),done:_==="return"}:p?p(T):T}:p}},ue=function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=c[Symbol.asyncIterator],d;return f?f.call(c):(c=typeof C=="function"?C(c):c[Symbol.iterator](),d={},w("next"),w("throw"),w("return"),d[Symbol.asyncIterator]=function(){return this},d);function w(p){d[p]=c[p]&&function(T){return new Promise(function(F,W){T=c[p](T),_(F,W,T.done,T.value)})}}function _(p,T,F,W){Promise.resolve(W).then(function(x){p({value:x,done:F})},T)}},L=function(c,f){return Object.defineProperty?Object.defineProperty(c,"raw",{value:f}):c.raw=f,c},B=function(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var d in c)Object.hasOwnProperty.call(c,d)&&(f[d]=c[d]);return f.default=c,f},N=function(c){return c&&c.__esModule?c:{default:c}},j=function(c,f){if(!f.has(c))throw new TypeError("attempted to get private field on non-instance");return f.get(c)},O=function(c,f,d){if(!f.has(c))throw new TypeError("attempted to set private field on non-instance");return f.set(c,d),d},y("__extends",t),y("__assign",r),y("__rest",s),y("__decorate",o),y("__param",g),y("__metadata",b),y("__awaiter",m),y("__generator",E),y("__exportStar",A),y("__createBinding",u),y("__values",C),y("__read",$),y("__spread",k),y("__spreadArrays",M),y("__await",H),y("__asyncGenerator",Z),y("__asyncDelegator",Q),y("__asyncValues",ue),y("__makeTemplateObject",L),y("__importStar",B),y("__importDefault",N),y("__classPrivateFieldGet",j),y("__classPrivateFieldSet",O)})})(Kd);var gi={},yf;function dE(){if(yf)return gi;yf=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowserCryptoAvailable=gi.getSubtleCrypto=gi.getBrowerCrypto=void 0;function n(){return(wt===null||wt===void 0?void 0:wt.crypto)||(wt===null||wt===void 0?void 0:wt.msCrypto)||{}}gi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}gi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return gi.isBrowserCryptoAvailable=r,gi}var _i={},vf;function pE(){if(vf)return _i;vf=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=n;function t(){return typeof An.exports<"u"&&typeof An.exports.versions<"u"&&typeof An.exports.versions.node<"u"}_i.isNode=t;function r(){return!n()&&!t()}return _i.isBrowser=r,_i}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Kd.exports;t.__exportStar(dE(),n),t.__exportStar(pE(),n)})(Bd);function Vd(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function vu(n=6){return BigInt(Vd(n))}function Ba(n,t,r){return{id:r||Vd(),jsonrpc:"2.0",method:n,params:t}}function mu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Ka(n,t,r){return{id:n,jsonrpc:"2.0",error:gE(t,r)}}function gE(n,t){return typeof n>"u"?_f(qd):(typeof n=="string"&&(n=Object.assign(Object.assign({},_f(yu)),{message:n})),typeof t<"u"&&(n.data=t),lE(n.code)&&(n=fE(n.code)),n)}class _E{}class yE extends _E{constructor(){super()}}class vE extends yE{constructor(t){super()}}const mE="^https?:",bE="^wss?:";function wE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Gd(n,t){const r=wE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function mf(n){return Gd(n,mE)}function bf(n){return Gd(n,bE)}function EE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function kd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function bu(n){return kd(n)&&"method"in n}function Va(n){return kd(n)&&(yi(n)||Vr(n))}function yi(n){return"result"in n}function Vr(n){return"error"in n}class Ni extends vE{constructor(t){super(t),this.events=new hr.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ba(t.method,t.params||[],t.id||vu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(g){o(g)}this.events.on(`${t.id}`,g=>{Vr(g)?o(g.error):s(g.result)});try{await this.connection.send(t,r)}catch(g){o(g)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Va(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const SE=()=>typeof Gr<"u"&&typeof Gr.WebSocket<"u"?Gr.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),IE=()=>typeof window<"u",wf=n=>n.split("?")[0],Ef=10,OE=SE();class xE{constructor(t){if(this.url=t,this.events=new hr.exports.EventEmitter,this.registering=!1,!bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ds(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=Bd.isReactNative()?void 0:{rejectUnauthorized:!EE(t)},g=new OE(t,[],o);IE()?g.onerror=b=>{const m=b;s(this.emitError(m.error))}:g.on("error",b=>{s(this.emitError(b))}),g.onopen=()=>{this.onOpen(g),r(g)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?su(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ka(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Hd(t,wf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ef&&this.events.setMaxListeners(Ef)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${wf(this.url)}`));return this.events.emit("register_error",r),r}}var Jc={exports:{}};(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,g=2,b=9007199254740991,m="[object Arguments]",E="[object Array]",A="[object AsyncFunction]",C="[object Boolean]",$="[object Date]",k="[object Error]",M="[object Function]",H="[object GeneratorFunction]",Z="[object Map]",Q="[object Number]",ue="[object Null]",L="[object Object]",B="[object Promise]",N="[object Proxy]",j="[object RegExp]",O="[object Set]",u="[object String]",y="[object Symbol]",X="[object Undefined]",c="[object WeakMap]",f="[object ArrayBuffer]",d="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",p="[object Int8Array]",T="[object Int16Array]",F="[object Int32Array]",W="[object Uint8Array]",x="[object Uint8ClampedArray]",q="[object Uint16Array]",te="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,ge=/^(?:0|[1-9]\d*)$/,le={};le[w]=le[_]=le[p]=le[T]=le[F]=le[W]=le[x]=le[q]=le[te]=!0,le[m]=le[E]=le[f]=le[C]=le[d]=le[$]=le[k]=le[M]=le[Z]=le[Q]=le[L]=le[j]=le[O]=le[u]=le[c]=!1;var be=typeof wt=="object"&&wt&&wt.Object===Object&&wt,J=typeof self=="object"&&self&&self.Object===Object&&self,Y=be||J||Function("return this")(),z=t&&!t.nodeType&&t,l=z&&!0&&n&&!n.nodeType&&n,D=l&&l.exports===z,he=D&&be.process,pe=function(){try{return he&&he.binding&&he.binding("util")}catch{}}(),Oe=pe&&pe.isTypedArray;function He(P,K){for(var oe=-1,_e=P==null?0:P.length,ot=0,Re=[];++oe<_e;){var ft=P[oe];K(ft,oe,P)&&(Re[ot++]=ft)}return Re}function Ve(P,K){for(var oe=-1,_e=K.length,ot=P.length;++oe<_e;)P[ot+oe]=K[oe];return P}function Le(P,K){for(var oe=-1,_e=P==null?0:P.length;++oe<_e;)if(K(P[oe],oe,P))return!0;return!1}function pt(P,K){for(var oe=-1,_e=Array(P);++oe<P;)_e[oe]=K(oe);return _e}function gt(P){return function(K){return P(K)}}function Me(P,K){return P.has(K)}function xe(P,K){return P==null?void 0:P[K]}function je(P){var K=-1,oe=Array(P.size);return P.forEach(function(_e,ot){oe[++K]=[ot,_e]}),oe}function De(P,K){return function(oe){return P(K(oe))}}function qe(P){var K=-1,oe=Array(P.size);return P.forEach(function(_e){oe[++K]=_e}),oe}var Ae=Array.prototype,Fe=Function.prototype,Ie=Object.prototype,Te=Y["__core-js_shared__"],Be=Fe.toString,Pe=Ie.hasOwnProperty,Ge=function(){var P=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),We=Ie.toString,et=RegExp("^"+Be.call(Pe).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=D?Y.Buffer:void 0,Je=Y.Symbol,er=Y.Uint8Array,lr=Ie.propertyIsEnumerable,kr=Ae.splice,tr=Je?Je.toStringTag:void 0,ii=Object.getOwnPropertySymbols,vi=tt?tt.isBuffer:void 0,Di=De(Object.keys,Object),Et=mr(Y,"DataView"),_t=mr(Y,"Map"),St=mr(Y,"Promise"),It=mr(Y,"Set"),mt=mr(Y,"WeakMap"),yt=mr(Object,"create"),Ut=si(Et),Lt=si(_t),Ot=si(St),$t=si(It),xt=si(mt),Ct=Je?Je.prototype:void 0,Pt=Ct?Ct.valueOf:void 0;function ht(P){var K=-1,oe=P==null?0:P.length;for(this.clear();++K<oe;){var _e=P[K];this.set(_e[0],_e[1])}}function Mt(){this.__data__=yt?yt(null):{},this.size=0}function qt(P){var K=this.has(P)&&delete this.__data__[P];return this.size-=K?1:0,K}function Wa(P){var K=this.__data__;if(yt){var oe=K[P];return oe===s?void 0:oe}return Pe.call(K,P)?K[P]:void 0}function Ya(P){var K=this.__data__;return yt?K[P]!==void 0:Pe.call(K,P)}function Ja(P,K){var oe=this.__data__;return this.size+=this.has(P)?0:1,oe[P]=yt&&K===void 0?s:K,this}ht.prototype.clear=Mt,ht.prototype.delete=qt,ht.prototype.get=Wa,ht.prototype.has=Ya,ht.prototype.set=Ja;function xr(P){var K=-1,oe=P==null?0:P.length;for(this.clear();++K<oe;){var _e=P[K];this.set(_e[0],_e[1])}}function Xa(){this.__data__=[],this.size=0}function Za(P){var K=this.__data__,oe=Fi(K,P);if(oe<0)return!1;var _e=K.length-1;return oe==_e?K.pop():kr.call(K,oe,1),--this.size,!0}function Qa(P){var K=this.__data__,oe=Fi(K,P);return oe<0?void 0:K[oe][1]}function eo(P){return Fi(this.__data__,P)>-1}function to(P,K){var oe=this.__data__,_e=Fi(oe,P);return _e<0?(++this.size,oe.push([P,K])):oe[_e][1]=K,this}xr.prototype.clear=Xa,xr.prototype.delete=Za,xr.prototype.get=Qa,xr.prototype.has=eo,xr.prototype.set=to;function ni(P){var K=-1,oe=P==null?0:P.length;for(this.clear();++K<oe;){var _e=P[K];this.set(_e[0],_e[1])}}function sn(){this.size=0,this.__data__={hash:new ht,map:new(_t||xr),string:new ht}}function ro(P){var K=mi(this,P).delete(P);return this.size-=K?1:0,K}function an(P){return mi(this,P).get(P)}function io(P){return mi(this,P).has(P)}function no(P,K){var oe=mi(this,P),_e=oe.size;return oe.set(P,K),this.size+=oe.size==_e?0:1,this}ni.prototype.clear=sn,ni.prototype.delete=ro,ni.prototype.get=an,ni.prototype.has=io,ni.prototype.set=no;function on(P){var K=-1,oe=P==null?0:P.length;for(this.__data__=new ni;++K<oe;)this.add(P[K])}function ws(P){return this.__data__.set(P,s),this}function Es(P){return this.__data__.has(P)}on.prototype.add=on.prototype.push=ws,on.prototype.has=Es;function $r(P){var K=this.__data__=new xr(P);this.size=K.size}function so(){this.__data__=new xr,this.size=0}function ao(P){var K=this.__data__,oe=K.delete(P);return this.size=K.size,oe}function oo(P){return this.__data__.get(P)}function co(P){return this.__data__.has(P)}function Ss(P,K){var oe=this.__data__;if(oe instanceof xr){var _e=oe.__data__;if(!_t||_e.length<r-1)return _e.push([P,K]),this.size=++oe.size,this;oe=this.__data__=new ni(_e)}return oe.set(P,K),this.size=oe.size,this}$r.prototype.clear=so,$r.prototype.delete=ao,$r.prototype.get=oo,$r.prototype.has=co,$r.prototype.set=Ss;function Is(P,K){var oe=hn(P),_e=!oe&&Us(P),ot=!oe&&!_e&&Ln(P),Re=!oe&&!_e&&!ot&&Ms(P),ft=oe||_e||ot||Re,zt=ft?pt(P.length,String):[],Xe=zt.length;for(var ct in P)(K||Pe.call(P,ct))&&!(ft&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Re&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Rs(ct,Xe)))&&zt.push(ct);return zt}function Fi(P,K){for(var oe=P.length;oe--;)if(Fs(P[oe][0],K))return oe;return-1}function Fn(P,K,oe){var _e=K(P);return hn(P)?_e:Ve(_e,oe(P))}function Ui(P){return P==null?P===void 0?X:ue:tr&&tr in Object(P)?Ts(P):lo(P)}function Un(P){return $i(P)&&Ui(P)==m}function Li(P,K,oe,_e,ot){return P===K?!0:P==null||K==null||!$i(P)&&!$i(K)?P!==P&&K!==K:Os(P,K,oe,_e,Li,ot)}function Os(P,K,oe,_e,ot,Re){var ft=hn(P),zt=hn(K),Xe=ft?E:Wr(P),ct=zt?E:Wr(K);Xe=Xe==m?L:Xe,ct=ct==m?L:ct;var Rt=Xe==L,fr=ct==L,Ht=Xe==ct;if(Ht&&Ln(P)){if(!Ln(K))return!1;ft=!0,Rt=!1}if(Ht&&!Rt)return Re||(Re=new $r),ft||Ms(P)?cn(P,K,oe,_e,ot,Re):ho(P,K,Xe,oe,_e,ot,Re);if(!(oe&o)){var dt=Rt&&Pe.call(P,"__wrapped__"),rr=fr&&Pe.call(K,"__wrapped__");if(dt||rr){var Mr=dt?P.value():P,Pr=rr?K.value():K;return Re||(Re=new $r),ot(Mr,Pr,oe,_e,Re)}}return Ht?(Re||(Re=new $r),As(P,K,oe,_e,ot,Re)):!1}function uo(P){if(!$s(P)||js(P))return!1;var K=ln(P)?et:ie;return K.test(si(P))}function xs(P){return $i(P)&&Ls(P.length)&&!!le[Ui(P)]}function Ps(P){if(!Ds(P))return Di(P);var K=[];for(var oe in Object(P))Pe.call(P,oe)&&oe!="constructor"&&K.push(oe);return K}function cn(P,K,oe,_e,ot,Re){var ft=oe&o,zt=P.length,Xe=K.length;if(zt!=Xe&&!(ft&&Xe>zt))return!1;var ct=Re.get(P);if(ct&&Re.get(K))return ct==K;var Rt=-1,fr=!0,Ht=oe&g?new on:void 0;for(Re.set(P,K),Re.set(K,P);++Rt<zt;){var dt=P[Rt],rr=K[Rt];if(_e)var Mr=ft?_e(rr,dt,Rt,K,P,Re):_e(dt,rr,Rt,P,K,Re);if(Mr!==void 0){if(Mr)continue;fr=!1;break}if(Ht){if(!Le(K,function(Pr,Yr){if(!Me(Ht,Yr)&&(dt===Pr||ot(dt,Pr,oe,_e,Re)))return Ht.push(Yr)})){fr=!1;break}}else if(!(dt===rr||ot(dt,rr,oe,_e,Re))){fr=!1;break}}return Re.delete(P),Re.delete(K),fr}function ho(P,K,oe,_e,ot,Re,ft){switch(oe){case d:if(P.byteLength!=K.byteLength||P.byteOffset!=K.byteOffset)return!1;P=P.buffer,K=K.buffer;case f:return!(P.byteLength!=K.byteLength||!Re(new er(P),new er(K)));case C:case $:case Q:return Fs(+P,+K);case k:return P.name==K.name&&P.message==K.message;case j:case u:return P==K+"";case Z:var zt=je;case O:var Xe=_e&o;if(zt||(zt=qe),P.size!=K.size&&!Xe)return!1;var ct=ft.get(P);if(ct)return ct==K;_e|=g,ft.set(P,K);var Rt=cn(zt(P),zt(K),_e,ot,Re,ft);return ft.delete(P),Rt;case y:if(Pt)return Pt.call(P)==Pt.call(K)}return!1}function As(P,K,oe,_e,ot,Re){var ft=oe&o,zt=un(P),Xe=zt.length,ct=un(K),Rt=ct.length;if(Xe!=Rt&&!ft)return!1;for(var fr=Xe;fr--;){var Ht=zt[fr];if(!(ft?Ht in K:Pe.call(K,Ht)))return!1}var dt=Re.get(P);if(dt&&Re.get(K))return dt==K;var rr=!0;Re.set(P,K),Re.set(K,P);for(var Mr=ft;++fr<Xe;){Ht=zt[fr];var Pr=P[Ht],Yr=K[Ht];if(_e)var $n=ft?_e(Yr,Pr,Ht,K,P,Re):_e(Pr,Yr,Ht,P,K,Re);if(!($n===void 0?Pr===Yr||ot(Pr,Yr,oe,_e,Re):$n)){rr=!1;break}Mr||(Mr=Ht=="constructor")}if(rr&&!Mr){var Mi=P.constructor,Gt=K.constructor;Mi!=Gt&&"constructor"in P&&"constructor"in K&&!(typeof Mi=="function"&&Mi instanceof Mi&&typeof Gt=="function"&&Gt instanceof Gt)&&(rr=!1)}return Re.delete(P),Re.delete(K),rr}function un(P){return Fn(P,go,Cs)}function mi(P,K){var oe=P.__data__;return Ns(K)?oe[typeof K=="string"?"string":"hash"]:oe.map}function mr(P,K){var oe=xe(P,K);return uo(oe)?oe:void 0}function Ts(P){var K=Pe.call(P,tr),oe=P[tr];try{P[tr]=void 0;var _e=!0}catch{}var ot=We.call(P);return _e&&(K?P[tr]=oe:delete P[tr]),ot}var Cs=ii?function(P){return P==null?[]:(P=Object(P),He(ii(P),function(K){return lr.call(P,K)}))}:at,Wr=Ui;(Et&&Wr(new Et(new ArrayBuffer(1)))!=d||_t&&Wr(new _t)!=Z||St&&Wr(St.resolve())!=B||It&&Wr(new It)!=O||mt&&Wr(new mt)!=c)&&(Wr=function(P){var K=Ui(P),oe=K==L?P.constructor:void 0,_e=oe?si(oe):"";if(_e)switch(_e){case Ut:return d;case Lt:return Z;case Ot:return B;case $t:return O;case xt:return c}return K});function Rs(P,K){return K=K==null?b:K,!!K&&(typeof P=="number"||ge.test(P))&&P>-1&&P%1==0&&P<K}function Ns(P){var K=typeof P;return K=="string"||K=="number"||K=="symbol"||K=="boolean"?P!=="__proto__":P===null}function js(P){return!!Ge&&Ge in P}function Ds(P){var K=P&&P.constructor,oe=typeof K=="function"&&K.prototype||Ie;return P===oe}function lo(P){return We.call(P)}function si(P){if(P!=null){try{return Be.call(P)}catch{}try{return P+""}catch{}}return""}function Fs(P,K){return P===K||P!==P&&K!==K}var Us=Un(function(){return arguments}())?Un:function(P){return $i(P)&&Pe.call(P,"callee")&&!lr.call(P,"callee")},hn=Array.isArray;function fo(P){return P!=null&&Ls(P.length)&&!ln(P)}var Ln=vi||st;function po(P,K){return Li(P,K)}function ln(P){if(!$s(P))return!1;var K=Ui(P);return K==M||K==H||K==A||K==N}function Ls(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=b}function $s(P){var K=typeof P;return P!=null&&(K=="object"||K=="function")}function $i(P){return P!=null&&typeof P=="object"}var Ms=Oe?gt(Oe):xs;function go(P){return fo(P)?Is(P):Ps(P)}function at(){return[]}function st(){return!1}n.exports=po})(Jc,Jc.exports);const PE=Jc.exports;function AE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var g=n.charAt(o),b=g.charCodeAt(0);if(r[b]!==255)throw new TypeError(g+" is ambiguous");r[b]=o}var m=n.length,E=n.charAt(0),A=Math.log(m)/Math.log(256),C=Math.log(256)/Math.log(m);function $(H){if(H instanceof Uint8Array||(ArrayBuffer.isView(H)?H=new Uint8Array(H.buffer,H.byteOffset,H.byteLength):Array.isArray(H)&&(H=Uint8Array.from(H))),!(H instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(H.length===0)return"";for(var Z=0,Q=0,ue=0,L=H.length;ue!==L&&H[ue]===0;)ue++,Z++;for(var B=(L-ue)*C+1>>>0,N=new Uint8Array(B);ue!==L;){for(var j=H[ue],O=0,u=B-1;(j!==0||O<Q)&&u!==-1;u--,O++)j+=256*N[u]>>>0,N[u]=j%m>>>0,j=j/m>>>0;if(j!==0)throw new Error("Non-zero carry");Q=O,ue++}for(var y=B-Q;y!==B&&N[y]===0;)y++;for(var X=E.repeat(Z);y<B;++y)X+=n.charAt(N[y]);return X}function k(H){if(typeof H!="string")throw new TypeError("Expected String");if(H.length===0)return new Uint8Array;var Z=0;if(H[Z]!==" "){for(var Q=0,ue=0;H[Z]===E;)Q++,Z++;for(var L=(H.length-Z)*A+1>>>0,B=new Uint8Array(L);H[Z];){var N=r[H.charCodeAt(Z)];if(N===255)return;for(var j=0,O=L-1;(N!==0||j<ue)&&O!==-1;O--,j++)N+=m*B[O]>>>0,B[O]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");ue=j,Z++}if(H[Z]!==" "){for(var u=L-ue;u!==L&&B[u]===0;)u++;for(var y=new Uint8Array(Q+(L-u)),X=Q;u!==L;)y[X++]=B[u++];return y}}}function M(H){var Z=k(H);if(Z)return Z;throw new Error(`Non-${t} character`)}return{encode:$,decodeUnsafe:k,decode:M}}var TE=AE,CE=TE;const Wd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},RE=n=>new TextEncoder().encode(n),NE=n=>new TextDecoder().decode(n);class jE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class DE{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Yd(this,t)}}class FE{constructor(t){this.decoders=t}or(t){return Yd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Yd=(n,t)=>new FE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class UE{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new jE(t,r,s),this.decoder=new DE(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ga=({name:n,prefix:t,encode:r,decode:s})=>new UE(n,t,r,s),bs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=CE(r,t);return Ga({prefix:n,name:t,encode:s,decode:g=>Wd(o(g))})},LE=(n,t,r,s)=>{const o={};for(let C=0;C<t.length;++C)o[t[C]]=C;let g=n.length;for(;n[g-1]==="=";)--g;const b=new Uint8Array(g*r/8|0);let m=0,E=0,A=0;for(let C=0;C<g;++C){const $=o[n[C]];if($===void 0)throw new SyntaxError(`Non-${s} character`);E=E<<r|$,m+=r,m>=8&&(m-=8,b[A++]=255&E>>m)}if(m>=r||255&E<<8-m)throw new SyntaxError("Unexpected end of data");return b},$E=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let g="",b=0,m=0;for(let E=0;E<n.length;++E)for(m=m<<8|n[E],b+=8;b>r;)b-=r,g+=t[o&m>>b];if(b&&(g+=t[o&m<<r-b]),s)for(;g.length*r&7;)g+="=";return g},Jt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ga({prefix:t,name:n,encode(o){return $E(o,s,r)},decode(o){return LE(o,s,r,n)}}),ME=Ga({prefix:"\0",name:"identity",encode:n=>NE(n),decode:n=>RE(n)});var qE=Object.freeze({__proto__:null,identity:ME});const zE=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var HE=Object.freeze({__proto__:null,base2:zE});const BE=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var KE=Object.freeze({__proto__:null,base8:BE});const VE=bs({prefix:"9",name:"base10",alphabet:"0123456789"});var GE=Object.freeze({__proto__:null,base10:VE});const kE=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),WE=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var YE=Object.freeze({__proto__:null,base16:kE,base16upper:WE});const JE=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),XE=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ZE=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),QE=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),e6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),t6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),r6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),i6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),n6=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var s6=Object.freeze({__proto__:null,base32:JE,base32upper:XE,base32pad:ZE,base32padupper:QE,base32hex:e6,base32hexupper:t6,base32hexpad:r6,base32hexpadupper:i6,base32z:n6});const a6=bs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),o6=bs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var c6=Object.freeze({__proto__:null,base36:a6,base36upper:o6});const u6=bs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),h6=bs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var l6=Object.freeze({__proto__:null,base58btc:u6,base58flickr:h6});const f6=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d6=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),p6=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),g6=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var _6=Object.freeze({__proto__:null,base64:f6,base64pad:d6,base64url:p6,base64urlpad:g6});const Jd=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),y6=Jd.reduce((n,t,r)=>(n[r]=t,n),[]),v6=Jd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function m6(n){return n.reduce((t,r)=>(t+=y6[r],t),"")}function b6(n){const t=[];for(const r of n){const s=v6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const w6=Ga({prefix:"\u{1F680}",name:"base256emoji",encode:m6,decode:b6});var E6=Object.freeze({__proto__:null,base256emoji:w6}),S6=Xd,Sf=128,I6=127,O6=~I6,x6=Math.pow(2,31);function Xd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=x6;)t[r++]=n&255|Sf,n/=128;for(;n&O6;)t[r++]=n&255|Sf,n>>>=7;return t[r]=n|0,Xd.bytes=r-s+1,t}var P6=Xc,A6=128,If=127;function Xc(n,s){var r=0,s=s||0,o=0,g=s,b,m=n.length;do{if(g>=m)throw Xc.bytes=0,new RangeError("Could not decode varint");b=n[g++],r+=o<28?(b&If)<<o:(b&If)*Math.pow(2,o),o+=7}while(b>=A6);return Xc.bytes=g-s,r}var T6=Math.pow(2,7),C6=Math.pow(2,14),R6=Math.pow(2,21),N6=Math.pow(2,28),j6=Math.pow(2,35),D6=Math.pow(2,42),F6=Math.pow(2,49),U6=Math.pow(2,56),L6=Math.pow(2,63),$6=function(n){return n<T6?1:n<C6?2:n<R6?3:n<N6?4:n<j6?5:n<D6?6:n<F6?7:n<U6?8:n<L6?9:10},M6={encode:S6,decode:P6,encodingLength:$6},Zd=M6;const Of=(n,t,r=0)=>(Zd.encode(n,t,r),t),xf=n=>Zd.encodingLength(n),Zc=(n,t)=>{const r=t.byteLength,s=xf(n),o=s+xf(r),g=new Uint8Array(o+r);return Of(n,g,0),Of(r,g,s),g.set(t,o),new q6(n,r,t,g)};class q6{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const Qd=({name:n,code:t,encode:r})=>new z6(n,t,r);class z6{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Zc(this.code,r):r.then(s=>Zc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const ep=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),H6=Qd({name:"sha2-256",code:18,encode:ep("SHA-256")}),B6=Qd({name:"sha2-512",code:19,encode:ep("SHA-512")});var K6=Object.freeze({__proto__:null,sha256:H6,sha512:B6});const tp=0,V6="identity",rp=Wd,G6=n=>Zc(tp,rp(n)),k6={code:tp,name:V6,encode:rp,digest:G6};var W6=Object.freeze({__proto__:null,identity:k6});new TextEncoder,new TextDecoder;const Pf={...qE,...HE,...KE,...GE,...YE,...s6,...c6,...l6,..._6,...E6};({...K6,...W6});function ip(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Y6(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ip(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function np(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Af=np("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Tc=np("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Y6(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),J6={utf8:Af,"utf-8":Af,hex:Pf.base16,latin1:Tc,ascii:Tc,binary:Tc,...Pf};function X6(n,t="utf8"){const r=J6[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ip(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const sp="wc",Z6=2,wu="core",Ci=`${sp}@2:${wu}:`,Q6={name:wu,logger:"error"},eS={database:":memory:"},tS="crypto",Tf="client_ed25519_seed",rS=me.ONE_DAY,iS="keychain",nS="0.3",sS="messages",aS="0.3",oS=me.SIX_HOURS,cS="publisher",ap="irn",uS="error",op="wss://relay.walletconnect.com",Cf="wss://relay.walletconnect.org",hS="relayer",Tt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},lS="_subscription",os={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},fS=me.ONE_SECOND/2,dS="2.8.6",pS=1e4,gS="0.3",_S="WALLETCONNECT_CLIENT_ID",ti={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},yS="subscription",vS="0.3",mS=me.FIVE_SECONDS*1e3,bS="pairing",wS="0.3",cs={wc_pairingDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:me.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:me.ONE_DAY,prompt:!1,tag:0},res:{ttl:me.ONE_DAY,prompt:!1,tag:0}}},ei={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ES="history",SS="0.3",IS="expirer",Ur={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},OS="0.3",Cc="verify-api",Rf="https://verify.walletconnect.com";class xS{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=iS,this.version=nS,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:g}=de("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(g)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,jd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Dd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class PS{constructor(t,r,s){this.core=t,this.logger=r,this.name=tS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),g=Zl(o);return yd(g.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Qb();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const g=await this.getClientSeed(),b=Zl(g),m=Wc();return await mb(m,o,rS,b)},this.generateSharedKey=(o,g,b)=>{this.isInitialized();const m=this.getPrivateKey(o),E=ew(m,g);return this.setSymKey(E,b)},this.setSymKey=async(o,g)=>{this.isInitialized();const b=g||tw(o);return await this.keychain.set(b,o),b},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,g,b)=>{this.isInitialized();const m=Cd(b),E=ds(g);if(af(m)){const k=m.senderPublicKey,M=m.receiverPublicKey;o=await this.generateSharedKey(k,M)}const A=this.getSymKey(o),{type:C,senderPublicKey:$}=m;return iw({type:C,symKey:A,message:E,senderPublicKey:$})},this.decode=async(o,g,b)=>{this.isInitialized();const m=aw(g,b);if(af(m)){const C=m.receiverPublicKey,$=m.senderPublicKey;o=await this.generateSharedKey(C,$)}const E=this.getSymKey(o),A=nw({symKey:E,encoded:g});return su(A)},this.getPayloadType=o=>{const g=Da(o);return ms(g.type)},this.getPayloadSenderPublicKey=o=>{const g=Da(o);return g.senderPublicKey?ur(g.senderPublicKey,cr):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new xS(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Tf)}catch{t=Wc(),await this.keychain.set(Tf,t)}return X6(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AS extends Em{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=sS,this.version=aS,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const g=Tn(o);let b=this.messages.get(s);return typeof b>"u"&&(b={}),typeof b[g]<"u"||(b[g]=o,this.messages.set(s,b),await this.persist()),g},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const g=this.get(s),b=Tn(o);return typeof g[b]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,jd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Dd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class TS extends Sm{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new hr.exports.EventEmitter,this.name=cS,this.queue=new Map,this.publishTimeout=me.toMiliseconds(me.TEN_SECONDS),this.queueTimeout=me.toMiliseconds(me.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,g)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}});try{const b=(g==null?void 0:g.ttl)||oS,m=Yc(g),E=(g==null?void 0:g.prompt)||!1,A=(g==null?void 0:g.tag)||0,C=(g==null?void 0:g.id)||vu().toString(),$={topic:s,message:o,opts:{ttl:b,relay:m,prompt:E,tag:A,id:C}},k=setTimeout(()=>this.queue.set(C,$),this.queueTimeout);try{await await Fa(this.rpcPublish(s,o,b,m,E,A,C),this.publishTimeout),clearTimeout(k),this.relayer.events.emit(Tt.publish,$)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:g}})}catch(b){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(b),b}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,g,b,m){var E,A,C,$;const k={method:Aa(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:g,tag:b},id:m};return or((E=k.params)==null?void 0:E.prompt)&&((A=k.params)==null||delete A.prompt),or((C=k.params)==null?void 0:C.tag)&&(($=k.params)==null||delete $.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:k}),this.relayer.request(k)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Tt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Tt.message_ack,t=>{this.onPublish(t.id.toString())})}}class CS{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(g=>g!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var RS=Object.defineProperty,NS=Object.defineProperties,jS=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,DS=Object.prototype.hasOwnProperty,FS=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?RS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,us=(n,t)=>{for(var r in t||(t={}))DS.call(t,r)&&jf(n,r,t[r]);if(Nf)for(var r of Nf(t))FS.call(t,r)&&jf(n,r,t[r]);return n},Rc=(n,t)=>NS(n,jS(t));class US extends xm{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new CS,this.events=new hr.exports.EventEmitter,this.name=yS,this.version=vS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ci,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const g=Yc(o),b={topic:s,relay:g};this.pending.set(s,b);const m=await this.rpcSubscribe(s,g);return this.onSubscribe(m,b),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),m}catch(g){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(g),g}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,g)=>{const b=new me.Watch;b.start(this.pendingSubscriptionWatchLabel);const m=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(m),b.stop(this.pendingSubscriptionWatchLabel),o(!0)),b.elapsed(this.pendingSubscriptionWatchLabel)>=mS&&(clearInterval(m),b.stop(this.pendingSubscriptionWatchLabel),g(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=Yc(s);await this.rpcUnsubscribe(t,r,o);const g=Dt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,g),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:Aa(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Fa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}return Tn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Aa(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Fa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Tt.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:Aa(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Rc(us({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,us({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,us({},r)),this.topicMap.set(r.topic,t),this.events.emit(ti.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ti.deleted,Rc(us({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ti.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ti.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ri(r)&&this.onBatchSubscribe(r.map((s,o)=>Rc(us({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Tt.connect,async()=>{await this.onConnect()}),this.relayer.on(Tt.disconnect,()=>{this.onDisconnect()}),this.events.on(ti.created,async t=>{const r=ti.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ti.deleted,async t=>{const r=ti.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var LS=Object.defineProperty,Df=Object.getOwnPropertySymbols,$S=Object.prototype.hasOwnProperty,MS=Object.prototype.propertyIsEnumerable,Ff=(n,t,r)=>t in n?LS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,qS=(n,t)=>{for(var r in t||(t={}))$S.call(t,r)&&Ff(n,r,t[r]);if(Df)for(var r of Df(t))MS.call(t,r)&&Ff(n,r,t[r]);return n};class zS extends Im{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new hr.exports.EventEmitter,this.name=hS,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||uS})),this.messages=new AS(this.logger,t.core),this.subscriber=new US(this,this.logger),this.publisher=new TS(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||op,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Cf}...`),await this.restartTransport(Cf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},pS)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(g=>{this.subscriber.once(ti.created,b=>{b.topic===t&&g()})}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Tt.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ti.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Fa(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(Tt.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Tt.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(os.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ni(new xE(yw({sdkVersion:dS,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),bu(t)){if(!t.method.endsWith(lS))return;const r=t.params,{topic:s,message:o,publishedAt:g}=r.data,b={topic:s,message:o,publishedAt:g};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(qS({type:"event",event:r.id},b)),this.events.emit(r.id,b),await this.acknowledgePayload(t),await this.onMessageEvent(b)}else Va(t)&&this.events.emit(Tt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Tt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=mu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(os.payload,t=>this.onProviderPayload(t)),this.provider.on(os.connect,()=>{this.events.emit(Tt.connect)}),this.provider.on(os.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(os.error,t=>{this.logger.error(t),this.events.emit(Tt.error,t)})}registerEventListeners(){this.events.on(Tt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Tt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},me.toMiliseconds(fS))}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var HS=Object.defineProperty,Uf=Object.getOwnPropertySymbols,BS=Object.prototype.hasOwnProperty,KS=Object.prototype.propertyIsEnumerable,Lf=(n,t,r)=>t in n?HS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,$f=(n,t)=>{for(var r in t||(t={}))BS.call(t,r)&&Lf(n,r,t[r]);if(Uf)for(var r of Uf(t))KS.call(t,r)&&Lf(n,r,t[r]);return n};class ka extends Om{constructor(t,r,s,o=Ci,g=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=gS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(b=>{this.getKey&&b!==null&&!or(b)?this.map.set(this.getKey(b),b):qw(b)?this.map.set(b.id,b):zw(b)&&this.map.set(b.topic,b)}),this.cached=[],this.initialized=!0)},this.set=async(b,m)=>{this.isInitialized(),this.map.has(b)?await this.update(b,m):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:b,value:m}),this.map.set(b,m),await this.persist())},this.get=b=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:b}),this.getData(b)),this.getAll=b=>(this.isInitialized(),b?this.values.filter(m=>Object.keys(b).every(E=>PE(m[E],b[E]))):this.values),this.update=async(b,m)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:b,update:m});const E=$f($f({},this.getData(b)),m);this.map.set(b,E),await this.persist()},this.delete=async(b,m)=>{this.isInitialized(),this.map.has(b)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:b,reason:m}),this.map.delete(b),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=g}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class VS{constructor(t,r){this.core=t,this.logger=r,this.name=bS,this.version=wS,this.events=new hr.exports,this.initialized=!1,this.storagePrefix=Ci,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Wc(),o=await this.core.crypto.setSymKey(s),g=Kr(me.FIVE_MINUTES),b={protocol:ap},m={topic:o,expiry:g,relay:b,active:!1},E=Cw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:b});return await this.pairings.set(o,m),await this.core.relayer.subscribe(o),this.core.expirer.set(o,g),{topic:o,uri:E}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:g,relay:b}=Pw(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const m=Kr(me.FIVE_MINUTES),E={topic:o,relay:b,expiry:m,active:!1};return await this.pairings.set(o,E),await this.core.crypto.setSymKey(g,o),await this.core.relayer.subscribe(o,{relay:b}),this.core.expirer.set(o,m),s.activatePairing&&await this.activate({topic:o}),E},this.activate=async({topic:s})=>{this.isInitialized();const o=Kr(me.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const g=await this.sendRequest(o,"wc_pairingPing",{}),{done:b,resolve:m,reject:E}=Pn();this.events.once(Bt("pairing_ping",g),({error:A})=>{A?E(A):m()}),await b()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Dt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,g)=>{const b=Ba(o,g),m=await this.core.crypto.encode(s,b),E=cs[o].req;return this.core.history.set(s,b),this.core.relayer.publish(s,m,E),b.id},this.sendResult=async(s,o,g)=>{const b=mu(s,g),m=await this.core.crypto.encode(o,b),E=await this.core.history.get(o,s),A=cs[E.request.method].res;await this.core.relayer.publish(o,m,A),await this.core.history.resolve(b)},this.sendError=async(s,o,g)=>{const b=Ka(s,g),m=await this.core.crypto.encode(o,b),E=await this.core.history.get(o,s),A=cs[E.request.method]?cs[E.request.method].res:cs.unregistered_method.res;await this.core.relayer.publish(o,m,A),await this.core.history.resolve(b)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Dt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ti(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:g}=s,b=g.method;if(this.pairings.keys.includes(o))switch(b){case"wc_pairingPing":return this.onPairingPingRequest(o,g);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,g);default:return this.onUnknownRpcMethodRequest(o,g)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:g}=s,b=(await this.core.history.get(o,g.id)).request.method;if(this.pairings.keys.includes(o))switch(b){case"wc_pairingPing":return this.onPairingPingResponse(o,g);default:return this.onUnknownRpcMethodResponse(b)}},this.onPairingPingRequest=async(s,o)=>{const{id:g}=o;try{this.isValidPing({topic:s}),await this.sendResult(g,s,!0),this.events.emit("pairing_ping",{id:g,topic:s})}catch(b){await this.sendError(g,s,b),this.logger.error(b)}},this.onPairingPingResponse=(s,o)=>{const{id:g}=o;setTimeout(()=>{yi(o)?this.events.emit(Bt("pairing_ping",g),{}):Vr(o)&&this.events.emit(Bt("pairing_ping",g),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:g}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:g,topic:s})}catch(b){await this.sendError(g,s,b),this.logger.error(b)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:g,method:b}=o;try{if(this.registeredMethods.includes(b))return;const m=Dt("WC_METHOD_UNSUPPORTED",b);await this.sendError(g,s,m),this.logger.error(m)}catch(m){await this.sendError(g,s,m),this.logger.error(m)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Dt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!yr(s)){const{message:o}=de("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!Mw(s.uri)){const{message:o}=de("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!yr(s)){const{message:g}=de("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:g}=de("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(g)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ti(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=de("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new ka(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Tt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);bu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Va(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))})}registerExpirerEvents(){this.core.expirer.on(Ur.expired,async t=>{const{topic:r}=Ud(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class GS extends wm{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new hr.exports.EventEmitter,this.name=ES,this.version=SS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,g)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:g}),this.records.has(o.id))return;const b={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:g,expiry:Kr(me.THIRTY_DAYS)};this.records.set(b.id,b),this.events.emit(ei.created,b)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Vr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ei.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(g=>{if(g.topic===s){if(typeof o<"u"&&g.id!==o)return;this.records.delete(g.id),this.events.emit(ei.deleted,g)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Ba(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ei.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ei.created,t=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ei.updated,t=>{const r=ei.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ei.deleted,t=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{me.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kS extends Pm{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new hr.exports.EventEmitter,this.name=IS,this.version=OS,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const g=this.formatTarget(s),b={target:g,expiry:o};this.expirations.set(g,b),this.checkExpiry(g,b),this.events.emit(Ur.created,{target:g,expiration:b})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),g=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Ur.deleted,{target:o,expiration:g})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return vw(t);if(typeof t=="number")return mw(t);const{message:r}=de("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ur.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=de("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;me.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Ur.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ur.created,t=>{const r=Ur.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Ur.expired,t=>{const r=Ur.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Ur.deleted,t=>{const r=Ur.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}}class WS extends Am{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Cc,this.initialized=!1,this.init=async s=>{Rd()||!gu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Rf,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const g=this.startAbortTimer(me.FIVE_SECONDS),b=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(g),b.status===200?(o=await b.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Cc))return s();const g=document.createElement("iframe");g.setAttribute("id",Cc),g.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),g.style.display="none",g.addEventListener("load",()=>{this.initialized=!0,s()}),g.addEventListener("error",b=>{o(b)}),document.body.append(g),this.iframe=g}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),me.toMiliseconds(me.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=Rf,this.abortController=new AbortController,this.isDevEnv=pu()&&{ARTIS_SERVER_API:"http://localhost:8080"}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),me.toMiliseconds(t))}}var YS=Object.defineProperty,Mf=Object.getOwnPropertySymbols,JS=Object.prototype.hasOwnProperty,XS=Object.prototype.propertyIsEnumerable,qf=(n,t,r)=>t in n?YS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,zf=(n,t)=>{for(var r in t||(t={}))JS.call(t,r)&&qf(n,r,t[r]);if(Mf)for(var r of Mf(t))XS.call(t,r)&&qf(n,r,t[r]);return n};class Eu extends bm{constructor(t){super(t),this.protocol=sp,this.version=Z6,this.name=wu,this.events=new hr.exports.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||op;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Q6.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new Rn.HeartBeat,this.crypto=new PS(this,this.logger,t==null?void 0:t.keychain),this.history=new GS(this,this.logger),this.expirer=new kS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new im(zf(zf({},eS),t==null?void 0:t.storageOptions)),this.relayer=new zS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new VS(this,this.logger),this.verify=new WS(this.projectId||"",this.logger)}static async init(t){const r=new Eu(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(_S,s),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const ZS=Eu,cp="wc",up=2,hp="client",Su=`${cp}@${up}:${hp}:`,Nc={name:hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},QS="WALLETCONNECT_DEEPLINK_CHOICE",e2="proposal",lp="Proposal expired",t2="session",Oa=me.SEVEN_DAYS,r2="engine",hs={wc_sessionPropose:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1104},res:{ttl:me.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1106},res:{ttl:me.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1112},res:{ttl:me.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1115}}},jc={min:me.FIVE_MINUTES,max:me.SEVEN_DAYS},i2="request",n2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var s2=Object.defineProperty,a2=Object.defineProperties,o2=Object.getOwnPropertyDescriptors,Hf=Object.getOwnPropertySymbols,c2=Object.prototype.hasOwnProperty,u2=Object.prototype.propertyIsEnumerable,Bf=(n,t,r)=>t in n?s2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Fr=(n,t)=>{for(var r in t||(t={}))c2.call(t,r)&&Bf(n,r,t[r]);if(Hf)for(var r of Hf(t))u2.call(t,r)&&Bf(n,r,t[r]);return n},Dc=(n,t)=>a2(n,o2(t));class h2 extends Cm{constructor(t){super(t),this.name=r2,this.events=new hr.exports,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(hs)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Dc(Fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:g,optionalNamespaces:b,sessionProperties:m,relays:E}=s;let A=o,C,$=!1;if(A&&($=this.client.core.pairing.pairings.get(A).active),!A||!$){const{topic:B,uri:N}=await this.client.core.pairing.create();A=B,C=N}const k=await this.client.core.crypto.generateKeyPair(),M=Fr({requiredNamespaces:g,optionalNamespaces:b,relays:E!=null?E:[{protocol:ap}],proposer:{publicKey:k,metadata:this.client.metadata}},m&&{sessionProperties:m}),{reject:H,resolve:Z,done:Q}=Pn(me.FIVE_MINUTES,lp);if(this.events.once(Bt("session_connect"),async({error:B,session:N})=>{if(B)H(B);else if(N){N.self.publicKey=k;const j=Dc(Fr({},N),{requiredNamespaces:N.requiredNamespaces,optionalNamespaces:N.optionalNamespaces});await this.client.session.set(N.topic,j),await this.setExpiry(N.topic,N.expiry),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:N.peer.metadata}),Z(j)}}),!A){const{message:B}=de("NO_MATCHING_KEY",`connect() pairing topic: ${A}`);throw new Error(B)}const ue=await this.sendRequest(A,"wc_sessionPropose",M),L=Kr(me.FIVE_MINUTES);return await this.setProposal(ue,Fr({id:ue,expiry:L},M)),{uri:C,approval:Q}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:g,sessionProperties:b}=r,m=this.client.proposal.get(s);let{pairingTopic:E,proposer:A,requiredNamespaces:C,optionalNamespaces:$}=m;E=E||"",Cn(C)||(C=Dw(g,"approve()"));const k=await this.client.core.crypto.generateKeyPair(),M=A.publicKey,H=await this.client.core.crypto.generateSharedKey(k,M);E&&s&&(await this.client.core.pairing.updateMetadata({topic:E,metadata:A.metadata}),await this.sendResult(s,E,{relay:{protocol:o!=null?o:"irn"},responderPublicKey:k}),await this.client.proposal.delete(s,Dt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:E}));const Z=Fr({relay:{protocol:o!=null?o:"irn"},namespaces:g,requiredNamespaces:C,optionalNamespaces:$,pairingTopic:E,controller:{publicKey:k,metadata:this.client.metadata},expiry:Kr(Oa)},b&&{sessionProperties:b});await this.client.core.relayer.subscribe(H),await this.sendRequest(H,"wc_sessionSettle",Z);const Q=Dc(Fr({},Z),{topic:H,pairingTopic:E,acknowledged:!1,self:Z.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:k});return await this.client.session.set(H,Q),await this.setExpiry(H,Kr(Oa)),{topic:H,acknowledged:()=>new Promise(ue=>setTimeout(()=>ue(this.client.session.get(H)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:g}=this.client.proposal.get(s);g&&(await this.sendError(s,g,o),await this.client.proposal.delete(s,Dt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,g=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:b,resolve:m,reject:E}=Pn();return this.events.once(Bt("session_update",g),({error:A})=>{A?E(A):m()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:b}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:g,resolve:b,reject:m}=Pn();return this.events.once(Bt("session_extend",o),({error:E})=>{E?m(E):b()}),await this.setExpiry(s,Kr(Oa)),{acknowledged:g}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:g,expiry:b}=r,m=await this.sendRequest(g,"wc_sessionRequest",{request:o,chainId:s},b),{done:E,resolve:A,reject:C}=Pn(b);this.events.once(Bt("session_request",m),({error:k,result:M})=>{k?C(k):A(M)}),this.client.events.emit("session_request_sent",{topic:g,request:o,chainId:s,id:m});const $=await this.client.core.storage.getItem(QS);return bw({id:m,topic:g,wcDeepLink:$}),await E()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:g}=o;yi(o)?await this.sendResult(g,s,o.result):Vr(o)&&await this.sendError(g,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:g,resolve:b,reject:m}=Pn();this.events.once(Bt("session_ping",o),({error:E})=>{E?m(E):b()}),await g()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:g}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:g})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=vu().toString();let g;const b=m=>{(m==null?void 0:m.id.toString())===o&&(this.client.core.relayer.events.removeListener(Tt.message_ack,b),g())};await Promise.all([new Promise(m=>{g=m,this.client.core.relayer.on(Tt.message_ack,b)}),this.sendRequest(s,"wc_sessionDelete",Dt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Lw(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(g=>{var b,m;return((b=g.peerMetadata)==null?void 0:b.url)&&((m=g.peerMetadata)==null?void 0:m.url)===r.peer.metadata.url&&g.topic&&g.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(g=>this.client.core.pairing.disconnect({topic:g.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Dt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Dt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=hs.wc_sessionRequest.req.ttl,{id:o,topic:g,params:b}=r;await this.client.pendingRequest.set(o,{id:o,topic:g,params:b}),s&&this.client.core.expirer.set(o,Kr(s))},this.sendRequest=async(r,s,o,g,b)=>{const m=Ba(s,o);if(gu()&&n2.includes(s)){const C=Tn(JSON.stringify(m));await this.client.core.verify.register({attestationId:C})}const E=await this.client.core.crypto.encode(r,m),A=hs[s].req;return g&&(A.ttl=g),b&&(A.id=b),this.client.core.history.set(r,m),this.client.core.relayer.publish(r,E,A),m.id},this.sendResult=async(r,s,o)=>{const g=mu(r,o),b=await this.client.core.crypto.encode(s,g),m=await this.client.core.history.get(s,r),E=hs[m.request.method].res;this.client.core.relayer.publish(s,b,E),await this.client.core.history.resolve(g)},this.sendError=async(r,s,o)=>{const g=Ka(r,o),b=await this.client.core.crypto.encode(s,g),m=await this.client.core.history.get(s,r),E=hs[m.request.method].res;this.client.core.relayer.publish(s,b,E),await this.client.core.history.resolve(g)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{Ti(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ti(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,g=o.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${g}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,g=(await this.client.core.history.get(s,o.id)).request.method;switch(g){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${g}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=de("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidConnect(Fr({},s.params));const b=Kr(me.FIVE_MINUTES),m=Fr({id:g,pairingTopic:r,expiry:b},o);await this.setProposal(g,m);const E=Tn(JSON.stringify(s)),A=await this.getVerifyContext(E,m.proposer.metadata);this.client.events.emit("session_proposal",{id:g,params:m,verifyContext:A})}catch(b){await this.sendError(g,r,b),this.client.logger.error(b)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(yi(s)){const{result:g}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:g});const b=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:b});const m=b.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:m});const E=g.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:E});const A=await this.client.core.crypto.generateSharedKey(m,E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:A});const C=await this.client.core.relayer.subscribe(A);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:C}),await this.client.core.pairing.activate({topic:r})}else Vr(s)&&(await this.client.proposal.delete(o,Dt("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidSessionSettleRequest(g);const{relay:b,controller:m,expiry:E,namespaces:A,requiredNamespaces:C,optionalNamespaces:$,sessionProperties:k,pairingTopic:M}=s.params,H=Fr({topic:r,relay:b,expiry:E,namespaces:A,acknowledged:!0,pairingTopic:M,requiredNamespaces:C,optionalNamespaces:$,controller:m.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:m.publicKey,metadata:m.metadata}},k&&{sessionProperties:k});await this.sendResult(s.id,r,!0),this.events.emit(Bt("session_connect"),{session:H}),this.cleanupDuplicatePairings(H)}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;yi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",o),{})):Vr(s)&&(await this.client.session.delete(r,Dt("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:g}=s;try{this.isValidUpdate(Fr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(g,r,!0),this.client.events.emit("session_update",{id:g,topic:r,params:o})}catch(b){await this.sendError(g,r,b),this.client.logger.error(b)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;yi(s)?this.events.emit(Bt("session_update",o),{}):Vr(s)&&this.events.emit(Bt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Kr(Oa)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;yi(s)?this.events.emit(Bt("session_extend",o),{}):Vr(s)&&this.events.emit(Bt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(g){await this.sendError(o,r,g),this.client.logger.error(g)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{yi(s)?this.events.emit(Bt("session_ping",o),{}):Vr(s)&&this.events.emit(Bt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(g=>{this.client.core.relayer.once(Tt.publish,async()=>{g(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(g){this.client.logger.error(g)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidRequest(Fr({topic:r},g)),await this.setPendingSessionRequest({id:o,topic:r,params:g});const b=Tn(JSON.stringify(s)),m=this.client.session.get(r),E=await this.getVerifyContext(b,m.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:g,verifyContext:E})}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;yi(s)?this.events.emit(Bt("session_request",o),{result:s.result}):Vr(s)&&this.events.emit(Bt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:g}=s;try{this.isValidEmit(Fr({topic:r},g)),this.client.events.emit("session_event",{id:o,topic:r,params:g})}catch(b){await this.sendError(o,r,b),this.client.logger.error(b)}},this.isValidConnect=async r=>{if(!yr(r)){const{message:E}=de("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(E)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:g,sessionProperties:b,relays:m}=r;if(or(s)||await this.isValidPairingTopic(s),!Yw(m,!0)){const{message:E}=de("MISSING_OR_INVALID",`connect() relays: ${m}`);throw new Error(E)}!or(o)&&Cn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(g)&&Cn(g)!==0&&this.validateNamespaces(g,"optionalNamespaces"),or(b)||this.validateSessionProps(b,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=Ww(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!yr(r))throw new Error(de("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:g,sessionProperties:b}=r;await this.isValidProposalId(s);const m=this.client.proposal.get(s),E=Ca(o,"approve()");if(E)throw new Error(E.message);const A=pf(m.requiredNamespaces,o,"approve()");if(A)throw new Error(A.message);if(!Wt(g,!0)){const{message:C}=de("MISSING_OR_INVALID",`approve() relayProtocol: ${g}`);throw new Error(C)}or(b)||this.validateSessionProps(b,"sessionProperties")},this.isValidReject=async r=>{if(!yr(r)){const{message:g}=de("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(g)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!Xw(o)){const{message:g}=de("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidSessionSettleRequest=r=>{if(!yr(r)){const{message:A}=de("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(A)}const{relay:s,controller:o,namespaces:g,expiry:b}=r;if(!Md(s)){const{message:A}=de("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(A)}const m=Hw(o,"onSessionSettleRequest()");if(m)throw new Error(m.message);const E=Ca(g,"onSessionSettleRequest()");if(E)throw new Error(E.message);if(Ti(b)){const{message:A}=de("EXPIRED","onSessionSettleRequest()");throw new Error(A)}},this.isValidUpdate=async r=>{if(!yr(r)){const{message:E}=de("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(E)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const g=this.client.session.get(s),b=Ca(o,"update()");if(b)throw new Error(b.message);const m=pf(g.requiredNamespaces,o,"update()");if(m)throw new Error(m.message)},this.isValidExtend=async r=>{if(!yr(r)){const{message:o}=de("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!yr(r)){const{message:E}=de("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(E)}const{topic:s,request:o,chainId:g,expiry:b}=r;await this.isValidSessionTopic(s);const{namespaces:m}=this.client.session.get(s);if(!df(m,g)){const{message:E}=de("MISSING_OR_INVALID",`request() chainId: ${g}`);throw new Error(E)}if(!Zw(o)){const{message:E}=de("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(E)}if(!tE(m,g,o.method)){const{message:E}=de("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(E)}if(b&&!sE(b,jc)){const{message:E}=de("MISSING_OR_INVALID",`request() expiry: ${b}. Expiry must be a number (in seconds) between ${jc.min} and ${jc.max}`);throw new Error(E)}},this.isValidRespond=async r=>{if(!yr(r)){const{message:g}=de("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(g)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!Qw(o)){const{message:g}=de("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidPing=async r=>{if(!yr(r)){const{message:o}=de("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!yr(r)){const{message:m}=de("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(m)}const{topic:s,event:o,chainId:g}=r;await this.isValidSessionTopic(s);const{namespaces:b}=this.client.session.get(s);if(!df(b,g)){const{message:m}=de("MISSING_OR_INVALID",`emit() chainId: ${g}`);throw new Error(m)}if(!eE(o)){const{message:m}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}if(!rE(b,g,o.name)){const{message:m}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(m)}},this.isValidDisconnect=async r=>{if(!yr(r)){const{message:o}=de("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const g=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});g&&(o.verified.origin=g,o.verified.validation=g===s.url?"VALID":"INVALID")}catch(g){this.client.logger.error(g)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Wt(o,!1)){const{message:g}=de("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(g)}})}}isInitialized(){if(!this.initialized){const{message:t}=de("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Tt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);bu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Va(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Ur.expired,async t=>{const{topic:r,id:s}=Ud(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,de("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Wt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=de("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Wt(t,!1)){const{message:r}=de("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=de("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Wt(t,!1)){const{message:r}=de("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=de("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Jw(t)){const{message:r}=de("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=de("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=de("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class l2 extends ka{constructor(t,r){super(t,r,e2,Su),this.core=t,this.logger=r}}class f2 extends ka{constructor(t,r){super(t,r,t2,Su),this.core=t,this.logger=r}}class d2 extends ka{constructor(t,r){super(t,r,i2,Su,s=>s.id),this.core=t,this.logger=r}}class Iu extends Tm{constructor(t){super(t),this.protocol=cp,this.version=up,this.name=Nc.name,this.events=new hr.exports.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Nc.name,this.metadata=(t==null?void 0:t.metadata)||dw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Nc.logger}));this.core=(t==null?void 0:t.core)||new ZS(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new f2(this.core,this.logger),this.proposal=new l2(this.core,this.logger),this.pendingRequest=new d2(this.core,this.logger),this.engine=new h2(this)}static async init(t){const r=new Iu(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const p2={Accept:"application/json","Content-Type":"application/json"},g2="POST",Kf={headers:p2,method:g2},Vf=10;class nn{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new hr.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!mf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=ds(t),g=await(await xl(this.url,Object.assign(Object.assign({},Kf),{body:s}))).json();this.onPayload({data:g})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!mf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),o(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ds({id:1,jsonrpc:"2.0",method:"test",params:[]});await xl(t,Object.assign(Object.assign({},Kf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?su(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),g=Ka(t,o);this.events.emit("payload",g)}parseError(t,r=this.url){return Hd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Vf&&this.events.setMaxListeners(Vf)}}const Gf="error",_2="wss://relay.walletconnect.com",y2="wc",v2="universal_provider",kf=`${y2}@2:${v2}:`,m2="https://rpc.walletconnect.com/v1",ji={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Gr<"u"?Gr:typeof self<"u"?self:{},Qc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",o=200,g="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",b="Expected a function",m="Invalid `variable` option passed into `_.template`",E="__lodash_hash_undefined__",A=500,C="__lodash_placeholder__",$=1,k=2,M=4,H=1,Z=2,Q=1,ue=2,L=4,B=8,N=16,j=32,O=64,u=128,y=256,X=512,c=30,f="...",d=800,w=16,_=1,p=2,T=3,F=1/0,W=9007199254740991,x=17976931348623157e292,q=0/0,te=4294967295,re=te-1,ie=te>>>1,ge=[["ary",u],["bind",Q],["bindKey",ue],["curry",B],["curryRight",N],["flip",X],["partial",j],["partialRight",O],["rearg",y]],le="[object Arguments]",be="[object Array]",J="[object AsyncFunction]",Y="[object Boolean]",z="[object Date]",l="[object DOMException]",D="[object Error]",he="[object Function]",pe="[object GeneratorFunction]",Oe="[object Map]",He="[object Number]",Ve="[object Null]",Le="[object Object]",pt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",xe="[object Set]",je="[object String]",De="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Ie="[object ArrayBuffer]",Te="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",Ge="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",lr="[object Uint32Array]",kr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ii=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vi=/&(?:amp|lt|gt|quot|#39);/g,Di=/[&<>"']/g,Et=RegExp(vi.source),_t=RegExp(Di.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,$t=RegExp(Ot.source),xt=/^\s+/,Ct=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wa=/[()=,{}\[\]\/\s]/,Ya=/\\(\\)?/g,Ja=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Xa=/^[-+]0x[0-9a-f]+$/i,Za=/^0b[01]+$/i,Qa=/^\[object .+?Constructor\]$/,eo=/^0o[0-7]+$/i,to=/^(?:0|[1-9]\d*)$/,ni=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,sn=/($^)/,ro=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",io="\\u0300-\\u036f",no="\\ufe20-\\ufe2f",on="\\u20d0-\\u20ff",ws=io+no+on,Es="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",so="\\xac\\xb1\\xd7\\xf7",ao="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",oo="\\u2000-\\u206f",co=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ss="A-Z\\xc0-\\xd6\\xd8-\\xde",Is="\\ufe0e\\ufe0f",Fi=so+ao+oo+co,Fn="['\u2019]",Ui="["+an+"]",Un="["+Fi+"]",Li="["+ws+"]",Os="\\d+",uo="["+Es+"]",xs="["+$r+"]",Ps="[^"+an+Fi+Os+Es+$r+Ss+"]",cn="\\ud83c[\\udffb-\\udfff]",ho="(?:"+Li+"|"+cn+")",As="[^"+an+"]",un="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="["+Ss+"]",Ts="\\u200d",Cs="(?:"+xs+"|"+Ps+")",Wr="(?:"+mr+"|"+Ps+")",Rs="(?:"+Fn+"(?:d|ll|m|re|s|t|ve))?",Ns="(?:"+Fn+"(?:D|LL|M|RE|S|T|VE))?",js=ho+"?",Ds="["+Is+"]?",lo="(?:"+Ts+"(?:"+[As,un,mi].join("|")+")"+Ds+js+")*",si="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Us=Ds+js+lo,hn="(?:"+[uo,un,mi].join("|")+")"+Us,fo="(?:"+[As+Li+"?",Li,un,mi,Ui].join("|")+")",Ln=RegExp(Fn,"g"),po=RegExp(Li,"g"),ln=RegExp(cn+"(?="+cn+")|"+fo+Us,"g"),Ls=RegExp([mr+"?"+xs+"+"+Rs+"(?="+[Un,mr,"$"].join("|")+")",Wr+"+"+Ns+"(?="+[Un,mr+Cs,"$"].join("|")+")",mr+"?"+Cs+"+"+Rs,mr+"+"+Ns,Fs,si,Os,hn].join("|"),"g"),$s=RegExp("["+Ts+an+ws+Is+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ms=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],go=-1,at={};at[Be]=at[Pe]=at[Ge]=at[We]=at[et]=at[tt]=at[Je]=at[er]=at[lr]=!0,at[le]=at[be]=at[Ie]=at[Y]=at[Te]=at[z]=at[D]=at[he]=at[Oe]=at[He]=at[Le]=at[Me]=at[xe]=at[je]=at[Ae]=!1;var st={};st[le]=st[be]=st[Ie]=st[Te]=st[Y]=st[z]=st[Be]=st[Pe]=st[Ge]=st[We]=st[et]=st[Oe]=st[He]=st[Le]=st[Me]=st[xe]=st[je]=st[De]=st[tt]=st[Je]=st[er]=st[lr]=!0,st[D]=st[he]=st[Ae]=!1;var P={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},oe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},_e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Re=parseInt,ft=typeof ls=="object"&&ls&&ls.Object===Object&&ls,zt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||zt||Function("return this")(),ct=t&&!t.nodeType&&t,Rt=ct&&!0&&n&&!n.nodeType&&n,fr=Rt&&Rt.exports===ct,Ht=fr&&ft.process,dt=function(){try{var V=Rt&&Rt.require&&Rt.require("util").types;return V||Ht&&Ht.binding&&Ht.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,Mr=dt&&dt.isDate,Pr=dt&&dt.isMap,Yr=dt&&dt.isRegExp,$n=dt&&dt.isSet,Mi=dt&&dt.isTypedArray;function Gt(V,ne,ee){switch(ee.length){case 0:return V.call(ne);case 1:return V.call(ne,ee[0]);case 2:return V.call(ne,ee[0],ee[1]);case 3:return V.call(ne,ee[0],ee[1],ee[2])}return V.apply(ne,ee)}function dp(V,ne,ee,ye){for(var Ce=-1,rt=V==null?0:V.length;++Ce<rt;){var Kt=V[Ce];ne(ye,Kt,ee(Kt),V)}return ye}function Ar(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye&&ne(V[ee],ee,V)!==!1;);return V}function pp(V,ne){for(var ee=V==null?0:V.length;ee--&&ne(V[ee],ee,V)!==!1;);return V}function Pu(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye;)if(!ne(V[ee],ee,V))return!1;return!0}function bi(V,ne){for(var ee=-1,ye=V==null?0:V.length,Ce=0,rt=[];++ee<ye;){var Kt=V[ee];ne(Kt,ee,V)&&(rt[Ce++]=Kt)}return rt}function qs(V,ne){var ee=V==null?0:V.length;return!!ee&&fn(V,ne,0)>-1}function _o(V,ne,ee){for(var ye=-1,Ce=V==null?0:V.length;++ye<Ce;)if(ee(ne,V[ye]))return!0;return!1}function vt(V,ne){for(var ee=-1,ye=V==null?0:V.length,Ce=Array(ye);++ee<ye;)Ce[ee]=ne(V[ee],ee,V);return Ce}function wi(V,ne){for(var ee=-1,ye=ne.length,Ce=V.length;++ee<ye;)V[Ce+ee]=ne[ee];return V}function yo(V,ne,ee,ye){var Ce=-1,rt=V==null?0:V.length;for(ye&&rt&&(ee=V[++Ce]);++Ce<rt;)ee=ne(ee,V[Ce],Ce,V);return ee}function gp(V,ne,ee,ye){var Ce=V==null?0:V.length;for(ye&&Ce&&(ee=V[--Ce]);Ce--;)ee=ne(ee,V[Ce],Ce,V);return ee}function vo(V,ne){for(var ee=-1,ye=V==null?0:V.length;++ee<ye;)if(ne(V[ee],ee,V))return!0;return!1}var _p=mo("length");function yp(V){return V.split("")}function vp(V){return V.match(qt)||[]}function Au(V,ne,ee){var ye;return ee(V,function(Ce,rt,Kt){if(ne(Ce,rt,Kt))return ye=rt,!1}),ye}function zs(V,ne,ee,ye){for(var Ce=V.length,rt=ee+(ye?1:-1);ye?rt--:++rt<Ce;)if(ne(V[rt],rt,V))return rt;return-1}function fn(V,ne,ee){return ne===ne?Cp(V,ne,ee):zs(V,Tu,ee)}function mp(V,ne,ee,ye){for(var Ce=ee-1,rt=V.length;++Ce<rt;)if(ye(V[Ce],ne))return Ce;return-1}function Tu(V){return V!==V}function Cu(V,ne){var ee=V==null?0:V.length;return ee?wo(V,ne)/ee:q}function mo(V){return function(ne){return ne==null?r:ne[V]}}function bo(V){return function(ne){return V==null?r:V[ne]}}function Ru(V,ne,ee,ye,Ce){return Ce(V,function(rt,Kt,ut){ee=ye?(ye=!1,rt):ne(ee,rt,Kt,ut)}),ee}function bp(V,ne){var ee=V.length;for(V.sort(ne);ee--;)V[ee]=V[ee].value;return V}function wo(V,ne){for(var ee,ye=-1,Ce=V.length;++ye<Ce;){var rt=ne(V[ye]);rt!==r&&(ee=ee===r?rt:ee+rt)}return ee}function Eo(V,ne){for(var ee=-1,ye=Array(V);++ee<V;)ye[ee]=ne(ee);return ye}function wp(V,ne){return vt(ne,function(ee){return[ee,V[ee]]})}function Nu(V){return V&&V.slice(0,Uu(V)+1).replace(xt,"")}function br(V){return function(ne){return V(ne)}}function So(V,ne){return vt(ne,function(ee){return V[ee]})}function Mn(V,ne){return V.has(ne)}function ju(V,ne){for(var ee=-1,ye=V.length;++ee<ye&&fn(ne,V[ee],0)>-1;);return ee}function Du(V,ne){for(var ee=V.length;ee--&&fn(ne,V[ee],0)>-1;);return ee}function Ep(V,ne){for(var ee=V.length,ye=0;ee--;)V[ee]===ne&&++ye;return ye}var Sp=bo(P),Ip=bo(K);function Op(V){return"\\"+_e[V]}function xp(V,ne){return V==null?r:V[ne]}function dn(V){return $s.test(V)}function Pp(V){return $i.test(V)}function Ap(V){for(var ne,ee=[];!(ne=V.next()).done;)ee.push(ne.value);return ee}function Io(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye,Ce){ee[++ne]=[Ce,ye]}),ee}function Fu(V,ne){return function(ee){return V(ne(ee))}}function Ei(V,ne){for(var ee=-1,ye=V.length,Ce=0,rt=[];++ee<ye;){var Kt=V[ee];(Kt===ne||Kt===C)&&(V[ee]=C,rt[Ce++]=ee)}return rt}function Hs(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye){ee[++ne]=ye}),ee}function Tp(V){var ne=-1,ee=Array(V.size);return V.forEach(function(ye){ee[++ne]=[ye,ye]}),ee}function Cp(V,ne,ee){for(var ye=ee-1,Ce=V.length;++ye<Ce;)if(V[ye]===ne)return ye;return-1}function Rp(V,ne,ee){for(var ye=ee+1;ye--;)if(V[ye]===ne)return ye;return ye}function pn(V){return dn(V)?jp(V):_p(V)}function qr(V){return dn(V)?Dp(V):yp(V)}function Uu(V){for(var ne=V.length;ne--&&Ct.test(V.charAt(ne)););return ne}var Np=bo(oe);function jp(V){for(var ne=ln.lastIndex=0;ln.test(V);)++ne;return ne}function Dp(V){return V.match(ln)||[]}function Fp(V){return V.match(Ls)||[]}var Up=function V(ne){ne=ne==null?Xe:gn.defaults(Xe.Object(),ne,gn.pick(Xe,Ms));var ee=ne.Array,ye=ne.Date,Ce=ne.Error,rt=ne.Function,Kt=ne.Math,ut=ne.Object,Oo=ne.RegExp,Lp=ne.String,Tr=ne.TypeError,Bs=ee.prototype,$p=rt.prototype,_n=ut.prototype,Ks=ne["__core-js_shared__"],Vs=$p.toString,nt=_n.hasOwnProperty,Mp=0,Lu=function(){var e=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Gs=_n.toString,qp=Vs.call(ut),zp=Xe._,Hp=Oo("^"+Vs.call(nt).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ks=fr?ne.Buffer:r,Si=ne.Symbol,Ws=ne.Uint8Array,$u=ks?ks.allocUnsafe:r,Ys=Fu(ut.getPrototypeOf,ut),Mu=ut.create,qu=_n.propertyIsEnumerable,Js=Bs.splice,zu=Si?Si.isConcatSpreadable:r,qn=Si?Si.iterator:r,qi=Si?Si.toStringTag:r,Xs=function(){try{var e=Vi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Bp=ne.clearTimeout!==Xe.clearTimeout&&ne.clearTimeout,Kp=ye&&ye.now!==Xe.Date.now&&ye.now,Vp=ne.setTimeout!==Xe.setTimeout&&ne.setTimeout,Zs=Kt.ceil,Qs=Kt.floor,xo=ut.getOwnPropertySymbols,Gp=ks?ks.isBuffer:r,Hu=ne.isFinite,kp=Bs.join,Wp=Fu(ut.keys,ut),Vt=Kt.max,Xt=Kt.min,Yp=ye.now,Jp=ne.parseInt,Bu=Kt.random,Xp=Bs.reverse,Po=Vi(ne,"DataView"),zn=Vi(ne,"Map"),Ao=Vi(ne,"Promise"),yn=Vi(ne,"Set"),Hn=Vi(ne,"WeakMap"),Bn=Vi(ut,"create"),ea=Hn&&new Hn,vn={},Zp=Gi(Po),Qp=Gi(zn),eg=Gi(Ao),tg=Gi(yn),rg=Gi(Hn),ta=Si?Si.prototype:r,Kn=ta?ta.valueOf:r,Ku=ta?ta.toString:r;function S(e){if(At(e)&&!Ne(e)&&!(e instanceof Ye)){if(e instanceof Cr)return e;if(nt.call(e,"__wrapped__"))return Vh(e)}return new Cr(e)}var mn=function(){function e(){}return function(i){if(!bt(i))return{};if(Mu)return Mu(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function ra(){}function Cr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}S.templateSettings={escape:St,evaluate:It,interpolate:mt,variable:"",imports:{_:S}},S.prototype=ra.prototype,S.prototype.constructor=S,Cr.prototype=mn(ra.prototype),Cr.prototype.constructor=Cr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=te,this.__views__=[]}function ig(){var e=new Ye(this.__wrapped__);return e.__actions__=dr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=dr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=dr(this.__views__),e}function ng(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function sg(){var e=this.__wrapped__.value(),i=this.__dir__,a=Ne(e),h=i<0,v=a?e.length:0,I=y0(0,v,this.__views__),R=I.start,U=I.end,G=U-R,se=h?U:R-1,ae=this.__iteratees__,ce=ae.length,fe=0,ve=Xt(G,this.__takeCount__);if(!a||!h&&v==G&&ve==G)return ph(e,this.__actions__);var Ee=[];e:for(;G--&&fe<ve;){se+=i;for(var ze=-1,Se=e[se];++ze<ce;){var ke=ae[ze],Ze=ke.iteratee,Sr=ke.type,sr=Ze(Se);if(Sr==p)Se=sr;else if(!sr){if(Sr==_)continue e;break e}}Ee[fe++]=Se}return Ee}Ye.prototype=mn(ra.prototype),Ye.prototype.constructor=Ye;function zi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function ag(){this.__data__=Bn?Bn(null):{},this.size=0}function og(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function cg(e){var i=this.__data__;if(Bn){var a=i[e];return a===E?r:a}return nt.call(i,e)?i[e]:r}function ug(e){var i=this.__data__;return Bn?i[e]!==r:nt.call(i,e)}function hg(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Bn&&i===r?E:i,this}zi.prototype.clear=ag,zi.prototype.delete=og,zi.prototype.get=cg,zi.prototype.has=ug,zi.prototype.set=hg;function ai(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function lg(){this.__data__=[],this.size=0}function fg(e){var i=this.__data__,a=ia(i,e);if(a<0)return!1;var h=i.length-1;return a==h?i.pop():Js.call(i,a,1),--this.size,!0}function dg(e){var i=this.__data__,a=ia(i,e);return a<0?r:i[a][1]}function pg(e){return ia(this.__data__,e)>-1}function gg(e,i){var a=this.__data__,h=ia(a,e);return h<0?(++this.size,a.push([e,i])):a[h][1]=i,this}ai.prototype.clear=lg,ai.prototype.delete=fg,ai.prototype.get=dg,ai.prototype.has=pg,ai.prototype.set=gg;function oi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var h=e[i];this.set(h[0],h[1])}}function _g(){this.size=0,this.__data__={hash:new zi,map:new(zn||ai),string:new zi}}function yg(e){var i=ga(this,e).delete(e);return this.size-=i?1:0,i}function vg(e){return ga(this,e).get(e)}function mg(e){return ga(this,e).has(e)}function bg(e,i){var a=ga(this,e),h=a.size;return a.set(e,i),this.size+=a.size==h?0:1,this}oi.prototype.clear=_g,oi.prototype.delete=yg,oi.prototype.get=vg,oi.prototype.has=mg,oi.prototype.set=bg;function Hi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new oi;++i<a;)this.add(e[i])}function wg(e){return this.__data__.set(e,E),this}function Eg(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=wg,Hi.prototype.has=Eg;function zr(e){var i=this.__data__=new ai(e);this.size=i.size}function Sg(){this.__data__=new ai,this.size=0}function Ig(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Og(e){return this.__data__.get(e)}function xg(e){return this.__data__.has(e)}function Pg(e,i){var a=this.__data__;if(a instanceof ai){var h=a.__data__;if(!zn||h.length<o-1)return h.push([e,i]),this.size=++a.size,this;a=this.__data__=new oi(h)}return a.set(e,i),this.size=a.size,this}zr.prototype.clear=Sg,zr.prototype.delete=Ig,zr.prototype.get=Og,zr.prototype.has=xg,zr.prototype.set=Pg;function Vu(e,i){var a=Ne(e),h=!a&&ki(e),v=!a&&!h&&Ai(e),I=!a&&!h&&!v&&Sn(e),R=a||h||v||I,U=R?Eo(e.length,Lp):[],G=U.length;for(var se in e)(i||nt.call(e,se))&&!(R&&(se=="length"||v&&(se=="offset"||se=="parent")||I&&(se=="buffer"||se=="byteLength"||se=="byteOffset")||li(se,G)))&&U.push(se);return U}function Gu(e){var i=e.length;return i?e[Mo(0,i-1)]:r}function Ag(e,i){return _a(dr(e),Bi(i,0,e.length))}function Tg(e){return _a(dr(e))}function To(e,i,a){(a!==r&&!Hr(e[i],a)||a===r&&!(i in e))&&ci(e,i,a)}function Vn(e,i,a){var h=e[i];(!(nt.call(e,i)&&Hr(h,a))||a===r&&!(i in e))&&ci(e,i,a)}function ia(e,i){for(var a=e.length;a--;)if(Hr(e[a][0],i))return a;return-1}function Cg(e,i,a,h){return Ii(e,function(v,I,R){i(h,v,a(v),R)}),h}function ku(e,i){return e&&Xr(i,kt(i),e)}function Rg(e,i){return e&&Xr(i,gr(i),e)}function ci(e,i,a){i=="__proto__"&&Xs?Xs(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function Co(e,i){for(var a=-1,h=i.length,v=ee(h),I=e==null;++a<h;)v[a]=I?r:hc(e,i[a]);return v}function Bi(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Rr(e,i,a,h,v,I){var R,U=i&$,G=i&k,se=i&M;if(a&&(R=v?a(e,h,v,I):a(e)),R!==r)return R;if(!bt(e))return e;var ae=Ne(e);if(ae){if(R=m0(e),!U)return dr(e,R)}else{var ce=Zt(e),fe=ce==he||ce==pe;if(Ai(e))return yh(e,U);if(ce==Le||ce==le||fe&&!v){if(R=G||fe?{}:Uh(e),!U)return G?c0(e,Rg(R,e)):o0(e,ku(R,e))}else{if(!st[ce])return v?e:{};R=b0(e,ce,U)}}I||(I=new zr);var ve=I.get(e);if(ve)return ve;I.set(e,R),ll(e)?e.forEach(function(Se){R.add(Rr(Se,i,a,Se,e,I))}):ul(e)&&e.forEach(function(Se,ke){R.set(ke,Rr(Se,i,a,ke,e,I))});var Ee=se?G?Jo:Yo:G?gr:kt,ze=ae?r:Ee(e);return Ar(ze||e,function(Se,ke){ze&&(ke=Se,Se=e[ke]),Vn(R,ke,Rr(Se,i,a,ke,e,I))}),R}function Ng(e){var i=kt(e);return function(a){return Wu(a,e,i)}}function Wu(e,i,a){var h=a.length;if(e==null)return!h;for(e=ut(e);h--;){var v=a[h],I=i[v],R=e[v];if(R===r&&!(v in e)||!I(R))return!1}return!0}function Yu(e,i,a){if(typeof e!="function")throw new Tr(b);return Zn(function(){e.apply(r,a)},i)}function Gn(e,i,a,h){var v=-1,I=qs,R=!0,U=e.length,G=[],se=i.length;if(!U)return G;a&&(i=vt(i,br(a))),h?(I=_o,R=!1):i.length>=o&&(I=Mn,R=!1,i=new Hi(i));e:for(;++v<U;){var ae=e[v],ce=a==null?ae:a(ae);if(ae=h||ae!==0?ae:0,R&&ce===ce){for(var fe=se;fe--;)if(i[fe]===ce)continue e;G.push(ae)}else I(i,ce,h)||G.push(ae)}return G}var Ii=Eh(Jr),Ju=Eh(No,!0);function jg(e,i){var a=!0;return Ii(e,function(h,v,I){return a=!!i(h,v,I),a}),a}function na(e,i,a){for(var h=-1,v=e.length;++h<v;){var I=e[h],R=i(I);if(R!=null&&(U===r?R===R&&!Er(R):a(R,U)))var U=R,G=I}return G}function Dg(e,i,a,h){var v=e.length;for(a=$e(a),a<0&&(a=-a>v?0:v+a),h=h===r||h>v?v:$e(h),h<0&&(h+=v),h=a>h?0:dl(h);a<h;)e[a++]=i;return e}function Xu(e,i){var a=[];return Ii(e,function(h,v,I){i(h,v,I)&&a.push(h)}),a}function Yt(e,i,a,h,v){var I=-1,R=e.length;for(a||(a=E0),v||(v=[]);++I<R;){var U=e[I];i>0&&a(U)?i>1?Yt(U,i-1,a,h,v):wi(v,U):h||(v[v.length]=U)}return v}var Ro=Sh(),Zu=Sh(!0);function Jr(e,i){return e&&Ro(e,i,kt)}function No(e,i){return e&&Zu(e,i,kt)}function sa(e,i){return bi(i,function(a){return fi(e[a])})}function Ki(e,i){i=xi(i,e);for(var a=0,h=i.length;e!=null&&a<h;)e=e[Zr(i[a++])];return a&&a==h?e:r}function Qu(e,i,a){var h=i(e);return Ne(e)?h:wi(h,a(e))}function ir(e){return e==null?e===r?qe:Ve:qi&&qi in ut(e)?_0(e):T0(e)}function jo(e,i){return e>i}function Fg(e,i){return e!=null&&nt.call(e,i)}function Ug(e,i){return e!=null&&i in ut(e)}function Lg(e,i,a){return e>=Xt(i,a)&&e<Vt(i,a)}function Do(e,i,a){for(var h=a?_o:qs,v=e[0].length,I=e.length,R=I,U=ee(I),G=1/0,se=[];R--;){var ae=e[R];R&&i&&(ae=vt(ae,br(i))),G=Xt(ae.length,G),U[R]=!a&&(i||v>=120&&ae.length>=120)?new Hi(R&&ae):r}ae=e[0];var ce=-1,fe=U[0];e:for(;++ce<v&&se.length<G;){var ve=ae[ce],Ee=i?i(ve):ve;if(ve=a||ve!==0?ve:0,!(fe?Mn(fe,Ee):h(se,Ee,a))){for(R=I;--R;){var ze=U[R];if(!(ze?Mn(ze,Ee):h(e[R],Ee,a)))continue e}fe&&fe.push(Ee),se.push(ve)}}return se}function $g(e,i,a,h){return Jr(e,function(v,I,R){i(h,a(v),I,R)}),h}function kn(e,i,a){i=xi(i,e),e=qh(e,i);var h=e==null?e:e[Zr(jr(i))];return h==null?r:Gt(h,e,a)}function eh(e){return At(e)&&ir(e)==le}function Mg(e){return At(e)&&ir(e)==Ie}function qg(e){return At(e)&&ir(e)==z}function Wn(e,i,a,h,v){return e===i?!0:e==null||i==null||!At(e)&&!At(i)?e!==e&&i!==i:zg(e,i,a,h,Wn,v)}function zg(e,i,a,h,v,I){var R=Ne(e),U=Ne(i),G=R?be:Zt(e),se=U?be:Zt(i);G=G==le?Le:G,se=se==le?Le:se;var ae=G==Le,ce=se==Le,fe=G==se;if(fe&&Ai(e)){if(!Ai(i))return!1;R=!0,ae=!1}if(fe&&!ae)return I||(I=new zr),R||Sn(e)?jh(e,i,a,h,v,I):p0(e,i,G,a,h,v,I);if(!(a&H)){var ve=ae&&nt.call(e,"__wrapped__"),Ee=ce&&nt.call(i,"__wrapped__");if(ve||Ee){var ze=ve?e.value():e,Se=Ee?i.value():i;return I||(I=new zr),v(ze,Se,a,h,I)}}return fe?(I||(I=new zr),g0(e,i,a,h,v,I)):!1}function Hg(e){return At(e)&&Zt(e)==Oe}function Fo(e,i,a,h){var v=a.length,I=v,R=!h;if(e==null)return!I;for(e=ut(e);v--;){var U=a[v];if(R&&U[2]?U[1]!==e[U[0]]:!(U[0]in e))return!1}for(;++v<I;){U=a[v];var G=U[0],se=e[G],ae=U[1];if(R&&U[2]){if(se===r&&!(G in e))return!1}else{var ce=new zr;if(h)var fe=h(se,ae,G,e,i,ce);if(!(fe===r?Wn(ae,se,H|Z,h,ce):fe))return!1}}return!0}function th(e){if(!bt(e)||I0(e))return!1;var i=fi(e)?Hp:Qa;return i.test(Gi(e))}function Bg(e){return At(e)&&ir(e)==Me}function Kg(e){return At(e)&&Zt(e)==xe}function Vg(e){return At(e)&&Ea(e.length)&&!!at[ir(e)]}function rh(e){return typeof e=="function"?e:e==null?_r:typeof e=="object"?Ne(e)?sh(e[0],e[1]):nh(e):Il(e)}function Uo(e){if(!Xn(e))return Wp(e);var i=[];for(var a in ut(e))nt.call(e,a)&&a!="constructor"&&i.push(a);return i}function Gg(e){if(!bt(e))return A0(e);var i=Xn(e),a=[];for(var h in e)h=="constructor"&&(i||!nt.call(e,h))||a.push(h);return a}function Lo(e,i){return e<i}function ih(e,i){var a=-1,h=pr(e)?ee(e.length):[];return Ii(e,function(v,I,R){h[++a]=i(v,I,R)}),h}function nh(e){var i=Zo(e);return i.length==1&&i[0][2]?$h(i[0][0],i[0][1]):function(a){return a===e||Fo(a,e,i)}}function sh(e,i){return ec(e)&&Lh(i)?$h(Zr(e),i):function(a){var h=hc(a,e);return h===r&&h===i?lc(a,e):Wn(i,h,H|Z)}}function aa(e,i,a,h,v){e!==i&&Ro(i,function(I,R){if(v||(v=new zr),bt(I))kg(e,i,R,a,aa,h,v);else{var U=h?h(rc(e,R),I,R+"",e,i,v):r;U===r&&(U=I),To(e,R,U)}},gr)}function kg(e,i,a,h,v,I,R){var U=rc(e,a),G=rc(i,a),se=R.get(G);if(se){To(e,a,se);return}var ae=I?I(U,G,a+"",e,i,R):r,ce=ae===r;if(ce){var fe=Ne(G),ve=!fe&&Ai(G),Ee=!fe&&!ve&&Sn(G);ae=G,fe||ve||Ee?Ne(U)?ae=U:Nt(U)?ae=dr(U):ve?(ce=!1,ae=yh(G,!0)):Ee?(ce=!1,ae=vh(G,!0)):ae=[]:Qn(G)||ki(G)?(ae=U,ki(U)?ae=pl(U):(!bt(U)||fi(U))&&(ae=Uh(G))):ce=!1}ce&&(R.set(G,ae),v(ae,G,h,I,R),R.delete(G)),To(e,a,ae)}function ah(e,i){var a=e.length;if(a)return i+=i<0?a:0,li(i,a)?e[i]:r}function oh(e,i,a){i.length?i=vt(i,function(I){return Ne(I)?function(R){return Ki(R,I.length===1?I[0]:I)}:I}):i=[_r];var h=-1;i=vt(i,br(we()));var v=ih(e,function(I,R,U){var G=vt(i,function(se){return se(I)});return{criteria:G,index:++h,value:I}});return bp(v,function(I,R){return a0(I,R,a)})}function Wg(e,i){return ch(e,i,function(a,h){return lc(e,h)})}function ch(e,i,a){for(var h=-1,v=i.length,I={};++h<v;){var R=i[h],U=Ki(e,R);a(U,R)&&Yn(I,xi(R,e),U)}return I}function Yg(e){return function(i){return Ki(i,e)}}function $o(e,i,a,h){var v=h?mp:fn,I=-1,R=i.length,U=e;for(e===i&&(i=dr(i)),a&&(U=vt(e,br(a)));++I<R;)for(var G=0,se=i[I],ae=a?a(se):se;(G=v(U,ae,G,h))>-1;)U!==e&&Js.call(U,G,1),Js.call(e,G,1);return e}function uh(e,i){for(var a=e?i.length:0,h=a-1;a--;){var v=i[a];if(a==h||v!==I){var I=v;li(v)?Js.call(e,v,1):Ho(e,v)}}return e}function Mo(e,i){return e+Qs(Bu()*(i-e+1))}function Jg(e,i,a,h){for(var v=-1,I=Vt(Zs((i-e)/(a||1)),0),R=ee(I);I--;)R[h?I:++v]=e,e+=a;return R}function qo(e,i){var a="";if(!e||i<1||i>W)return a;do i%2&&(a+=e),i=Qs(i/2),i&&(e+=e);while(i);return a}function Ke(e,i){return ic(Mh(e,i,_r),e+"")}function Xg(e){return Gu(In(e))}function Zg(e,i){var a=In(e);return _a(a,Bi(i,0,a.length))}function Yn(e,i,a,h){if(!bt(e))return e;i=xi(i,e);for(var v=-1,I=i.length,R=I-1,U=e;U!=null&&++v<I;){var G=Zr(i[v]),se=a;if(G==="__proto__"||G==="constructor"||G==="prototype")return e;if(v!=R){var ae=U[G];se=h?h(ae,G,U):r,se===r&&(se=bt(ae)?ae:li(i[v+1])?[]:{})}Vn(U,G,se),U=U[G]}return e}var hh=ea?function(e,i){return ea.set(e,i),e}:_r,Qg=Xs?function(e,i){return Xs(e,"toString",{configurable:!0,enumerable:!1,value:dc(i),writable:!0})}:_r;function e0(e){return _a(In(e))}function Nr(e,i,a){var h=-1,v=e.length;i<0&&(i=-i>v?0:v+i),a=a>v?v:a,a<0&&(a+=v),v=i>a?0:a-i>>>0,i>>>=0;for(var I=ee(v);++h<v;)I[h]=e[h+i];return I}function t0(e,i){var a;return Ii(e,function(h,v,I){return a=i(h,v,I),!a}),!!a}function oa(e,i,a){var h=0,v=e==null?h:e.length;if(typeof i=="number"&&i===i&&v<=ie){for(;h<v;){var I=h+v>>>1,R=e[I];R!==null&&!Er(R)&&(a?R<=i:R<i)?h=I+1:v=I}return v}return zo(e,i,_r,a)}function zo(e,i,a,h){var v=0,I=e==null?0:e.length;if(I===0)return 0;i=a(i);for(var R=i!==i,U=i===null,G=Er(i),se=i===r;v<I;){var ae=Qs((v+I)/2),ce=a(e[ae]),fe=ce!==r,ve=ce===null,Ee=ce===ce,ze=Er(ce);if(R)var Se=h||Ee;else se?Se=Ee&&(h||fe):U?Se=Ee&&fe&&(h||!ve):G?Se=Ee&&fe&&!ve&&(h||!ze):ve||ze?Se=!1:Se=h?ce<=i:ce<i;Se?v=ae+1:I=ae}return Xt(I,re)}function lh(e,i){for(var a=-1,h=e.length,v=0,I=[];++a<h;){var R=e[a],U=i?i(R):R;if(!a||!Hr(U,G)){var G=U;I[v++]=R===0?0:R}}return I}function fh(e){return typeof e=="number"?e:Er(e)?q:+e}function wr(e){if(typeof e=="string")return e;if(Ne(e))return vt(e,wr)+"";if(Er(e))return Ku?Ku.call(e):"";var i=e+"";return i=="0"&&1/e==-F?"-0":i}function Oi(e,i,a){var h=-1,v=qs,I=e.length,R=!0,U=[],G=U;if(a)R=!1,v=_o;else if(I>=o){var se=i?null:f0(e);if(se)return Hs(se);R=!1,v=Mn,G=new Hi}else G=i?[]:U;e:for(;++h<I;){var ae=e[h],ce=i?i(ae):ae;if(ae=a||ae!==0?ae:0,R&&ce===ce){for(var fe=G.length;fe--;)if(G[fe]===ce)continue e;i&&G.push(ce),U.push(ae)}else v(G,ce,a)||(G!==U&&G.push(ce),U.push(ae))}return U}function Ho(e,i){return i=xi(i,e),e=qh(e,i),e==null||delete e[Zr(jr(i))]}function dh(e,i,a,h){return Yn(e,i,a(Ki(e,i)),h)}function ca(e,i,a,h){for(var v=e.length,I=h?v:-1;(h?I--:++I<v)&&i(e[I],I,e););return a?Nr(e,h?0:I,h?I+1:v):Nr(e,h?I+1:0,h?v:I)}function ph(e,i){var a=e;return a instanceof Ye&&(a=a.value()),yo(i,function(h,v){return v.func.apply(v.thisArg,wi([h],v.args))},a)}function Bo(e,i,a){var h=e.length;if(h<2)return h?Oi(e[0]):[];for(var v=-1,I=ee(h);++v<h;)for(var R=e[v],U=-1;++U<h;)U!=v&&(I[v]=Gn(I[v]||R,e[U],i,a));return Oi(Yt(I,1),i,a)}function gh(e,i,a){for(var h=-1,v=e.length,I=i.length,R={};++h<v;){var U=h<I?i[h]:r;a(R,e[h],U)}return R}function Ko(e){return Nt(e)?e:[]}function Vo(e){return typeof e=="function"?e:_r}function xi(e,i){return Ne(e)?e:ec(e,i)?[e]:Kh(it(e))}var r0=Ke;function Pi(e,i,a){var h=e.length;return a=a===r?h:a,!i&&a>=h?e:Nr(e,i,a)}var _h=Bp||function(e){return Xe.clearTimeout(e)};function yh(e,i){if(i)return e.slice();var a=e.length,h=$u?$u(a):new e.constructor(a);return e.copy(h),h}function Go(e){var i=new e.constructor(e.byteLength);return new Ws(i).set(new Ws(e)),i}function i0(e,i){var a=i?Go(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function n0(e){var i=new e.constructor(e.source,xr.exec(e));return i.lastIndex=e.lastIndex,i}function s0(e){return Kn?ut(Kn.call(e)):{}}function vh(e,i){var a=i?Go(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function mh(e,i){if(e!==i){var a=e!==r,h=e===null,v=e===e,I=Er(e),R=i!==r,U=i===null,G=i===i,se=Er(i);if(!U&&!se&&!I&&e>i||I&&R&&G&&!U&&!se||h&&R&&G||!a&&G||!v)return 1;if(!h&&!I&&!se&&e<i||se&&a&&v&&!h&&!I||U&&a&&v||!R&&v||!G)return-1}return 0}function a0(e,i,a){for(var h=-1,v=e.criteria,I=i.criteria,R=v.length,U=a.length;++h<R;){var G=mh(v[h],I[h]);if(G){if(h>=U)return G;var se=a[h];return G*(se=="desc"?-1:1)}}return e.index-i.index}function bh(e,i,a,h){for(var v=-1,I=e.length,R=a.length,U=-1,G=i.length,se=Vt(I-R,0),ae=ee(G+se),ce=!h;++U<G;)ae[U]=i[U];for(;++v<R;)(ce||v<I)&&(ae[a[v]]=e[v]);for(;se--;)ae[U++]=e[v++];return ae}function wh(e,i,a,h){for(var v=-1,I=e.length,R=-1,U=a.length,G=-1,se=i.length,ae=Vt(I-U,0),ce=ee(ae+se),fe=!h;++v<ae;)ce[v]=e[v];for(var ve=v;++G<se;)ce[ve+G]=i[G];for(;++R<U;)(fe||v<I)&&(ce[ve+a[R]]=e[v++]);return ce}function dr(e,i){var a=-1,h=e.length;for(i||(i=ee(h));++a<h;)i[a]=e[a];return i}function Xr(e,i,a,h){var v=!a;a||(a={});for(var I=-1,R=i.length;++I<R;){var U=i[I],G=h?h(a[U],e[U],U,a,e):r;G===r&&(G=e[U]),v?ci(a,U,G):Vn(a,U,G)}return a}function o0(e,i){return Xr(e,Qo(e),i)}function c0(e,i){return Xr(e,Dh(e),i)}function ua(e,i){return function(a,h){var v=Ne(a)?dp:Cg,I=i?i():{};return v(a,e,we(h,2),I)}}function bn(e){return Ke(function(i,a){var h=-1,v=a.length,I=v>1?a[v-1]:r,R=v>2?a[2]:r;for(I=e.length>3&&typeof I=="function"?(v--,I):r,R&&nr(a[0],a[1],R)&&(I=v<3?r:I,v=1),i=ut(i);++h<v;){var U=a[h];U&&e(i,U,h,I)}return i})}function Eh(e,i){return function(a,h){if(a==null)return a;if(!pr(a))return e(a,h);for(var v=a.length,I=i?v:-1,R=ut(a);(i?I--:++I<v)&&h(R[I],I,R)!==!1;);return a}}function Sh(e){return function(i,a,h){for(var v=-1,I=ut(i),R=h(i),U=R.length;U--;){var G=R[e?U:++v];if(a(I[G],G,I)===!1)break}return i}}function u0(e,i,a){var h=i&Q,v=Jn(e);function I(){var R=this&&this!==Xe&&this instanceof I?v:e;return R.apply(h?a:this,arguments)}return I}function Ih(e){return function(i){i=it(i);var a=dn(i)?qr(i):r,h=a?a[0]:i.charAt(0),v=a?Pi(a,1).join(""):i.slice(1);return h[e]()+v}}function wn(e){return function(i){return yo(El(wl(i).replace(Ln,"")),e,"")}}function Jn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=mn(e.prototype),h=e.apply(a,i);return bt(h)?h:a}}function h0(e,i,a){var h=Jn(e);function v(){for(var I=arguments.length,R=ee(I),U=I,G=En(v);U--;)R[U]=arguments[U];var se=I<3&&R[0]!==G&&R[I-1]!==G?[]:Ei(R,G);if(I-=se.length,I<a)return Th(e,i,ha,v.placeholder,r,R,se,r,r,a-I);var ae=this&&this!==Xe&&this instanceof v?h:e;return Gt(ae,this,R)}return v}function Oh(e){return function(i,a,h){var v=ut(i);if(!pr(i)){var I=we(a,3);i=kt(i),a=function(U){return I(v[U],U,v)}}var R=e(i,a,h);return R>-1?v[I?i[R]:R]:r}}function xh(e){return hi(function(i){var a=i.length,h=a,v=Cr.prototype.thru;for(e&&i.reverse();h--;){var I=i[h];if(typeof I!="function")throw new Tr(b);if(v&&!R&&pa(I)=="wrapper")var R=new Cr([],!0)}for(h=R?h:a;++h<a;){I=i[h];var U=pa(I),G=U=="wrapper"?Xo(I):r;G&&tc(G[0])&&G[1]==(u|B|j|y)&&!G[4].length&&G[9]==1?R=R[pa(G[0])].apply(R,G[3]):R=I.length==1&&tc(I)?R[U]():R.thru(I)}return function(){var se=arguments,ae=se[0];if(R&&se.length==1&&Ne(ae))return R.plant(ae).value();for(var ce=0,fe=a?i[ce].apply(this,se):ae;++ce<a;)fe=i[ce].call(this,fe);return fe}})}function ha(e,i,a,h,v,I,R,U,G,se){var ae=i&u,ce=i&Q,fe=i&ue,ve=i&(B|N),Ee=i&X,ze=fe?r:Jn(e);function Se(){for(var ke=arguments.length,Ze=ee(ke),Sr=ke;Sr--;)Ze[Sr]=arguments[Sr];if(ve)var sr=En(Se),Ir=Ep(Ze,sr);if(h&&(Ze=bh(Ze,h,v,ve)),I&&(Ze=wh(Ze,I,R,ve)),ke-=Ir,ve&&ke<se){var jt=Ei(Ze,sr);return Th(e,i,ha,Se.placeholder,a,Ze,jt,U,G,se-ke)}var Br=ce?a:this,pi=fe?Br[e]:e;return ke=Ze.length,U?Ze=C0(Ze,U):Ee&&ke>1&&Ze.reverse(),ae&&G<ke&&(Ze.length=G),this&&this!==Xe&&this instanceof Se&&(pi=ze||Jn(pi)),pi.apply(Br,Ze)}return Se}function Ph(e,i){return function(a,h){return $g(a,e,i(h),{})}}function la(e,i){return function(a,h){var v;if(a===r&&h===r)return i;if(a!==r&&(v=a),h!==r){if(v===r)return h;typeof a=="string"||typeof h=="string"?(a=wr(a),h=wr(h)):(a=fh(a),h=fh(h)),v=e(a,h)}return v}}function ko(e){return hi(function(i){return i=vt(i,br(we())),Ke(function(a){var h=this;return e(i,function(v){return Gt(v,h,a)})})})}function fa(e,i){i=i===r?" ":wr(i);var a=i.length;if(a<2)return a?qo(i,e):i;var h=qo(i,Zs(e/pn(i)));return dn(i)?Pi(qr(h),0,e).join(""):h.slice(0,e)}function l0(e,i,a,h){var v=i&Q,I=Jn(e);function R(){for(var U=-1,G=arguments.length,se=-1,ae=h.length,ce=ee(ae+G),fe=this&&this!==Xe&&this instanceof R?I:e;++se<ae;)ce[se]=h[se];for(;G--;)ce[se++]=arguments[++U];return Gt(fe,v?a:this,ce)}return R}function Ah(e){return function(i,a,h){return h&&typeof h!="number"&&nr(i,a,h)&&(a=h=r),i=di(i),a===r?(a=i,i=0):a=di(a),h=h===r?i<a?1:-1:di(h),Jg(i,a,h,e)}}function da(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Dr(i),a=Dr(a)),e(i,a)}}function Th(e,i,a,h,v,I,R,U,G,se){var ae=i&B,ce=ae?R:r,fe=ae?r:R,ve=ae?I:r,Ee=ae?r:I;i|=ae?j:O,i&=~(ae?O:j),i&L||(i&=~(Q|ue));var ze=[e,i,v,ve,ce,Ee,fe,U,G,se],Se=a.apply(r,ze);return tc(e)&&zh(Se,ze),Se.placeholder=h,Hh(Se,e,i)}function Wo(e){var i=Kt[e];return function(a,h){if(a=Dr(a),h=h==null?0:Xt($e(h),292),h&&Hu(a)){var v=(it(a)+"e").split("e"),I=i(v[0]+"e"+(+v[1]+h));return v=(it(I)+"e").split("e"),+(v[0]+"e"+(+v[1]-h))}return i(a)}}var f0=yn&&1/Hs(new yn([,-0]))[1]==F?function(e){return new yn(e)}:_c;function Ch(e){return function(i){var a=Zt(i);return a==Oe?Io(i):a==xe?Tp(i):wp(i,e(i))}}function ui(e,i,a,h,v,I,R,U){var G=i&ue;if(!G&&typeof e!="function")throw new Tr(b);var se=h?h.length:0;if(se||(i&=~(j|O),h=v=r),R=R===r?R:Vt($e(R),0),U=U===r?U:$e(U),se-=v?v.length:0,i&O){var ae=h,ce=v;h=v=r}var fe=G?r:Xo(e),ve=[e,i,a,h,v,ae,ce,I,R,U];if(fe&&P0(ve,fe),e=ve[0],i=ve[1],a=ve[2],h=ve[3],v=ve[4],U=ve[9]=ve[9]===r?G?0:e.length:Vt(ve[9]-se,0),!U&&i&(B|N)&&(i&=~(B|N)),!i||i==Q)var Ee=u0(e,i,a);else i==B||i==N?Ee=h0(e,i,U):(i==j||i==(Q|j))&&!v.length?Ee=l0(e,i,a,h):Ee=ha.apply(r,ve);var ze=fe?hh:zh;return Hh(ze(Ee,ve),e,i)}function Rh(e,i,a,h){return e===r||Hr(e,_n[a])&&!nt.call(h,a)?i:e}function Nh(e,i,a,h,v,I){return bt(e)&&bt(i)&&(I.set(i,e),aa(e,i,r,Nh,I),I.delete(i)),e}function d0(e){return Qn(e)?r:e}function jh(e,i,a,h,v,I){var R=a&H,U=e.length,G=i.length;if(U!=G&&!(R&&G>U))return!1;var se=I.get(e),ae=I.get(i);if(se&&ae)return se==i&&ae==e;var ce=-1,fe=!0,ve=a&Z?new Hi:r;for(I.set(e,i),I.set(i,e);++ce<U;){var Ee=e[ce],ze=i[ce];if(h)var Se=R?h(ze,Ee,ce,i,e,I):h(Ee,ze,ce,e,i,I);if(Se!==r){if(Se)continue;fe=!1;break}if(ve){if(!vo(i,function(ke,Ze){if(!Mn(ve,Ze)&&(Ee===ke||v(Ee,ke,a,h,I)))return ve.push(Ze)})){fe=!1;break}}else if(!(Ee===ze||v(Ee,ze,a,h,I))){fe=!1;break}}return I.delete(e),I.delete(i),fe}function p0(e,i,a,h,v,I,R){switch(a){case Te:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ie:return!(e.byteLength!=i.byteLength||!I(new Ws(e),new Ws(i)));case Y:case z:case He:return Hr(+e,+i);case D:return e.name==i.name&&e.message==i.message;case Me:case je:return e==i+"";case Oe:var U=Io;case xe:var G=h&H;if(U||(U=Hs),e.size!=i.size&&!G)return!1;var se=R.get(e);if(se)return se==i;h|=Z,R.set(e,i);var ae=jh(U(e),U(i),h,v,I,R);return R.delete(e),ae;case De:if(Kn)return Kn.call(e)==Kn.call(i)}return!1}function g0(e,i,a,h,v,I){var R=a&H,U=Yo(e),G=U.length,se=Yo(i),ae=se.length;if(G!=ae&&!R)return!1;for(var ce=G;ce--;){var fe=U[ce];if(!(R?fe in i:nt.call(i,fe)))return!1}var ve=I.get(e),Ee=I.get(i);if(ve&&Ee)return ve==i&&Ee==e;var ze=!0;I.set(e,i),I.set(i,e);for(var Se=R;++ce<G;){fe=U[ce];var ke=e[fe],Ze=i[fe];if(h)var Sr=R?h(Ze,ke,fe,i,e,I):h(ke,Ze,fe,e,i,I);if(!(Sr===r?ke===Ze||v(ke,Ze,a,h,I):Sr)){ze=!1;break}Se||(Se=fe=="constructor")}if(ze&&!Se){var sr=e.constructor,Ir=i.constructor;sr!=Ir&&"constructor"in e&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof Ir=="function"&&Ir instanceof Ir)&&(ze=!1)}return I.delete(e),I.delete(i),ze}function hi(e){return ic(Mh(e,r,Wh),e+"")}function Yo(e){return Qu(e,kt,Qo)}function Jo(e){return Qu(e,gr,Dh)}var Xo=ea?function(e){return ea.get(e)}:_c;function pa(e){for(var i=e.name+"",a=vn[i],h=nt.call(vn,i)?a.length:0;h--;){var v=a[h],I=v.func;if(I==null||I==e)return v.name}return i}function En(e){var i=nt.call(S,"placeholder")?S:e;return i.placeholder}function we(){var e=S.iteratee||pc;return e=e===pc?rh:e,arguments.length?e(arguments[0],arguments[1]):e}function ga(e,i){var a=e.__data__;return S0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Zo(e){for(var i=kt(e),a=i.length;a--;){var h=i[a],v=e[h];i[a]=[h,v,Lh(v)]}return i}function Vi(e,i){var a=xp(e,i);return th(a)?a:r}function _0(e){var i=nt.call(e,qi),a=e[qi];try{e[qi]=r;var h=!0}catch{}var v=Gs.call(e);return h&&(i?e[qi]=a:delete e[qi]),v}var Qo=xo?function(e){return e==null?[]:(e=ut(e),bi(xo(e),function(i){return qu.call(e,i)}))}:yc,Dh=xo?function(e){for(var i=[];e;)wi(i,Qo(e)),e=Ys(e);return i}:yc,Zt=ir;(Po&&Zt(new Po(new ArrayBuffer(1)))!=Te||zn&&Zt(new zn)!=Oe||Ao&&Zt(Ao.resolve())!=pt||yn&&Zt(new yn)!=xe||Hn&&Zt(new Hn)!=Ae)&&(Zt=function(e){var i=ir(e),a=i==Le?e.constructor:r,h=a?Gi(a):"";if(h)switch(h){case Zp:return Te;case Qp:return Oe;case eg:return pt;case tg:return xe;case rg:return Ae}return i});function y0(e,i,a){for(var h=-1,v=a.length;++h<v;){var I=a[h],R=I.size;switch(I.type){case"drop":e+=R;break;case"dropRight":i-=R;break;case"take":i=Xt(i,e+R);break;case"takeRight":e=Vt(e,i-R);break}}return{start:e,end:i}}function v0(e){var i=e.match(ht);return i?i[1].split(Mt):[]}function Fh(e,i,a){i=xi(i,e);for(var h=-1,v=i.length,I=!1;++h<v;){var R=Zr(i[h]);if(!(I=e!=null&&a(e,R)))break;e=e[R]}return I||++h!=v?I:(v=e==null?0:e.length,!!v&&Ea(v)&&li(R,v)&&(Ne(e)||ki(e)))}function m0(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function Uh(e){return typeof e.constructor=="function"&&!Xn(e)?mn(Ys(e)):{}}function b0(e,i,a){var h=e.constructor;switch(i){case Ie:return Go(e);case Y:case z:return new h(+e);case Te:return i0(e,a);case Be:case Pe:case Ge:case We:case et:case tt:case Je:case er:case lr:return vh(e,a);case Oe:return new h;case He:case je:return new h(e);case Me:return n0(e);case xe:return new h;case De:return s0(e)}}function w0(e,i){var a=i.length;if(!a)return e;var h=a-1;return i[h]=(a>1?"& ":"")+i[h],i=i.join(a>2?", ":" "),e.replace(Pt,`{
/* [wrapped with `+i+`] */
`)}function E0(e){return Ne(e)||ki(e)||!!(zu&&e&&e[zu])}function li(e,i){var a=typeof e;return i=i!=null?i:W,!!i&&(a=="number"||a!="symbol"&&to.test(e))&&e>-1&&e%1==0&&e<i}function nr(e,i,a){if(!bt(a))return!1;var h=typeof i;return(h=="number"?pr(a)&&li(i,a.length):h=="string"&&i in a)?Hr(a[i],e):!1}function ec(e,i){if(Ne(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||Er(e)?!0:Ut.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function S0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function tc(e){var i=pa(e),a=S[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(e===a)return!0;var h=Xo(a);return!!h&&e===h[0]}function I0(e){return!!Lu&&Lu in e}var O0=Ks?fi:vc;function Xn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||_n;return e===a}function Lh(e){return e===e&&!bt(e)}function $h(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ut(a))}}function x0(e){var i=ba(e,function(h){return a.size===A&&a.clear(),h}),a=i.cache;return i}function P0(e,i){var a=e[1],h=i[1],v=a|h,I=v<(Q|ue|u),R=h==u&&a==B||h==u&&a==y&&e[7].length<=i[8]||h==(u|y)&&i[7].length<=i[8]&&a==B;if(!(I||R))return e;h&Q&&(e[2]=i[2],v|=a&Q?0:L);var U=i[3];if(U){var G=e[3];e[3]=G?bh(G,U,i[4]):U,e[4]=G?Ei(e[3],C):i[4]}return U=i[5],U&&(G=e[5],e[5]=G?wh(G,U,i[6]):U,e[6]=G?Ei(e[5],C):i[6]),U=i[7],U&&(e[7]=U),h&u&&(e[8]=e[8]==null?i[8]:Xt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=v,e}function A0(e){var i=[];if(e!=null)for(var a in ut(e))i.push(a);return i}function T0(e){return Gs.call(e)}function Mh(e,i,a){return i=Vt(i===r?e.length-1:i,0),function(){for(var h=arguments,v=-1,I=Vt(h.length-i,0),R=ee(I);++v<I;)R[v]=h[i+v];v=-1;for(var U=ee(i+1);++v<i;)U[v]=h[v];return U[i]=a(R),Gt(e,this,U)}}function qh(e,i){return i.length<2?e:Ki(e,Nr(i,0,-1))}function C0(e,i){for(var a=e.length,h=Xt(i.length,a),v=dr(e);h--;){var I=i[h];e[h]=li(I,a)?v[I]:r}return e}function rc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var zh=Bh(hh),Zn=Vp||function(e,i){return Xe.setTimeout(e,i)},ic=Bh(Qg);function Hh(e,i,a){var h=i+"";return ic(e,w0(h,R0(v0(h),a)))}function Bh(e){var i=0,a=0;return function(){var h=Yp(),v=w-(h-a);if(a=h,v>0){if(++i>=d)return arguments[0]}else i=0;return e.apply(r,arguments)}}function _a(e,i){var a=-1,h=e.length,v=h-1;for(i=i===r?h:i;++a<i;){var I=Mo(a,v),R=e[I];e[I]=e[a],e[a]=R}return e.length=i,e}var Kh=x0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Lt,function(a,h,v,I){i.push(v?I.replace(Ya,"$1"):h||a)}),i});function Zr(e){if(typeof e=="string"||Er(e))return e;var i=e+"";return i=="0"&&1/e==-F?"-0":i}function Gi(e){if(e!=null){try{return Vs.call(e)}catch{}try{return e+""}catch{}}return""}function R0(e,i){return Ar(ge,function(a){var h="_."+a[0];i&a[1]&&!qs(e,h)&&e.push(h)}),e.sort()}function Vh(e){if(e instanceof Ye)return e.clone();var i=new Cr(e.__wrapped__,e.__chain__);return i.__actions__=dr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function N0(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=Vt($e(i),0);var h=e==null?0:e.length;if(!h||i<1)return[];for(var v=0,I=0,R=ee(Zs(h/i));v<h;)R[I++]=Nr(e,v,v+=i);return R}function j0(e){for(var i=-1,a=e==null?0:e.length,h=0,v=[];++i<a;){var I=e[i];I&&(v[h++]=I)}return v}function D0(){var e=arguments.length;if(!e)return[];for(var i=ee(e-1),a=arguments[0],h=e;h--;)i[h-1]=arguments[h];return wi(Ne(a)?dr(a):[a],Yt(i,1))}var F0=Ke(function(e,i){return Nt(e)?Gn(e,Yt(i,1,Nt,!0)):[]}),U0=Ke(function(e,i){var a=jr(i);return Nt(a)&&(a=r),Nt(e)?Gn(e,Yt(i,1,Nt,!0),we(a,2)):[]}),L0=Ke(function(e,i){var a=jr(i);return Nt(a)&&(a=r),Nt(e)?Gn(e,Yt(i,1,Nt,!0),r,a):[]});function $0(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),Nr(e,i<0?0:i,h)):[]}function M0(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),i=h-i,Nr(e,0,i<0?0:i)):[]}function q0(e,i){return e&&e.length?ca(e,we(i,3),!0,!0):[]}function z0(e,i){return e&&e.length?ca(e,we(i,3),!0):[]}function H0(e,i,a,h){var v=e==null?0:e.length;return v?(a&&typeof a!="number"&&nr(e,i,a)&&(a=0,h=v),Dg(e,i,a,h)):[]}function Gh(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=a==null?0:$e(a);return v<0&&(v=Vt(h+v,0)),zs(e,we(i,3),v)}function kh(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=h-1;return a!==r&&(v=$e(a),v=a<0?Vt(h+v,0):Xt(v,h-1)),zs(e,we(i,3),v,!0)}function Wh(e){var i=e==null?0:e.length;return i?Yt(e,1):[]}function B0(e){var i=e==null?0:e.length;return i?Yt(e,F):[]}function K0(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:$e(i),Yt(e,i)):[]}function V0(e){for(var i=-1,a=e==null?0:e.length,h={};++i<a;){var v=e[i];h[v[0]]=v[1]}return h}function Yh(e){return e&&e.length?e[0]:r}function G0(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=a==null?0:$e(a);return v<0&&(v=Vt(h+v,0)),fn(e,i,v)}function k0(e){var i=e==null?0:e.length;return i?Nr(e,0,-1):[]}var W0=Ke(function(e){var i=vt(e,Ko);return i.length&&i[0]===e[0]?Do(i):[]}),Y0=Ke(function(e){var i=jr(e),a=vt(e,Ko);return i===jr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Do(a,we(i,2)):[]}),J0=Ke(function(e){var i=jr(e),a=vt(e,Ko);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Do(a,r,i):[]});function X0(e,i){return e==null?"":kp.call(e,i)}function jr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Z0(e,i,a){var h=e==null?0:e.length;if(!h)return-1;var v=h;return a!==r&&(v=$e(a),v=v<0?Vt(h+v,0):Xt(v,h-1)),i===i?Rp(e,i,v):zs(e,Tu,v,!0)}function Q0(e,i){return e&&e.length?ah(e,$e(i)):r}var e_=Ke(Jh);function Jh(e,i){return e&&e.length&&i&&i.length?$o(e,i):e}function t_(e,i,a){return e&&e.length&&i&&i.length?$o(e,i,we(a,2)):e}function r_(e,i,a){return e&&e.length&&i&&i.length?$o(e,i,r,a):e}var i_=hi(function(e,i){var a=e==null?0:e.length,h=Co(e,i);return uh(e,vt(i,function(v){return li(v,a)?+v:v}).sort(mh)),h});function n_(e,i){var a=[];if(!(e&&e.length))return a;var h=-1,v=[],I=e.length;for(i=we(i,3);++h<I;){var R=e[h];i(R,h,e)&&(a.push(R),v.push(h))}return uh(e,v),a}function nc(e){return e==null?e:Xp.call(e)}function s_(e,i,a){var h=e==null?0:e.length;return h?(a&&typeof a!="number"&&nr(e,i,a)?(i=0,a=h):(i=i==null?0:$e(i),a=a===r?h:$e(a)),Nr(e,i,a)):[]}function a_(e,i){return oa(e,i)}function o_(e,i,a){return zo(e,i,we(a,2))}function c_(e,i){var a=e==null?0:e.length;if(a){var h=oa(e,i);if(h<a&&Hr(e[h],i))return h}return-1}function u_(e,i){return oa(e,i,!0)}function h_(e,i,a){return zo(e,i,we(a,2),!0)}function l_(e,i){var a=e==null?0:e.length;if(a){var h=oa(e,i,!0)-1;if(Hr(e[h],i))return h}return-1}function f_(e){return e&&e.length?lh(e):[]}function d_(e,i){return e&&e.length?lh(e,we(i,2)):[]}function p_(e){var i=e==null?0:e.length;return i?Nr(e,1,i):[]}function g_(e,i,a){return e&&e.length?(i=a||i===r?1:$e(i),Nr(e,0,i<0?0:i)):[]}function __(e,i,a){var h=e==null?0:e.length;return h?(i=a||i===r?1:$e(i),i=h-i,Nr(e,i<0?0:i,h)):[]}function y_(e,i){return e&&e.length?ca(e,we(i,3),!1,!0):[]}function v_(e,i){return e&&e.length?ca(e,we(i,3)):[]}var m_=Ke(function(e){return Oi(Yt(e,1,Nt,!0))}),b_=Ke(function(e){var i=jr(e);return Nt(i)&&(i=r),Oi(Yt(e,1,Nt,!0),we(i,2))}),w_=Ke(function(e){var i=jr(e);return i=typeof i=="function"?i:r,Oi(Yt(e,1,Nt,!0),r,i)});function E_(e){return e&&e.length?Oi(e):[]}function S_(e,i){return e&&e.length?Oi(e,we(i,2)):[]}function I_(e,i){return i=typeof i=="function"?i:r,e&&e.length?Oi(e,r,i):[]}function sc(e){if(!(e&&e.length))return[];var i=0;return e=bi(e,function(a){if(Nt(a))return i=Vt(a.length,i),!0}),Eo(i,function(a){return vt(e,mo(a))})}function Xh(e,i){if(!(e&&e.length))return[];var a=sc(e);return i==null?a:vt(a,function(h){return Gt(i,r,h)})}var O_=Ke(function(e,i){return Nt(e)?Gn(e,i):[]}),x_=Ke(function(e){return Bo(bi(e,Nt))}),P_=Ke(function(e){var i=jr(e);return Nt(i)&&(i=r),Bo(bi(e,Nt),we(i,2))}),A_=Ke(function(e){var i=jr(e);return i=typeof i=="function"?i:r,Bo(bi(e,Nt),r,i)}),T_=Ke(sc);function C_(e,i){return gh(e||[],i||[],Vn)}function R_(e,i){return gh(e||[],i||[],Yn)}var N_=Ke(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Xh(e,a)});function Zh(e){var i=S(e);return i.__chain__=!0,i}function j_(e,i){return i(e),e}function ya(e,i){return i(e)}var D_=hi(function(e){var i=e.length,a=i?e[0]:0,h=this.__wrapped__,v=function(I){return Co(I,e)};return i>1||this.__actions__.length||!(h instanceof Ye)||!li(a)?this.thru(v):(h=h.slice(a,+a+(i?1:0)),h.__actions__.push({func:ya,args:[v],thisArg:r}),new Cr(h,this.__chain__).thru(function(I){return i&&!I.length&&I.push(r),I}))});function F_(){return Zh(this)}function U_(){return new Cr(this.value(),this.__chain__)}function L_(){this.__values__===r&&(this.__values__=fl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function $_(){return this}function M_(e){for(var i,a=this;a instanceof ra;){var h=Vh(a);h.__index__=0,h.__values__=r,i?v.__wrapped__=h:i=h;var v=h;a=a.__wrapped__}return v.__wrapped__=e,i}function q_(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ya,args:[nc],thisArg:r}),new Cr(i,this.__chain__)}return this.thru(nc)}function z_(){return ph(this.__wrapped__,this.__actions__)}var H_=ua(function(e,i,a){nt.call(e,a)?++e[a]:ci(e,a,1)});function B_(e,i,a){var h=Ne(e)?Pu:jg;return a&&nr(e,i,a)&&(i=r),h(e,we(i,3))}function K_(e,i){var a=Ne(e)?bi:Xu;return a(e,we(i,3))}var V_=Oh(Gh),G_=Oh(kh);function k_(e,i){return Yt(va(e,i),1)}function W_(e,i){return Yt(va(e,i),F)}function Y_(e,i,a){return a=a===r?1:$e(a),Yt(va(e,i),a)}function Qh(e,i){var a=Ne(e)?Ar:Ii;return a(e,we(i,3))}function el(e,i){var a=Ne(e)?pp:Ju;return a(e,we(i,3))}var J_=ua(function(e,i,a){nt.call(e,a)?e[a].push(i):ci(e,a,[i])});function X_(e,i,a,h){e=pr(e)?e:In(e),a=a&&!h?$e(a):0;var v=e.length;return a<0&&(a=Vt(v+a,0)),Sa(e)?a<=v&&e.indexOf(i,a)>-1:!!v&&fn(e,i,a)>-1}var Z_=Ke(function(e,i,a){var h=-1,v=typeof i=="function",I=pr(e)?ee(e.length):[];return Ii(e,function(R){I[++h]=v?Gt(i,R,a):kn(R,i,a)}),I}),Q_=ua(function(e,i,a){ci(e,a,i)});function va(e,i){var a=Ne(e)?vt:ih;return a(e,we(i,3))}function ey(e,i,a,h){return e==null?[]:(Ne(i)||(i=i==null?[]:[i]),a=h?r:a,Ne(a)||(a=a==null?[]:[a]),oh(e,i,a))}var ty=ua(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function ry(e,i,a){var h=Ne(e)?yo:Ru,v=arguments.length<3;return h(e,we(i,4),a,v,Ii)}function iy(e,i,a){var h=Ne(e)?gp:Ru,v=arguments.length<3;return h(e,we(i,4),a,v,Ju)}function ny(e,i){var a=Ne(e)?bi:Xu;return a(e,wa(we(i,3)))}function sy(e){var i=Ne(e)?Gu:Xg;return i(e)}function ay(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=$e(i);var h=Ne(e)?Ag:Zg;return h(e,i)}function oy(e){var i=Ne(e)?Tg:e0;return i(e)}function cy(e){if(e==null)return 0;if(pr(e))return Sa(e)?pn(e):e.length;var i=Zt(e);return i==Oe||i==xe?e.size:Uo(e).length}function uy(e,i,a){var h=Ne(e)?vo:t0;return a&&nr(e,i,a)&&(i=r),h(e,we(i,3))}var hy=Ke(function(e,i){if(e==null)return[];var a=i.length;return a>1&&nr(e,i[0],i[1])?i=[]:a>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),oh(e,Yt(i,1),[])}),ma=Kp||function(){return Xe.Date.now()};function ly(e,i){if(typeof i!="function")throw new Tr(b);return e=$e(e),function(){if(--e<1)return i.apply(this,arguments)}}function tl(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,ui(e,u,r,r,r,r,i)}function rl(e,i){var a;if(typeof i!="function")throw new Tr(b);return e=$e(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var ac=Ke(function(e,i,a){var h=Q;if(a.length){var v=Ei(a,En(ac));h|=j}return ui(e,h,i,a,v)}),il=Ke(function(e,i,a){var h=Q|ue;if(a.length){var v=Ei(a,En(il));h|=j}return ui(i,h,e,a,v)});function nl(e,i,a){i=a?r:i;var h=ui(e,B,r,r,r,r,r,i);return h.placeholder=nl.placeholder,h}function sl(e,i,a){i=a?r:i;var h=ui(e,N,r,r,r,r,r,i);return h.placeholder=sl.placeholder,h}function al(e,i,a){var h,v,I,R,U,G,se=0,ae=!1,ce=!1,fe=!0;if(typeof e!="function")throw new Tr(b);i=Dr(i)||0,bt(a)&&(ae=!!a.leading,ce="maxWait"in a,I=ce?Vt(Dr(a.maxWait)||0,i):I,fe="trailing"in a?!!a.trailing:fe);function ve(jt){var Br=h,pi=v;return h=v=r,se=jt,R=e.apply(pi,Br),R}function Ee(jt){return se=jt,U=Zn(ke,i),ae?ve(jt):R}function ze(jt){var Br=jt-G,pi=jt-se,Ol=i-Br;return ce?Xt(Ol,I-pi):Ol}function Se(jt){var Br=jt-G,pi=jt-se;return G===r||Br>=i||Br<0||ce&&pi>=I}function ke(){var jt=ma();if(Se(jt))return Ze(jt);U=Zn(ke,ze(jt))}function Ze(jt){return U=r,fe&&h?ve(jt):(h=v=r,R)}function Sr(){U!==r&&_h(U),se=0,h=G=v=U=r}function sr(){return U===r?R:Ze(ma())}function Ir(){var jt=ma(),Br=Se(jt);if(h=arguments,v=this,G=jt,Br){if(U===r)return Ee(G);if(ce)return _h(U),U=Zn(ke,i),ve(G)}return U===r&&(U=Zn(ke,i)),R}return Ir.cancel=Sr,Ir.flush=sr,Ir}var fy=Ke(function(e,i){return Yu(e,1,i)}),dy=Ke(function(e,i,a){return Yu(e,Dr(i)||0,a)});function py(e){return ui(e,X)}function ba(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Tr(b);var a=function(){var h=arguments,v=i?i.apply(this,h):h[0],I=a.cache;if(I.has(v))return I.get(v);var R=e.apply(this,h);return a.cache=I.set(v,R)||I,R};return a.cache=new(ba.Cache||oi),a}ba.Cache=oi;function wa(e){if(typeof e!="function")throw new Tr(b);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function gy(e){return rl(2,e)}var _y=r0(function(e,i){i=i.length==1&&Ne(i[0])?vt(i[0],br(we())):vt(Yt(i,1),br(we()));var a=i.length;return Ke(function(h){for(var v=-1,I=Xt(h.length,a);++v<I;)h[v]=i[v].call(this,h[v]);return Gt(e,this,h)})}),oc=Ke(function(e,i){var a=Ei(i,En(oc));return ui(e,j,r,i,a)}),ol=Ke(function(e,i){var a=Ei(i,En(ol));return ui(e,O,r,i,a)}),yy=hi(function(e,i){return ui(e,y,r,r,r,i)});function vy(e,i){if(typeof e!="function")throw new Tr(b);return i=i===r?i:$e(i),Ke(e,i)}function my(e,i){if(typeof e!="function")throw new Tr(b);return i=i==null?0:Vt($e(i),0),Ke(function(a){var h=a[i],v=Pi(a,0,i);return h&&wi(v,h),Gt(e,this,v)})}function by(e,i,a){var h=!0,v=!0;if(typeof e!="function")throw new Tr(b);return bt(a)&&(h="leading"in a?!!a.leading:h,v="trailing"in a?!!a.trailing:v),al(e,i,{leading:h,maxWait:i,trailing:v})}function wy(e){return tl(e,1)}function Ey(e,i){return oc(Vo(i),e)}function Sy(){if(!arguments.length)return[];var e=arguments[0];return Ne(e)?e:[e]}function Iy(e){return Rr(e,M)}function Oy(e,i){return i=typeof i=="function"?i:r,Rr(e,M,i)}function xy(e){return Rr(e,$|M)}function Py(e,i){return i=typeof i=="function"?i:r,Rr(e,$|M,i)}function Ay(e,i){return i==null||Wu(e,i,kt(i))}function Hr(e,i){return e===i||e!==e&&i!==i}var Ty=da(jo),Cy=da(function(e,i){return e>=i}),ki=eh(function(){return arguments}())?eh:function(e){return At(e)&&nt.call(e,"callee")&&!qu.call(e,"callee")},Ne=ee.isArray,Ry=rr?br(rr):Mg;function pr(e){return e!=null&&Ea(e.length)&&!fi(e)}function Nt(e){return At(e)&&pr(e)}function Ny(e){return e===!0||e===!1||At(e)&&ir(e)==Y}var Ai=Gp||vc,jy=Mr?br(Mr):qg;function Dy(e){return At(e)&&e.nodeType===1&&!Qn(e)}function Fy(e){if(e==null)return!0;if(pr(e)&&(Ne(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||Sn(e)||ki(e)))return!e.length;var i=Zt(e);if(i==Oe||i==xe)return!e.size;if(Xn(e))return!Uo(e).length;for(var a in e)if(nt.call(e,a))return!1;return!0}function Uy(e,i){return Wn(e,i)}function Ly(e,i,a){a=typeof a=="function"?a:r;var h=a?a(e,i):r;return h===r?Wn(e,i,r,a):!!h}function cc(e){if(!At(e))return!1;var i=ir(e);return i==D||i==l||typeof e.message=="string"&&typeof e.name=="string"&&!Qn(e)}function $y(e){return typeof e=="number"&&Hu(e)}function fi(e){if(!bt(e))return!1;var i=ir(e);return i==he||i==pe||i==J||i==gt}function cl(e){return typeof e=="number"&&e==$e(e)}function Ea(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function bt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function At(e){return e!=null&&typeof e=="object"}var ul=Pr?br(Pr):Hg;function My(e,i){return e===i||Fo(e,i,Zo(i))}function qy(e,i,a){return a=typeof a=="function"?a:r,Fo(e,i,Zo(i),a)}function zy(e){return hl(e)&&e!=+e}function Hy(e){if(O0(e))throw new Ce(g);return th(e)}function By(e){return e===null}function Ky(e){return e==null}function hl(e){return typeof e=="number"||At(e)&&ir(e)==He}function Qn(e){if(!At(e)||ir(e)!=Le)return!1;var i=Ys(e);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Vs.call(a)==qp}var uc=Yr?br(Yr):Bg;function Vy(e){return cl(e)&&e>=-W&&e<=W}var ll=$n?br($n):Kg;function Sa(e){return typeof e=="string"||!Ne(e)&&At(e)&&ir(e)==je}function Er(e){return typeof e=="symbol"||At(e)&&ir(e)==De}var Sn=Mi?br(Mi):Vg;function Gy(e){return e===r}function ky(e){return At(e)&&Zt(e)==Ae}function Wy(e){return At(e)&&ir(e)==Fe}var Yy=da(Lo),Jy=da(function(e,i){return e<=i});function fl(e){if(!e)return[];if(pr(e))return Sa(e)?qr(e):dr(e);if(qn&&e[qn])return Ap(e[qn]());var i=Zt(e),a=i==Oe?Io:i==xe?Hs:In;return a(e)}function di(e){if(!e)return e===0?e:0;if(e=Dr(e),e===F||e===-F){var i=e<0?-1:1;return i*x}return e===e?e:0}function $e(e){var i=di(e),a=i%1;return i===i?a?i-a:i:0}function dl(e){return e?Bi($e(e),0,te):0}function Dr(e){if(typeof e=="number")return e;if(Er(e))return q;if(bt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=bt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Nu(e);var a=Za.test(e);return a||eo.test(e)?Re(e.slice(2),a?2:8):Xa.test(e)?q:+e}function pl(e){return Xr(e,gr(e))}function Xy(e){return e?Bi($e(e),-W,W):e===0?e:0}function it(e){return e==null?"":wr(e)}var Zy=bn(function(e,i){if(Xn(i)||pr(i)){Xr(i,kt(i),e);return}for(var a in i)nt.call(i,a)&&Vn(e,a,i[a])}),gl=bn(function(e,i){Xr(i,gr(i),e)}),Ia=bn(function(e,i,a,h){Xr(i,gr(i),e,h)}),Qy=bn(function(e,i,a,h){Xr(i,kt(i),e,h)}),ev=hi(Co);function tv(e,i){var a=mn(e);return i==null?a:ku(a,i)}var rv=Ke(function(e,i){e=ut(e);var a=-1,h=i.length,v=h>2?i[2]:r;for(v&&nr(i[0],i[1],v)&&(h=1);++a<h;)for(var I=i[a],R=gr(I),U=-1,G=R.length;++U<G;){var se=R[U],ae=e[se];(ae===r||Hr(ae,_n[se])&&!nt.call(e,se))&&(e[se]=I[se])}return e}),iv=Ke(function(e){return e.push(r,Nh),Gt(_l,r,e)});function nv(e,i){return Au(e,we(i,3),Jr)}function sv(e,i){return Au(e,we(i,3),No)}function av(e,i){return e==null?e:Ro(e,we(i,3),gr)}function ov(e,i){return e==null?e:Zu(e,we(i,3),gr)}function cv(e,i){return e&&Jr(e,we(i,3))}function uv(e,i){return e&&No(e,we(i,3))}function hv(e){return e==null?[]:sa(e,kt(e))}function lv(e){return e==null?[]:sa(e,gr(e))}function hc(e,i,a){var h=e==null?r:Ki(e,i);return h===r?a:h}function fv(e,i){return e!=null&&Fh(e,i,Fg)}function lc(e,i){return e!=null&&Fh(e,i,Ug)}var dv=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Gs.call(i)),e[i]=a},dc(_r)),pv=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Gs.call(i)),nt.call(e,i)?e[i].push(a):e[i]=[a]},we),gv=Ke(kn);function kt(e){return pr(e)?Vu(e):Uo(e)}function gr(e){return pr(e)?Vu(e,!0):Gg(e)}function _v(e,i){var a={};return i=we(i,3),Jr(e,function(h,v,I){ci(a,i(h,v,I),h)}),a}function yv(e,i){var a={};return i=we(i,3),Jr(e,function(h,v,I){ci(a,v,i(h,v,I))}),a}var vv=bn(function(e,i,a){aa(e,i,a)}),_l=bn(function(e,i,a,h){aa(e,i,a,h)}),mv=hi(function(e,i){var a={};if(e==null)return a;var h=!1;i=vt(i,function(I){return I=xi(I,e),h||(h=I.length>1),I}),Xr(e,Jo(e),a),h&&(a=Rr(a,$|k|M,d0));for(var v=i.length;v--;)Ho(a,i[v]);return a});function bv(e,i){return yl(e,wa(we(i)))}var wv=hi(function(e,i){return e==null?{}:Wg(e,i)});function yl(e,i){if(e==null)return{};var a=vt(Jo(e),function(h){return[h]});return i=we(i),ch(e,a,function(h,v){return i(h,v[0])})}function Ev(e,i,a){i=xi(i,e);var h=-1,v=i.length;for(v||(v=1,e=r);++h<v;){var I=e==null?r:e[Zr(i[h])];I===r&&(h=v,I=a),e=fi(I)?I.call(e):I}return e}function Sv(e,i,a){return e==null?e:Yn(e,i,a)}function Iv(e,i,a,h){return h=typeof h=="function"?h:r,e==null?e:Yn(e,i,a,h)}var vl=Ch(kt),ml=Ch(gr);function Ov(e,i,a){var h=Ne(e),v=h||Ai(e)||Sn(e);if(i=we(i,4),a==null){var I=e&&e.constructor;v?a=h?new I:[]:bt(e)?a=fi(I)?mn(Ys(e)):{}:a={}}return(v?Ar:Jr)(e,function(R,U,G){return i(a,R,U,G)}),a}function xv(e,i){return e==null?!0:Ho(e,i)}function Pv(e,i,a){return e==null?e:dh(e,i,Vo(a))}function Av(e,i,a,h){return h=typeof h=="function"?h:r,e==null?e:dh(e,i,Vo(a),h)}function In(e){return e==null?[]:So(e,kt(e))}function Tv(e){return e==null?[]:So(e,gr(e))}function Cv(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Dr(a),a=a===a?a:0),i!==r&&(i=Dr(i),i=i===i?i:0),Bi(Dr(e),i,a)}function Rv(e,i,a){return i=di(i),a===r?(a=i,i=0):a=di(a),e=Dr(e),Lg(e,i,a)}function Nv(e,i,a){if(a&&typeof a!="boolean"&&nr(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=di(e),i===r?(i=e,e=0):i=di(i)),e>i){var h=e;e=i,i=h}if(a||e%1||i%1){var v=Bu();return Xt(e+v*(i-e+ot("1e-"+((v+"").length-1))),i)}return Mo(e,i)}var jv=wn(function(e,i,a){return i=i.toLowerCase(),e+(a?bl(i):i)});function bl(e){return fc(it(e).toLowerCase())}function wl(e){return e=it(e),e&&e.replace(ni,Sp).replace(po,"")}function Dv(e,i,a){e=it(e),i=wr(i);var h=e.length;a=a===r?h:Bi($e(a),0,h);var v=a;return a-=i.length,a>=0&&e.slice(a,v)==i}function Fv(e){return e=it(e),e&&_t.test(e)?e.replace(Di,Ip):e}function Uv(e){return e=it(e),e&&$t.test(e)?e.replace(Ot,"\\$&"):e}var Lv=wn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),$v=wn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),Mv=Ih("toLowerCase");function qv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;if(!i||h>=i)return e;var v=(i-h)/2;return fa(Qs(v),a)+e+fa(Zs(v),a)}function zv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;return i&&h<i?e+fa(i-h,a):e}function Hv(e,i,a){e=it(e),i=$e(i);var h=i?pn(e):0;return i&&h<i?fa(i-h,a)+e:e}function Bv(e,i,a){return a||i==null?i=0:i&&(i=+i),Jp(it(e).replace(xt,""),i||0)}function Kv(e,i,a){return(a?nr(e,i,a):i===r)?i=1:i=$e(i),qo(it(e),i)}function Vv(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Gv=wn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function kv(e,i,a){return a&&typeof a!="number"&&nr(e,i,a)&&(i=a=r),a=a===r?te:a>>>0,a?(e=it(e),e&&(typeof i=="string"||i!=null&&!uc(i))&&(i=wr(i),!i&&dn(e))?Pi(qr(e),0,a):e.split(i,a)):[]}var Wv=wn(function(e,i,a){return e+(a?" ":"")+fc(i)});function Yv(e,i,a){return e=it(e),a=a==null?0:Bi($e(a),0,e.length),i=wr(i),e.slice(a,a+i.length)==i}function Jv(e,i,a){var h=S.templateSettings;a&&nr(e,i,a)&&(i=r),e=it(e),i=Ia({},i,h,Rh);var v=Ia({},i.imports,h.imports,Rh),I=kt(v),R=So(v,I),U,G,se=0,ae=i.interpolate||sn,ce="__p += '",fe=Oo((i.escape||sn).source+"|"+ae.source+"|"+(ae===mt?Ja:sn).source+"|"+(i.evaluate||sn).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++go+"]")+`
`;e.replace(fe,function(Se,ke,Ze,Sr,sr,Ir){return Ze||(Ze=Sr),ce+=e.slice(se,Ir).replace(ro,Op),ke&&(U=!0,ce+=`' +
__e(`+ke+`) +
'`),sr&&(G=!0,ce+=`';
`+sr+`;
__p += '`),Ze&&(ce+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),se=Ir+Se.length,Se}),ce+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ce=`with (obj) {
`+ce+`
}
`;else if(Wa.test(Ee))throw new Ce(m);ce=(G?ce.replace(kr,""):ce).replace(tr,"$1").replace(ii,"$1;"),ce="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(U?", __e = _.escape":"")+(G?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ce+`return __p
}`;var ze=Sl(function(){return rt(I,ve+"return "+ce).apply(r,R)});if(ze.source=ce,cc(ze))throw ze;return ze}function Xv(e){return it(e).toLowerCase()}function Zv(e){return it(e).toUpperCase()}function Qv(e,i,a){if(e=it(e),e&&(a||i===r))return Nu(e);if(!e||!(i=wr(i)))return e;var h=qr(e),v=qr(i),I=ju(h,v),R=Du(h,v)+1;return Pi(h,I,R).join("")}function e1(e,i,a){if(e=it(e),e&&(a||i===r))return e.slice(0,Uu(e)+1);if(!e||!(i=wr(i)))return e;var h=qr(e),v=Du(h,qr(i))+1;return Pi(h,0,v).join("")}function t1(e,i,a){if(e=it(e),e&&(a||i===r))return e.replace(xt,"");if(!e||!(i=wr(i)))return e;var h=qr(e),v=ju(h,qr(i));return Pi(h,v).join("")}function r1(e,i){var a=c,h=f;if(bt(i)){var v="separator"in i?i.separator:v;a="length"in i?$e(i.length):a,h="omission"in i?wr(i.omission):h}e=it(e);var I=e.length;if(dn(e)){var R=qr(e);I=R.length}if(a>=I)return e;var U=a-pn(h);if(U<1)return h;var G=R?Pi(R,0,U).join(""):e.slice(0,U);if(v===r)return G+h;if(R&&(U+=G.length-U),uc(v)){if(e.slice(U).search(v)){var se,ae=G;for(v.global||(v=Oo(v.source,it(xr.exec(v))+"g")),v.lastIndex=0;se=v.exec(ae);)var ce=se.index;G=G.slice(0,ce===r?U:ce)}}else if(e.indexOf(wr(v),U)!=U){var fe=G.lastIndexOf(v);fe>-1&&(G=G.slice(0,fe))}return G+h}function i1(e){return e=it(e),e&&Et.test(e)?e.replace(vi,Np):e}var n1=wn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),fc=Ih("toUpperCase");function El(e,i,a){return e=it(e),i=a?r:i,i===r?Pp(e)?Fp(e):vp(e):e.match(i)||[]}var Sl=Ke(function(e,i){try{return Gt(e,r,i)}catch(a){return cc(a)?a:new Ce(a)}}),s1=hi(function(e,i){return Ar(i,function(a){a=Zr(a),ci(e,a,ac(e[a],e))}),e});function a1(e){var i=e==null?0:e.length,a=we();return e=i?vt(e,function(h){if(typeof h[1]!="function")throw new Tr(b);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var v=-1;++v<i;){var I=e[v];if(Gt(I[0],this,h))return Gt(I[1],this,h)}})}function o1(e){return Ng(Rr(e,$))}function dc(e){return function(){return e}}function c1(e,i){return e==null||e!==e?i:e}var u1=xh(),h1=xh(!0);function _r(e){return e}function pc(e){return rh(typeof e=="function"?e:Rr(e,$))}function l1(e){return nh(Rr(e,$))}function f1(e,i){return sh(e,Rr(i,$))}var d1=Ke(function(e,i){return function(a){return kn(a,e,i)}}),p1=Ke(function(e,i){return function(a){return kn(e,a,i)}});function gc(e,i,a){var h=kt(i),v=sa(i,h);a==null&&!(bt(i)&&(v.length||!h.length))&&(a=i,i=e,e=this,v=sa(i,kt(i)));var I=!(bt(a)&&"chain"in a)||!!a.chain,R=fi(e);return Ar(v,function(U){var G=i[U];e[U]=G,R&&(e.prototype[U]=function(){var se=this.__chain__;if(I||se){var ae=e(this.__wrapped__),ce=ae.__actions__=dr(this.__actions__);return ce.push({func:G,args:arguments,thisArg:e}),ae.__chain__=se,ae}return G.apply(e,wi([this.value()],arguments))})}),e}function g1(){return Xe._===this&&(Xe._=zp),this}function _c(){}function _1(e){return e=$e(e),Ke(function(i){return ah(i,e)})}var y1=ko(vt),v1=ko(Pu),m1=ko(vo);function Il(e){return ec(e)?mo(Zr(e)):Yg(e)}function b1(e){return function(i){return e==null?r:Ki(e,i)}}var w1=Ah(),E1=Ah(!0);function yc(){return[]}function vc(){return!1}function S1(){return{}}function I1(){return""}function O1(){return!0}function x1(e,i){if(e=$e(e),e<1||e>W)return[];var a=te,h=Xt(e,te);i=we(i),e-=te;for(var v=Eo(h,i);++a<e;)i(a);return v}function P1(e){return Ne(e)?vt(e,Zr):Er(e)?[e]:dr(Kh(it(e)))}function A1(e){var i=++Mp;return it(e)+i}var T1=la(function(e,i){return e+i},0),C1=Wo("ceil"),R1=la(function(e,i){return e/i},1),N1=Wo("floor");function j1(e){return e&&e.length?na(e,_r,jo):r}function D1(e,i){return e&&e.length?na(e,we(i,2),jo):r}function F1(e){return Cu(e,_r)}function U1(e,i){return Cu(e,we(i,2))}function L1(e){return e&&e.length?na(e,_r,Lo):r}function $1(e,i){return e&&e.length?na(e,we(i,2),Lo):r}var M1=la(function(e,i){return e*i},1),q1=Wo("round"),z1=la(function(e,i){return e-i},0);function H1(e){return e&&e.length?wo(e,_r):0}function B1(e,i){return e&&e.length?wo(e,we(i,2)):0}return S.after=ly,S.ary=tl,S.assign=Zy,S.assignIn=gl,S.assignInWith=Ia,S.assignWith=Qy,S.at=ev,S.before=rl,S.bind=ac,S.bindAll=s1,S.bindKey=il,S.castArray=Sy,S.chain=Zh,S.chunk=N0,S.compact=j0,S.concat=D0,S.cond=a1,S.conforms=o1,S.constant=dc,S.countBy=H_,S.create=tv,S.curry=nl,S.curryRight=sl,S.debounce=al,S.defaults=rv,S.defaultsDeep=iv,S.defer=fy,S.delay=dy,S.difference=F0,S.differenceBy=U0,S.differenceWith=L0,S.drop=$0,S.dropRight=M0,S.dropRightWhile=q0,S.dropWhile=z0,S.fill=H0,S.filter=K_,S.flatMap=k_,S.flatMapDeep=W_,S.flatMapDepth=Y_,S.flatten=Wh,S.flattenDeep=B0,S.flattenDepth=K0,S.flip=py,S.flow=u1,S.flowRight=h1,S.fromPairs=V0,S.functions=hv,S.functionsIn=lv,S.groupBy=J_,S.initial=k0,S.intersection=W0,S.intersectionBy=Y0,S.intersectionWith=J0,S.invert=dv,S.invertBy=pv,S.invokeMap=Z_,S.iteratee=pc,S.keyBy=Q_,S.keys=kt,S.keysIn=gr,S.map=va,S.mapKeys=_v,S.mapValues=yv,S.matches=l1,S.matchesProperty=f1,S.memoize=ba,S.merge=vv,S.mergeWith=_l,S.method=d1,S.methodOf=p1,S.mixin=gc,S.negate=wa,S.nthArg=_1,S.omit=mv,S.omitBy=bv,S.once=gy,S.orderBy=ey,S.over=y1,S.overArgs=_y,S.overEvery=v1,S.overSome=m1,S.partial=oc,S.partialRight=ol,S.partition=ty,S.pick=wv,S.pickBy=yl,S.property=Il,S.propertyOf=b1,S.pull=e_,S.pullAll=Jh,S.pullAllBy=t_,S.pullAllWith=r_,S.pullAt=i_,S.range=w1,S.rangeRight=E1,S.rearg=yy,S.reject=ny,S.remove=n_,S.rest=vy,S.reverse=nc,S.sampleSize=ay,S.set=Sv,S.setWith=Iv,S.shuffle=oy,S.slice=s_,S.sortBy=hy,S.sortedUniq=f_,S.sortedUniqBy=d_,S.split=kv,S.spread=my,S.tail=p_,S.take=g_,S.takeRight=__,S.takeRightWhile=y_,S.takeWhile=v_,S.tap=j_,S.throttle=by,S.thru=ya,S.toArray=fl,S.toPairs=vl,S.toPairsIn=ml,S.toPath=P1,S.toPlainObject=pl,S.transform=Ov,S.unary=wy,S.union=m_,S.unionBy=b_,S.unionWith=w_,S.uniq=E_,S.uniqBy=S_,S.uniqWith=I_,S.unset=xv,S.unzip=sc,S.unzipWith=Xh,S.update=Pv,S.updateWith=Av,S.values=In,S.valuesIn=Tv,S.without=O_,S.words=El,S.wrap=Ey,S.xor=x_,S.xorBy=P_,S.xorWith=A_,S.zip=T_,S.zipObject=C_,S.zipObjectDeep=R_,S.zipWith=N_,S.entries=vl,S.entriesIn=ml,S.extend=gl,S.extendWith=Ia,gc(S,S),S.add=T1,S.attempt=Sl,S.camelCase=jv,S.capitalize=bl,S.ceil=C1,S.clamp=Cv,S.clone=Iy,S.cloneDeep=xy,S.cloneDeepWith=Py,S.cloneWith=Oy,S.conformsTo=Ay,S.deburr=wl,S.defaultTo=c1,S.divide=R1,S.endsWith=Dv,S.eq=Hr,S.escape=Fv,S.escapeRegExp=Uv,S.every=B_,S.find=V_,S.findIndex=Gh,S.findKey=nv,S.findLast=G_,S.findLastIndex=kh,S.findLastKey=sv,S.floor=N1,S.forEach=Qh,S.forEachRight=el,S.forIn=av,S.forInRight=ov,S.forOwn=cv,S.forOwnRight=uv,S.get=hc,S.gt=Ty,S.gte=Cy,S.has=fv,S.hasIn=lc,S.head=Yh,S.identity=_r,S.includes=X_,S.indexOf=G0,S.inRange=Rv,S.invoke=gv,S.isArguments=ki,S.isArray=Ne,S.isArrayBuffer=Ry,S.isArrayLike=pr,S.isArrayLikeObject=Nt,S.isBoolean=Ny,S.isBuffer=Ai,S.isDate=jy,S.isElement=Dy,S.isEmpty=Fy,S.isEqual=Uy,S.isEqualWith=Ly,S.isError=cc,S.isFinite=$y,S.isFunction=fi,S.isInteger=cl,S.isLength=Ea,S.isMap=ul,S.isMatch=My,S.isMatchWith=qy,S.isNaN=zy,S.isNative=Hy,S.isNil=Ky,S.isNull=By,S.isNumber=hl,S.isObject=bt,S.isObjectLike=At,S.isPlainObject=Qn,S.isRegExp=uc,S.isSafeInteger=Vy,S.isSet=ll,S.isString=Sa,S.isSymbol=Er,S.isTypedArray=Sn,S.isUndefined=Gy,S.isWeakMap=ky,S.isWeakSet=Wy,S.join=X0,S.kebabCase=Lv,S.last=jr,S.lastIndexOf=Z0,S.lowerCase=$v,S.lowerFirst=Mv,S.lt=Yy,S.lte=Jy,S.max=j1,S.maxBy=D1,S.mean=F1,S.meanBy=U1,S.min=L1,S.minBy=$1,S.stubArray=yc,S.stubFalse=vc,S.stubObject=S1,S.stubString=I1,S.stubTrue=O1,S.multiply=M1,S.nth=Q0,S.noConflict=g1,S.noop=_c,S.now=ma,S.pad=qv,S.padEnd=zv,S.padStart=Hv,S.parseInt=Bv,S.random=Nv,S.reduce=ry,S.reduceRight=iy,S.repeat=Kv,S.replace=Vv,S.result=Ev,S.round=q1,S.runInContext=V,S.sample=sy,S.size=cy,S.snakeCase=Gv,S.some=uy,S.sortedIndex=a_,S.sortedIndexBy=o_,S.sortedIndexOf=c_,S.sortedLastIndex=u_,S.sortedLastIndexBy=h_,S.sortedLastIndexOf=l_,S.startCase=Wv,S.startsWith=Yv,S.subtract=z1,S.sum=H1,S.sumBy=B1,S.template=Jv,S.times=x1,S.toFinite=di,S.toInteger=$e,S.toLength=dl,S.toLower=Xv,S.toNumber=Dr,S.toSafeInteger=Xy,S.toString=it,S.toUpper=Zv,S.trim=Qv,S.trimEnd=e1,S.trimStart=t1,S.truncate=r1,S.unescape=i1,S.uniqueId=A1,S.upperCase=n1,S.upperFirst=fc,S.each=Qh,S.eachRight=el,S.first=Yh,gc(S,function(){var e={};return Jr(S,function(i,a){nt.call(S.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),S.VERSION=s,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){S[e].placeholder=S}),Ar(["drop","take"],function(e,i){Ye.prototype[e]=function(a){a=a===r?1:Vt($e(a),0);var h=this.__filtered__&&!i?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Xt(a,h.__takeCount__):h.__views__.push({size:Xt(a,te),type:e+(h.__dir__<0?"Right":"")}),h},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Ar(["filter","map","takeWhile"],function(e,i){var a=i+1,h=a==_||a==T;Ye.prototype[e]=function(v){var I=this.clone();return I.__iteratees__.push({iteratee:we(v,3),type:a}),I.__filtered__=I.__filtered__||h,I}}),Ar(["head","last"],function(e,i){var a="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),Ar(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(_r)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(a){return kn(a,e,i)})}),Ye.prototype.reject=function(e){return this.filter(wa(we(e)))},Ye.prototype.slice=function(e,i){e=$e(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=$e(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(te)},Jr(Ye.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),h=/^(?:head|last)$/.test(i),v=S[h?"take"+(i=="last"?"Right":""):i],I=h||/^find/.test(i);v&&(S.prototype[i]=function(){var R=this.__wrapped__,U=h?[1]:arguments,G=R instanceof Ye,se=U[0],ae=G||Ne(R),ce=function(ke){var Ze=v.apply(S,wi([ke],U));return h&&fe?Ze[0]:Ze};ae&&a&&typeof se=="function"&&se.length!=1&&(G=ae=!1);var fe=this.__chain__,ve=!!this.__actions__.length,Ee=I&&!fe,ze=G&&!ve;if(!I&&ae){R=ze?R:new Ye(this);var Se=e.apply(R,U);return Se.__actions__.push({func:ya,args:[ce],thisArg:r}),new Cr(Se,fe)}return Ee&&ze?e.apply(this,U):(Se=this.thru(ce),Ee?h?Se.value()[0]:Se.value():Se)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(e){var i=Bs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",h=/^(?:pop|shift)$/.test(e);S.prototype[e]=function(){var v=arguments;if(h&&!this.__chain__){var I=this.value();return i.apply(Ne(I)?I:[],v)}return this[a](function(R){return i.apply(Ne(R)?R:[],v)})}}),Jr(Ye.prototype,function(e,i){var a=S[i];if(a){var h=a.name+"";nt.call(vn,h)||(vn[h]=[]),vn[h].push({name:i,func:a})}}),vn[ha(r,ue).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=ig,Ye.prototype.reverse=ng,Ye.prototype.value=sg,S.prototype.at=D_,S.prototype.chain=F_,S.prototype.commit=U_,S.prototype.next=L_,S.prototype.plant=M_,S.prototype.reverse=q_,S.prototype.toJSON=S.prototype.valueOf=S.prototype.value=z_,S.prototype.first=S.prototype.head,qn&&(S.prototype[qn]=$_),S},gn=Up();Rt?((Rt.exports=gn)._=gn,ct._=gn):Xe._=gn}).call(ls)})(Qc,Qc.exports);var b2=Object.defineProperty,w2=Object.defineProperties,E2=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,S2=Object.prototype.hasOwnProperty,I2=Object.prototype.propertyIsEnumerable,Yf=(n,t,r)=>t in n?b2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,xa=(n,t)=>{for(var r in t||(t={}))S2.call(t,r)&&Yf(n,r,t[r]);if(Wf)for(var r of Wf(t))I2.call(t,r)&&Yf(n,r,t[r]);return n},O2=(n,t)=>w2(n,E2(t));function Lr(n,t,r){let s;const o=eu(n);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${m2}?chainId=eip155:${o}&projectId=${r}`),s}function eu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function x2(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function P2(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const g=t.namespaces[o].accounts;s.push(...g)}),s}function A2(n,t={}){const r=Jf(n),s=Jf(t);return Qc.exports.merge(r,s)}function Jf(n){var t,r,s,o;const g={};if(!Cn(n))return g;for(const[b,m]of Object.entries(n)){const E=Ld(b)?[b]:m.chains,A=m.methods||[],C=m.events||[],$=m.rpcMap||{},k=Ta(b);g[k]=O2(xa(xa({},g[k]),m),{chains:Ac(E,(t=g[k])==null?void 0:t.chains),methods:Ac(A,(r=g[k])==null?void 0:r.methods),events:Ac(C,(s=g[k])==null?void 0:s.events),rpcMap:xa(xa({},$),(o=g[k])==null?void 0:o.rpcMap)})}return g}function T2(n){return n.includes(":")?n.split(":")[2]:n}const fp={},Ft=n=>fp[n],Fc=(n,t)=>{fp[n]=t};class C2{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Lr(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Lr(t,this.namespace);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class R2{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=eu(t);if(!this.httpProviders[s]){const o=r||Lr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Lr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=eu(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const o=parseInt(s,16);if(this.isChainApproved(o))this.setDefaultChain(`${o}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:t.chainId}),this.setDefaultChain(`${o}`);else throw new Error(`Failed to switch to chain 'eip155:${o}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class N2{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Lr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Lr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class j2{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Lr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Lr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class D2{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class F2{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Lr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Lr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}class U2{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Lr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ji.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Lr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ni(new nn(s,Ft("disableProviderPing")))}}var L2=Object.defineProperty,$2=Object.defineProperties,M2=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,q2=Object.prototype.hasOwnProperty,z2=Object.prototype.propertyIsEnumerable,Zf=(n,t,r)=>t in n?L2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Pa=(n,t)=>{for(var r in t||(t={}))q2.call(t,r)&&Zf(n,r,t[r]);if(Xf)for(var r of Xf(t))z2.call(t,r)&&Zf(n,r,t[r]);return n},Uc=(n,t)=>$2(n,M2(t));class Ou{constructor(t){this.events=new hr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Gf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Ou(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Pa({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Dt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(g=>{this.session=g}).catch(g=>{if(g.message!==lp)throw g;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ri(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Iu.init({logger:this.providerOpts.logger||Gf,relayUrl:this.providerOpts.relayUrl||_2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Ta(r)))];Fc("client",this.client),Fc("events",this.events),Fc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=P2(r,this.session),o=x2(s),g=A2(this.namespaces,this.optionalNamespaces),b=Uc(Pa({},g[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new R2({namespace:b});break;case"solana":this.rpcProviders[r]=new N2({namespace:b});break;case"cosmos":this.rpcProviders[r]=new j2({namespace:b});break;case"polkadot":this.rpcProviders[r]=new C2({namespace:b});break;case"cip34":this.rpcProviders[r]=new D2({namespace:b});break;case"elrond":this.rpcProviders[r]=new F2({namespace:b});break;case"multiversx":this.rpcProviders[r]=new U2({namespace:b});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&ri(o)&&this.events.emit("accountsChanged",o.map(T2))}else s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,g=(s=this.client)==null?void 0:s.session.get(t);this.session=Uc(Pa({},g),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Uc(Pa({},Dt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ji.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(b=>Ta(b)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=Ta(Object.keys(this.namespaces)[0]),g=this.rpcProviders[o].getDefaultChain();return[o,g]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,g]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(g),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${g}`]).defaultChain=g,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",g)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${kf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${kf}/${t}`)}}const H2=Ou,B2="wc",K2="ethereum_provider",V2=`${B2}@2:${K2}:`,G2="https://rpc.walletconnect.com/v1/",tu=["eth_sendTransaction","personal_sign"],e3=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ru=["chainChanged","accountsChanged"],t3=["message","disconnect","connect"];var k2=Object.defineProperty,W2=Object.defineProperties,Y2=Object.getOwnPropertyDescriptors,Qf=Object.getOwnPropertySymbols,J2=Object.prototype.hasOwnProperty,X2=Object.prototype.propertyIsEnumerable,ed=(n,t,r)=>t in n?k2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lc=(n,t)=>{for(var r in t||(t={}))J2.call(t,r)&&ed(n,r,t[r]);if(Qf)for(var r of Qf(t))X2.call(t,r)&&ed(n,r,t[r]);return n},td=(n,t)=>W2(n,Y2(t));function iu(n){return Number(n[0].split(":")[1])}function $c(n){return`0x${n.toString(16)}`}function Z2(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:g,optionalEvents:b,rpcMap:m}=n;if(!ri(t))throw new Error("Invalid chains");const E=t,A=s||tu,C=g||ru,$={[iu(E)]:m[iu(E)]},k={chains:E,methods:A,events:C,rpcMap:$},M=g==null?void 0:g.filter(ue=>!ru.includes(ue)),H=s==null?void 0:s.filter(ue=>!tu.includes(ue));if(!r&&!b&&!o&&!(M!=null&&M.length)&&!(H!=null&&H.length))return{required:k};const Z=(M==null?void 0:M.length)&&(H==null?void 0:H.length)||!r,Q={chains:[...new Set(Z?E.concat(r||[]):r)],methods:[...new Set(A.concat(o||[]))],events:[...new Set(C.concat(b||[]))],rpcMap:m};return{required:k,optional:Q}}class xu{constructor(){this.events=new hr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=V2,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new xu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=Z2(this.rpc);try{const o=await new Promise(async(b,m)=>{var E;this.rpc.showQrModal&&((E=this.modal)==null||E.subscribeModal(A=>{!A.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),m(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(td(Lc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(A=>{b(A)}).catch(A=>{m(new Error(A.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const g=Xb(o.namespaces,[this.namespace]);this.setAccounts(g),this.events.emit("connect",{chainId:$c(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",$c(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",td(Lc({},Dt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",$c(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||tu,events:(t==null?void 0:t.events)||ru,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=iu(this.rpc.chains),this.signer=await H2.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await W1(()=>import("./index.4cad498e.js").then(o=>o.a),["assets/index.4cad498e.js","assets/index.72f44f21.js","assets/index.265b655b.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Lc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&ri(r)&&(this.rpc.chains=r.map(g=>this.formatChainId(g)),r.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)})),s&&ri(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(g=>this.formatChainId(g)),s.forEach(g=>{this.rpc.rpcMap[g]=(o==null?void 0:o[g])||this.getRpcUrl(g)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${G2}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const r3=xu;export{r3 as EthereumProvider,t3 as OPTIONAL_EVENTS,e3 as OPTIONAL_METHODS,ru as REQUIRED_EVENTS,tu as REQUIRED_METHODS,xu as default};
